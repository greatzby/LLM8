[2025-11-19 16:04:52,754][INFO] Q-learning training started.
[2025-11-19 16:04:52,754][INFO] Output directory: out_ql_no_target/ql_20251119_160452
[2025-11-19 16:04:52,754][INFO] Reward type: process
[2025-11-19 16:04:52,756][INFO] Resolved model configuration: {"vocab_size": 92, "block_size": 32, "n_layer": 1, "n_head": 1, "n_embd": 92, "dropout": 0.0, "bias": false}
[2025-11-19 16:04:53,472][INFO] KL 正则启用：coef=0.0500, warmup=0, anneal=20000
[2025-11-19 16:04:53,486][INFO] Loaded 1544 unique (source, target) pairs for Q-learning training.
[2025-11-19 16:05:00,323][INFO] Iter     50 | loss=22.5948 | td_err=3.3066 | kl=1.7456 | temp=0.003 | eps=0.100 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.346 | avg_path=4.72 | valid_steps=3.72
[2025-11-19 16:05:06,509][INFO] Iter    100 | loss=12.3536 | td_err=2.5707 | kl=1.9148 | temp=0.005 | eps=0.099 | success=0.625 | hit=0.625 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=0.721 | avg_path=4.56 | valid_steps=3.19
[2025-11-19 16:05:12,905][INFO] Iter    150 | loss=11.6121 | td_err=2.5707 | kl=1.8924 | temp=0.007 | eps=0.099 | success=0.094 | hit=0.094 | stage2=0.781 | first_src=0.031 | first_valid=0.906 | invalid_edge=0.844 | invalid_tok=0.000 | avg_ep_reward=-0.198 | avg_path=4.69 | valid_steps=2.84
[2025-11-19 16:05:20,109][INFO] Iter    200 | loss=8.0987 | td_err=2.1852 | kl=2.0363 | temp=0.010 | eps=0.099 | success=0.062 | hit=0.062 | stage2=0.844 | first_src=0.031 | first_valid=0.906 | invalid_edge=0.781 | invalid_tok=0.000 | avg_ep_reward=-0.192 | avg_path=6.09 | valid_steps=4.31
[2025-11-19 16:05:27,880][INFO] Iter    250 | loss=5.2155 | td_err=1.6822 | kl=2.5013 | temp=0.012 | eps=0.098 | success=0.219 | hit=0.219 | stage2=0.750 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.750 | invalid_tok=0.000 | avg_ep_reward=0.052 | avg_path=6.00 | valid_steps=4.25
[2025-11-19 16:05:35,754][INFO] Iter    300 | loss=4.0517 | td_err=1.4307 | kl=2.6514 | temp=0.015 | eps=0.098 | success=0.062 | hit=0.062 | stage2=0.938 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.844 | invalid_tok=0.000 | avg_ep_reward=-0.202 | avg_path=7.03 | valid_steps=5.19
[2025-11-19 16:05:43,725][INFO] Iter    350 | loss=3.3756 | td_err=1.2838 | kl=2.1626 | temp=0.017 | eps=0.097 | success=0.156 | hit=0.156 | stage2=0.531 | first_src=0.062 | first_valid=0.875 | invalid_edge=0.812 | invalid_tok=0.000 | avg_ep_reward=-0.156 | avg_path=5.47 | valid_steps=3.66
[2025-11-19 16:05:51,758][INFO] Iter    400 | loss=1.7862 | td_err=0.9066 | kl=2.4992 | temp=0.020 | eps=0.097 | success=0.062 | hit=0.062 | stage2=0.906 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.906 | invalid_tok=0.000 | avg_ep_reward=-0.256 | avg_path=6.78 | valid_steps=4.88
[2025-11-19 16:05:59,784][INFO] Iter    450 | loss=0.8631 | td_err=0.6061 | kl=2.4544 | temp=0.022 | eps=0.097 | success=0.094 | hit=0.094 | stage2=0.906 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.844 | invalid_tok=0.000 | avg_ep_reward=-0.217 | avg_path=7.03 | valid_steps=5.19
[2025-11-19 16:06:07,875][INFO] Iter    500 | loss=0.5537 | td_err=0.4718 | kl=2.6757 | temp=0.025 | eps=0.096 | success=0.094 | hit=0.094 | stage2=0.781 | first_src=0.000 | first_valid=0.875 | invalid_edge=0.781 | invalid_tok=0.000 | avg_ep_reward=-0.180 | avg_path=6.28 | valid_steps=4.50
[2025-11-19 16:06:16,264][INFO] Iter    550 | loss=0.3215 | td_err=0.3524 | kl=2.4645 | temp=0.027 | eps=0.096 | success=0.219 | hit=0.219 | stage2=0.812 | first_src=0.000 | first_valid=0.906 | invalid_edge=0.656 | invalid_tok=0.000 | avg_ep_reward=0.057 | avg_path=5.66 | valid_steps=4.00
[2025-11-19 16:06:24,620][INFO] Iter    600 | loss=0.2917 | td_err=0.2679 | kl=2.6893 | temp=0.030 | eps=0.096 | success=0.531 | hit=0.531 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=0.588 | avg_path=6.94 | valid_steps=5.59
[2025-11-19 16:06:32,719][INFO] Iter    650 | loss=0.2609 | td_err=0.2695 | kl=2.5017 | temp=0.033 | eps=0.095 | success=0.656 | hit=0.656 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.312 | invalid_tok=0.000 | avg_ep_reward=0.772 | avg_path=6.84 | valid_steps=5.53
[2025-11-19 16:06:40,137][INFO] Iter    700 | loss=0.2178 | td_err=0.2484 | kl=2.2727 | temp=0.035 | eps=0.095 | success=0.750 | hit=0.750 | stage2=0.531 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.188 | invalid_tok=0.000 | avg_ep_reward=0.934 | avg_path=5.16 | valid_steps=3.97
[2025-11-19 16:06:46,981][INFO] Iter    750 | loss=0.1997 | td_err=0.2163 | kl=2.2938 | temp=0.037 | eps=0.094 | success=0.688 | hit=0.688 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.250 | invalid_tok=0.000 | avg_ep_reward=0.886 | avg_path=5.06 | valid_steps=3.81
[2025-11-19 16:06:53,710][INFO] Iter    800 | loss=0.2137 | td_err=0.2228 | kl=2.2653 | temp=0.040 | eps=0.094 | success=0.625 | hit=0.625 | stage2=0.719 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.312 | invalid_tok=0.000 | avg_ep_reward=0.787 | avg_path=5.50 | valid_steps=4.19
[2025-11-19 16:07:00,169][INFO] Iter    850 | loss=0.1334 | td_err=0.1255 | kl=2.1765 | temp=0.042 | eps=0.094 | success=0.906 | hit=0.906 | stage2=0.500 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=1.228 | avg_path=4.16 | valid_steps=3.06
[2025-11-19 16:07:06,460][INFO] Iter    900 | loss=0.1993 | td_err=0.1966 | kl=2.1729 | temp=0.045 | eps=0.093 | success=0.844 | hit=0.844 | stage2=0.688 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.156 | invalid_tok=0.000 | avg_ep_reward=1.087 | avg_path=4.00 | valid_steps=2.84
[2025-11-19 16:07:12,616][INFO] Iter    950 | loss=0.1481 | td_err=0.1517 | kl=2.0543 | temp=0.047 | eps=0.093 | success=0.875 | hit=0.875 | stage2=0.625 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=1.168 | avg_path=4.47 | valid_steps=3.38
[2025-11-19 16:07:18,796][INFO] Iter   1000 | loss=0.1242 | td_err=0.1246 | kl=2.0397 | temp=0.050 | eps=0.092 | success=0.875 | hit=0.875 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=1.173 | avg_path=4.38 | valid_steps=3.28
[2025-11-19 16:07:21,115][INFO] ---- Evaluation at iter 1000 ----
[2025-11-19 16:07:21,116][INFO]   S1->S2: 4.49% (4 / 89)
[2025-11-19 16:07:21,116][INFO]   S2->S3: 17.58% (16 / 91)
[2025-11-19 16:07:21,116][INFO]   S1->S3: 14.07% (19 / 135)
[2025-11-19 16:07:21,116][INFO]   overall: 12.38% (39 / 315)
[2025-11-19 16:07:27,230][INFO] Iter   1050 | loss=0.1189 | td_err=0.1171 | kl=2.0467 | temp=0.052 | eps=0.092 | success=0.906 | hit=0.906 | stage2=0.594 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.062 | invalid_tok=0.000 | avg_ep_reward=1.220 | avg_path=4.00 | valid_steps=2.94
[2025-11-19 16:07:33,271][INFO] Iter   1100 | loss=0.1137 | td_err=0.1098 | kl=1.9332 | temp=0.055 | eps=0.092 | success=0.938 | hit=0.938 | stage2=0.562 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.062 | invalid_tok=0.000 | avg_ep_reward=1.304 | avg_path=4.16 | valid_steps=3.09
[2025-11-19 16:07:39,255][INFO] Iter   1150 | loss=0.1064 | td_err=0.0919 | kl=1.9463 | temp=0.058 | eps=0.091 | success=0.938 | hit=0.938 | stage2=0.625 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.274 | avg_path=4.28 | valid_steps=3.28
[2025-11-19 16:07:45,164][INFO] Iter   1200 | loss=0.1046 | td_err=0.0890 | kl=1.9131 | temp=0.060 | eps=0.091 | success=0.969 | hit=0.969 | stage2=0.625 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.337 | avg_path=3.78 | valid_steps=2.78
[2025-11-19 16:07:51,086][INFO] Iter   1250 | loss=0.1432 | td_err=0.1076 | kl=2.0197 | temp=0.062 | eps=0.091 | success=0.844 | hit=0.844 | stage2=0.625 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.062 | invalid_tok=0.000 | avg_ep_reward=1.159 | avg_path=3.62 | valid_steps=2.56
[2025-11-19 16:07:56,975][INFO] Iter   1300 | loss=0.1059 | td_err=0.0920 | kl=1.9278 | temp=0.065 | eps=0.090 | success=0.906 | hit=0.906 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=1.273 | avg_path=3.91 | valid_steps=2.88
[2025-11-19 16:08:02,834][INFO] Iter   1350 | loss=0.1135 | td_err=0.1014 | kl=1.8192 | temp=0.068 | eps=0.090 | success=0.938 | hit=0.938 | stage2=0.500 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.361 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 16:08:08,608][INFO] Iter   1400 | loss=0.0920 | td_err=0.0731 | kl=1.7732 | temp=0.070 | eps=0.090 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.390 | avg_path=4.56 | valid_steps=3.56
[2025-11-19 16:08:14,393][INFO] Iter   1450 | loss=0.1083 | td_err=0.0953 | kl=1.7519 | temp=0.072 | eps=0.089 | success=0.906 | hit=0.906 | stage2=0.469 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=1.256 | avg_path=3.22 | valid_steps=2.19
[2025-11-19 16:08:20,215][INFO] Iter   1500 | loss=0.0885 | td_err=0.0749 | kl=1.6789 | temp=0.075 | eps=0.089 | success=0.969 | hit=0.969 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.402 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 16:08:26,088][INFO] Iter   1550 | loss=0.0992 | td_err=0.0941 | kl=1.7417 | temp=0.077 | eps=0.088 | success=0.938 | hit=0.938 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.316 | avg_path=3.72 | valid_steps=2.72
[2025-11-19 16:08:31,854][INFO] Iter   1600 | loss=0.0872 | td_err=0.0695 | kl=1.7143 | temp=0.080 | eps=0.088 | success=0.969 | hit=0.969 | stage2=0.531 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.378 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 16:08:37,671][INFO] Iter   1650 | loss=0.0893 | td_err=0.0742 | kl=1.7389 | temp=0.083 | eps=0.088 | success=0.906 | hit=0.906 | stage2=0.625 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.281 | avg_path=3.31 | valid_steps=2.31
[2025-11-19 16:08:43,564][INFO] Iter   1700 | loss=0.0938 | td_err=0.0871 | kl=1.6940 | temp=0.085 | eps=0.087 | success=0.844 | hit=0.844 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.203 | avg_path=4.22 | valid_steps=3.22
[2025-11-19 16:08:49,296][INFO] Iter   1750 | loss=0.0806 | td_err=0.0721 | kl=1.5851 | temp=0.088 | eps=0.087 | success=1.000 | hit=1.000 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.442 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 16:08:55,033][INFO] Iter   1800 | loss=0.0828 | td_err=0.0745 | kl=1.5773 | temp=0.090 | eps=0.087 | success=0.969 | hit=0.969 | stage2=0.625 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.397 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 16:09:00,795][INFO] Iter   1850 | loss=0.1195 | td_err=0.1027 | kl=1.5909 | temp=0.092 | eps=0.086 | success=0.906 | hit=0.906 | stage2=0.562 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.062 | invalid_tok=0.000 | avg_ep_reward=1.276 | avg_path=3.38 | valid_steps=2.31
[2025-11-19 16:09:06,549][INFO] Iter   1900 | loss=0.0758 | td_err=0.0568 | kl=1.5407 | temp=0.095 | eps=0.086 | success=0.969 | hit=0.969 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.399 | avg_path=3.31 | valid_steps=2.31
[2025-11-19 16:09:12,290][INFO] Iter   1950 | loss=0.0815 | td_err=0.0683 | kl=1.5504 | temp=0.098 | eps=0.085 | success=1.000 | hit=1.000 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.446 | avg_path=3.16 | valid_steps=2.16
[2025-11-19 16:09:18,123][INFO] Iter   2000 | loss=0.0768 | td_err=0.0735 | kl=1.4524 | temp=0.100 | eps=0.085 | success=0.938 | hit=0.938 | stage2=0.688 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.360 | avg_path=4.34 | valid_steps=3.34
[2025-11-19 16:09:20,429][INFO] ---- Evaluation at iter 2000 ----
[2025-11-19 16:09:20,431][INFO]   S1->S2: 43.82% (39 / 89)
[2025-11-19 16:09:20,431][INFO]   S2->S3: 73.63% (67 / 91)
[2025-11-19 16:09:20,431][INFO]   S1->S3: 74.07% (100 / 135)
[2025-11-19 16:09:20,431][INFO]   overall: 65.40% (206 / 315)
[2025-11-19 16:09:20,437][INFO] Saved Q-learning checkpoint to out_ql_no_target/ql_20251119_160452/ckpt_ql_2000.pt
[2025-11-19 16:09:26,254][INFO] Iter   2050 | loss=0.0744 | td_err=0.0589 | kl=1.5038 | temp=0.102 | eps=0.085 | success=0.969 | hit=0.969 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.402 | avg_path=3.50 | valid_steps=2.50
[2025-11-19 16:09:32,074][INFO] Iter   2100 | loss=0.0727 | td_err=0.0590 | kl=1.4727 | temp=0.105 | eps=0.084 | success=0.938 | hit=0.938 | stage2=0.719 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.362 | avg_path=3.44 | valid_steps=2.44
[2025-11-19 16:09:37,936][INFO] Iter   2150 | loss=0.0727 | td_err=0.0652 | kl=1.4163 | temp=0.107 | eps=0.084 | success=0.969 | hit=0.969 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.418 | avg_path=3.47 | valid_steps=2.47
[2025-11-19 16:09:43,768][INFO] Iter   2200 | loss=0.0710 | td_err=0.0687 | kl=1.4376 | temp=0.110 | eps=0.084 | success=1.000 | hit=1.000 | stage2=0.656 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.444 | avg_path=3.28 | valid_steps=2.28
[2025-11-19 16:09:49,588][INFO] Iter   2250 | loss=0.0674 | td_err=0.0558 | kl=1.4048 | temp=0.112 | eps=0.083 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.461 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 16:09:55,446][INFO] Iter   2300 | loss=0.0642 | td_err=0.0506 | kl=1.3472 | temp=0.115 | eps=0.083 | success=0.875 | hit=0.875 | stage2=0.844 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.299 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 16:10:01,258][INFO] Iter   2350 | loss=0.0693 | td_err=0.0671 | kl=1.3305 | temp=0.117 | eps=0.082 | success=0.875 | hit=0.875 | stage2=0.781 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.317 | avg_path=3.50 | valid_steps=2.50
[2025-11-19 16:10:07,028][INFO] Iter   2400 | loss=0.0681 | td_err=0.0670 | kl=1.3443 | temp=0.120 | eps=0.082 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.490 | avg_path=3.62 | valid_steps=2.62
[2025-11-19 16:10:12,904][INFO] Iter   2450 | loss=0.0651 | td_err=0.0630 | kl=1.3262 | temp=0.122 | eps=0.082 | success=0.938 | hit=0.938 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.373 | avg_path=4.03 | valid_steps=3.03
[2025-11-19 16:10:18,772][INFO] Iter   2500 | loss=0.0626 | td_err=0.0537 | kl=1.3125 | temp=0.125 | eps=0.081 | success=0.938 | hit=0.938 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.401 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 16:10:24,560][INFO] Iter   2550 | loss=0.0624 | td_err=0.0607 | kl=1.2608 | temp=0.128 | eps=0.081 | success=0.969 | hit=0.969 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.406 | avg_path=3.62 | valid_steps=2.62
[2025-11-19 16:10:30,271][INFO] Iter   2600 | loss=0.0624 | td_err=0.0616 | kl=1.2748 | temp=0.130 | eps=0.081 | success=0.969 | hit=0.969 | stage2=0.594 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.388 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 16:10:36,009][INFO] Iter   2650 | loss=0.0620 | td_err=0.0651 | kl=1.2490 | temp=0.132 | eps=0.080 | success=0.906 | hit=0.906 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.384 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 16:10:41,874][INFO] Iter   2700 | loss=0.0593 | td_err=0.0603 | kl=1.2103 | temp=0.135 | eps=0.080 | success=0.969 | hit=0.969 | stage2=0.750 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.428 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 16:10:47,682][INFO] Iter   2750 | loss=0.0608 | td_err=0.0741 | kl=1.2132 | temp=0.137 | eps=0.079 | success=0.969 | hit=0.969 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.431 | avg_path=3.78 | valid_steps=2.78
[2025-11-19 16:10:53,501][INFO] Iter   2800 | loss=0.0575 | td_err=0.0612 | kl=1.1830 | temp=0.140 | eps=0.079 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.384 | avg_path=3.62 | valid_steps=2.62
[2025-11-19 16:10:59,282][INFO] Iter   2850 | loss=0.0569 | td_err=0.0647 | kl=1.1503 | temp=0.142 | eps=0.079 | success=0.969 | hit=0.969 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.477 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 16:11:05,056][INFO] Iter   2900 | loss=0.0585 | td_err=0.0688 | kl=1.1754 | temp=0.145 | eps=0.078 | success=1.000 | hit=1.000 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.465 | avg_path=3.78 | valid_steps=2.78
[2025-11-19 16:11:10,976][INFO] Iter   2950 | loss=0.0604 | td_err=0.0656 | kl=1.2174 | temp=0.147 | eps=0.078 | success=0.938 | hit=0.938 | stage2=0.656 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.390 | avg_path=3.62 | valid_steps=2.62
[2025-11-19 16:11:16,835][INFO] Iter   3000 | loss=0.0545 | td_err=0.0586 | kl=1.1387 | temp=0.150 | eps=0.077 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.475 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 16:11:19,183][INFO] ---- Evaluation at iter 3000 ----
[2025-11-19 16:11:19,185][INFO]   S1->S2: 98.88% (88 / 89)
[2025-11-19 16:11:19,185][INFO]   S2->S3: 90.11% (82 / 91)
[2025-11-19 16:11:19,185][INFO]   S1->S3: 88.89% (120 / 135)
[2025-11-19 16:11:19,185][INFO]   overall: 92.06% (290 / 315)
[2025-11-19 16:11:24,927][INFO] Iter   3050 | loss=0.0580 | td_err=0.0624 | kl=1.2064 | temp=0.152 | eps=0.077 | success=0.938 | hit=0.938 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.365 | avg_path=3.47 | valid_steps=2.47
[2025-11-19 16:11:30,717][INFO] Iter   3100 | loss=0.0545 | td_err=0.0645 | kl=1.0998 | temp=0.155 | eps=0.077 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.397 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 16:11:36,493][INFO] Iter   3150 | loss=0.0489 | td_err=0.0534 | kl=1.0374 | temp=0.158 | eps=0.076 | success=1.000 | hit=1.000 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.492 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 16:11:42,337][INFO] Iter   3200 | loss=0.0505 | td_err=0.0506 | kl=1.0702 | temp=0.160 | eps=0.076 | success=0.906 | hit=0.906 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.359 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 16:11:48,134][INFO] Iter   3250 | loss=0.0532 | td_err=0.0543 | kl=1.1356 | temp=0.162 | eps=0.076 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.467 | avg_path=3.34 | valid_steps=2.34
[2025-11-19 16:11:53,950][INFO] Iter   3300 | loss=0.0510 | td_err=0.0523 | kl=1.1032 | temp=0.165 | eps=0.075 | success=1.000 | hit=1.000 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.475 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 16:11:59,810][INFO] Iter   3350 | loss=0.0530 | td_err=0.0663 | kl=1.0630 | temp=0.168 | eps=0.075 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.425 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 16:12:05,620][INFO] Iter   3400 | loss=0.0503 | td_err=0.0653 | kl=1.0246 | temp=0.170 | eps=0.075 | success=1.000 | hit=1.000 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.500 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 16:12:11,416][INFO] Iter   3450 | loss=0.0503 | td_err=0.0589 | kl=1.0803 | temp=0.172 | eps=0.074 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.479 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 16:12:17,254][INFO] Iter   3500 | loss=0.0497 | td_err=0.0654 | kl=1.0213 | temp=0.175 | eps=0.074 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.471 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 16:12:23,128][INFO] Iter   3550 | loss=0.0493 | td_err=0.0644 | kl=1.0283 | temp=0.177 | eps=0.073 | success=0.969 | hit=0.969 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.474 | avg_path=4.09 | valid_steps=3.09
[2025-11-19 16:12:28,969][INFO] Iter   3600 | loss=0.0512 | td_err=0.0652 | kl=1.0394 | temp=0.180 | eps=0.073 | success=0.875 | hit=0.875 | stage2=0.562 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.296 | avg_path=3.47 | valid_steps=2.47
[2025-11-19 16:12:34,752][INFO] Iter   3650 | loss=0.0487 | td_err=0.0723 | kl=0.9870 | temp=0.182 | eps=0.073 | success=0.938 | hit=0.938 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.411 | avg_path=3.97 | valid_steps=2.97
[2025-11-19 16:12:40,515][INFO] Iter   3700 | loss=0.0528 | td_err=0.0789 | kl=1.0552 | temp=0.185 | eps=0.072 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.396 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 16:12:46,220][INFO] Iter   3750 | loss=0.0478 | td_err=0.0573 | kl=1.0073 | temp=0.188 | eps=0.072 | success=0.938 | hit=0.938 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.417 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 16:12:51,949][INFO] Iter   3800 | loss=0.0474 | td_err=0.0690 | kl=0.9661 | temp=0.190 | eps=0.072 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.446 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 16:12:57,713][INFO] Iter   3850 | loss=0.0488 | td_err=0.0648 | kl=1.0116 | temp=0.193 | eps=0.071 | success=0.969 | hit=0.969 | stage2=0.625 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.403 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 16:13:03,513][INFO] Iter   3900 | loss=0.0478 | td_err=0.0722 | kl=0.9606 | temp=0.195 | eps=0.071 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.449 | avg_path=4.09 | valid_steps=3.09
[2025-11-19 16:13:09,248][INFO] Iter   3950 | loss=0.0468 | td_err=0.0548 | kl=1.0206 | temp=0.197 | eps=0.070 | success=1.000 | hit=1.000 | stage2=0.625 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.480 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 16:13:15,051][INFO] Iter   4000 | loss=0.0469 | td_err=0.0601 | kl=1.0165 | temp=0.200 | eps=0.070 | success=1.000 | hit=1.000 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.460 | avg_path=3.41 | valid_steps=2.41
[2025-11-19 16:13:17,344][INFO] ---- Evaluation at iter 4000 ----
[2025-11-19 16:13:17,346][INFO]   S1->S2: 100.00% (89 / 89)
[2025-11-19 16:13:17,346][INFO]   S2->S3: 91.21% (83 / 91)
[2025-11-19 16:13:17,346][INFO]   S1->S3: 73.33% (99 / 135)
[2025-11-19 16:13:17,346][INFO]   overall: 86.03% (271 / 315)
[2025-11-19 16:13:17,351][INFO] Saved Q-learning checkpoint to out_ql_no_target/ql_20251119_160452/ckpt_ql_4000.pt
[2025-11-19 16:13:23,084][INFO] Iter   4050 | loss=0.0448 | td_err=0.0663 | kl=0.9307 | temp=0.203 | eps=0.070 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.480 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 16:13:28,820][INFO] Iter   4100 | loss=0.0428 | td_err=0.0547 | kl=0.9384 | temp=0.205 | eps=0.069 | success=0.969 | hit=0.969 | stage2=0.656 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.411 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 16:13:34,589][INFO] Iter   4150 | loss=0.0422 | td_err=0.0602 | kl=0.9081 | temp=0.207 | eps=0.069 | success=0.875 | hit=0.875 | stage2=0.719 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.305 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 16:13:40,446][INFO] Iter   4200 | loss=0.0466 | td_err=0.0704 | kl=0.9517 | temp=0.210 | eps=0.069 | success=1.000 | hit=1.000 | stage2=0.656 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.435 | avg_path=3.72 | valid_steps=2.72
[2025-11-19 16:13:46,268][INFO] Iter   4250 | loss=0.0442 | td_err=0.0653 | kl=0.9143 | temp=0.212 | eps=0.068 | success=0.938 | hit=0.938 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.400 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 16:13:52,026][INFO] Iter   4300 | loss=0.0446 | td_err=0.0752 | kl=0.8826 | temp=0.215 | eps=0.068 | success=0.938 | hit=0.938 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.404 | avg_path=3.41 | valid_steps=2.41
[2025-11-19 16:13:57,797][INFO] Iter   4350 | loss=0.0397 | td_err=0.0493 | kl=0.9055 | temp=0.217 | eps=0.067 | success=0.906 | hit=0.906 | stage2=0.562 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.328 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 16:14:03,541][INFO] Iter   4400 | loss=0.0419 | td_err=0.0620 | kl=0.8962 | temp=0.220 | eps=0.067 | success=0.906 | hit=0.906 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.327 | avg_path=3.97 | valid_steps=2.97
[2025-11-19 16:14:09,294][INFO] Iter   4450 | loss=0.0366 | td_err=0.0522 | kl=0.8227 | temp=0.223 | eps=0.067 | success=0.906 | hit=0.906 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.362 | avg_path=4.25 | valid_steps=3.25
[2025-11-19 16:14:15,096][INFO] Iter   4500 | loss=0.0395 | td_err=0.0628 | kl=0.8436 | temp=0.225 | eps=0.066 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.484 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 16:14:20,928][INFO] Iter   4550 | loss=0.0448 | td_err=0.0690 | kl=0.8889 | temp=0.227 | eps=0.066 | success=0.906 | hit=0.906 | stage2=0.719 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.352 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 16:14:26,758][INFO] Iter   4600 | loss=0.0394 | td_err=0.0593 | kl=0.8363 | temp=0.230 | eps=0.066 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.532 | avg_path=4.00 | valid_steps=3.00
[2025-11-19 16:14:32,572][INFO] Iter   4650 | loss=0.0376 | td_err=0.0515 | kl=0.8523 | temp=0.232 | eps=0.065 | success=0.938 | hit=0.938 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.394 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 16:14:38,369][INFO] Iter   4700 | loss=0.0406 | td_err=0.0660 | kl=0.8490 | temp=0.235 | eps=0.065 | success=0.969 | hit=0.969 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.486 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 16:14:44,220][INFO] Iter   4750 | loss=0.0399 | td_err=0.0697 | kl=0.8142 | temp=0.237 | eps=0.064 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.486 | avg_path=3.97 | valid_steps=2.97
[2025-11-19 16:14:50,083][INFO] Iter   4800 | loss=0.0382 | td_err=0.0629 | kl=0.8364 | temp=0.240 | eps=0.064 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.485 | avg_path=3.72 | valid_steps=2.72
[2025-11-19 16:14:55,924][INFO] Iter   4850 | loss=0.0390 | td_err=0.0638 | kl=0.8157 | temp=0.242 | eps=0.064 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.467 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 16:15:01,782][INFO] Iter   4900 | loss=0.0419 | td_err=0.0730 | kl=0.8432 | temp=0.245 | eps=0.063 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.460 | avg_path=4.19 | valid_steps=3.19
[2025-11-19 16:15:07,647][INFO] Iter   4950 | loss=0.0402 | td_err=0.0686 | kl=0.8156 | temp=0.247 | eps=0.063 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.509 | avg_path=4.06 | valid_steps=3.06
[2025-11-19 16:15:13,550][INFO] Iter   5000 | loss=0.0352 | td_err=0.0467 | kl=0.8343 | temp=0.250 | eps=0.062 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.463 | avg_path=3.72 | valid_steps=2.72
[2025-11-19 16:15:15,865][INFO] ---- Evaluation at iter 5000 ----
[2025-11-19 16:15:15,866][INFO]   S1->S2: 100.00% (89 / 89)
[2025-11-19 16:15:15,866][INFO]   S2->S3: 95.60% (87 / 91)
[2025-11-19 16:15:15,866][INFO]   S1->S3: 72.59% (98 / 135)
[2025-11-19 16:15:15,866][INFO]   overall: 86.98% (274 / 315)
[2025-11-19 16:15:21,744][INFO] Iter   5050 | loss=0.0383 | td_err=0.0525 | kl=0.8620 | temp=0.253 | eps=0.062 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.464 | avg_path=3.53 | valid_steps=2.53
[2025-11-19 16:15:27,573][INFO] Iter   5100 | loss=0.0383 | td_err=0.0678 | kl=0.7934 | temp=0.255 | eps=0.062 | success=0.938 | hit=0.938 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.420 | avg_path=3.84 | valid_steps=2.84
[2025-11-19 16:15:33,411][INFO] Iter   5150 | loss=0.0388 | td_err=0.0660 | kl=0.8375 | temp=0.257 | eps=0.061 | success=0.938 | hit=0.938 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.397 | avg_path=4.03 | valid_steps=3.03
[2025-11-19 16:15:39,283][INFO] Iter   5200 | loss=0.0359 | td_err=0.0577 | kl=0.7946 | temp=0.260 | eps=0.061 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.514 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 16:15:45,219][INFO] Iter   5250 | loss=0.0377 | td_err=0.0731 | kl=0.7599 | temp=0.263 | eps=0.061 | success=0.938 | hit=0.938 | stage2=0.750 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.400 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 16:15:51,031][INFO] Iter   5300 | loss=0.0374 | td_err=0.0693 | kl=0.7762 | temp=0.265 | eps=0.060 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.455 | avg_path=4.12 | valid_steps=3.12
[2025-11-19 16:15:56,913][INFO] Iter   5350 | loss=0.0380 | td_err=0.0686 | kl=0.7858 | temp=0.268 | eps=0.060 | success=0.969 | hit=0.969 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.438 | avg_path=4.19 | valid_steps=3.19
[2025-11-19 16:16:02,780][INFO] Iter   5400 | loss=0.0337 | td_err=0.0565 | kl=0.7594 | temp=0.270 | eps=0.059 | success=0.969 | hit=0.969 | stage2=0.500 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.428 | avg_path=3.28 | valid_steps=2.28
[2025-11-19 16:16:08,682][INFO] Iter   5450 | loss=0.0338 | td_err=0.0400 | kl=0.8496 | temp=0.272 | eps=0.059 | success=0.938 | hit=0.938 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.419 | avg_path=3.28 | valid_steps=2.28
[2025-11-19 16:16:14,541][INFO] Iter   5500 | loss=0.0299 | td_err=0.0431 | kl=0.7347 | temp=0.275 | eps=0.059 | success=0.938 | hit=0.938 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.451 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 16:16:20,426][INFO] Iter   5550 | loss=0.0337 | td_err=0.0500 | kl=0.8047 | temp=0.278 | eps=0.058 | success=0.906 | hit=0.906 | stage2=0.719 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.343 | avg_path=3.47 | valid_steps=2.47
[2025-11-19 16:16:26,334][INFO] Iter   5600 | loss=0.0322 | td_err=0.0526 | kl=0.7603 | temp=0.280 | eps=0.058 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.469 | avg_path=3.56 | valid_steps=2.56
[2025-11-19 16:16:32,250][INFO] Iter   5650 | loss=0.0373 | td_err=0.0716 | kl=0.7299 | temp=0.282 | eps=0.058 | success=1.000 | hit=1.000 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.518 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 16:16:38,094][INFO] Iter   5700 | loss=0.0354 | td_err=0.0629 | kl=0.7890 | temp=0.285 | eps=0.057 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.462 | avg_path=3.47 | valid_steps=2.47
[2025-11-19 16:16:44,020][INFO] Iter   5750 | loss=0.0317 | td_err=0.0599 | kl=0.7144 | temp=0.287 | eps=0.057 | success=0.969 | hit=0.969 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.463 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 16:16:50,012][INFO] Iter   5800 | loss=0.0384 | td_err=0.0806 | kl=0.7534 | temp=0.290 | eps=0.057 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.470 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 16:16:55,869][INFO] Iter   5850 | loss=0.0380 | td_err=0.0678 | kl=0.7491 | temp=0.292 | eps=0.056 | success=0.938 | hit=0.938 | stage2=0.781 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.396 | avg_path=3.78 | valid_steps=2.78
[2025-11-19 16:17:01,787][INFO] Iter   5900 | loss=0.0367 | td_err=0.0699 | kl=0.7653 | temp=0.295 | eps=0.056 | success=0.906 | hit=0.906 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.356 | avg_path=3.78 | valid_steps=2.78
[2025-11-19 16:17:07,715][INFO] Iter   5950 | loss=0.0311 | td_err=0.0587 | kl=0.7047 | temp=0.297 | eps=0.055 | success=0.938 | hit=0.938 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.421 | avg_path=3.94 | valid_steps=2.94
[2025-11-19 16:17:13,627][INFO] Iter   6000 | loss=0.0337 | td_err=0.0692 | kl=0.6850 | temp=0.300 | eps=0.055 | success=0.969 | hit=0.969 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.434 | avg_path=4.22 | valid_steps=3.22
[2025-11-19 16:17:15,958][INFO] ---- Evaluation at iter 6000 ----
[2025-11-19 16:17:15,960][INFO]   S1->S2: 100.00% (89 / 89)
[2025-11-19 16:17:15,960][INFO]   S2->S3: 95.60% (87 / 91)
[2025-11-19 16:17:15,960][INFO]   S1->S3: 71.85% (97 / 135)
[2025-11-19 16:17:15,960][INFO]   overall: 86.67% (273 / 315)
[2025-11-19 16:17:15,965][INFO] Saved Q-learning checkpoint to out_ql_no_target/ql_20251119_160452/ckpt_ql_6000.pt
[2025-11-19 16:17:21,929][INFO] Iter   6050 | loss=0.0323 | td_err=0.0587 | kl=0.7308 | temp=0.300 | eps=0.055 | success=0.938 | hit=0.938 | stage2=0.781 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.441 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 16:17:27,819][INFO] Iter   6100 | loss=0.0300 | td_err=0.0583 | kl=0.6877 | temp=0.300 | eps=0.054 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.441 | avg_path=4.06 | valid_steps=3.06
[2025-11-19 16:17:33,651][INFO] Iter   6150 | loss=0.0306 | td_err=0.0530 | kl=0.7259 | temp=0.300 | eps=0.054 | success=1.000 | hit=1.000 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.508 | avg_path=3.22 | valid_steps=2.22
[2025-11-19 16:17:39,467][INFO] Iter   6200 | loss=0.0305 | td_err=0.0557 | kl=0.7288 | temp=0.300 | eps=0.053 | success=0.875 | hit=0.875 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.289 | avg_path=3.38 | valid_steps=2.38
[2025-11-19 16:17:45,345][INFO] Iter   6250 | loss=0.0301 | td_err=0.0553 | kl=0.6990 | temp=0.300 | eps=0.053 | success=1.000 | hit=1.000 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.506 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 16:17:51,174][INFO] Iter   6300 | loss=0.0318 | td_err=0.0627 | kl=0.7218 | temp=0.300 | eps=0.053 | success=0.969 | hit=0.969 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.456 | avg_path=3.62 | valid_steps=2.62
[2025-11-19 16:17:57,014][INFO] Iter   6350 | loss=0.0350 | td_err=0.0768 | kl=0.6961 | temp=0.300 | eps=0.052 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.481 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 16:18:02,797][INFO] Iter   6400 | loss=0.0339 | td_err=0.0755 | kl=0.6683 | temp=0.300 | eps=0.052 | success=1.000 | hit=1.000 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.509 | avg_path=3.62 | valid_steps=2.62
[2025-11-19 16:18:08,637][INFO] Iter   6450 | loss=0.0280 | td_err=0.0534 | kl=0.6867 | temp=0.300 | eps=0.052 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.539 | avg_path=3.84 | valid_steps=2.84
[2025-11-19 16:18:14,508][INFO] Iter   6500 | loss=0.0291 | td_err=0.0567 | kl=0.6651 | temp=0.300 | eps=0.051 | success=0.906 | hit=0.906 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.372 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 16:18:20,319][INFO] Iter   6550 | loss=0.0271 | td_err=0.0516 | kl=0.6673 | temp=0.300 | eps=0.051 | success=0.938 | hit=0.938 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.422 | avg_path=3.72 | valid_steps=2.72
[2025-11-19 16:18:26,167][INFO] Iter   6600 | loss=0.0278 | td_err=0.0585 | kl=0.6394 | temp=0.300 | eps=0.050 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.518 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 16:18:31,983][INFO] Iter   6650 | loss=0.0276 | td_err=0.0531 | kl=0.6771 | temp=0.300 | eps=0.050 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.454 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 16:18:37,861][INFO] Iter   6700 | loss=0.0314 | td_err=0.0766 | kl=0.6369 | temp=0.300 | eps=0.050 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.469 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 16:18:43,669][INFO] Iter   6750 | loss=0.0276 | td_err=0.0522 | kl=0.6917 | temp=0.300 | eps=0.049 | success=1.000 | hit=1.000 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.494 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 16:18:49,483][INFO] Iter   6800 | loss=0.0291 | td_err=0.0652 | kl=0.6220 | temp=0.300 | eps=0.049 | success=0.844 | hit=0.844 | stage2=0.844 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.296 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 16:18:55,277][INFO] Iter   6850 | loss=0.0277 | td_err=0.0608 | kl=0.6432 | temp=0.300 | eps=0.049 | success=0.938 | hit=0.938 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.395 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 16:19:01,103][INFO] Iter   6900 | loss=0.0279 | td_err=0.0569 | kl=0.6634 | temp=0.300 | eps=0.048 | success=0.969 | hit=0.969 | stage2=0.656 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.436 | avg_path=3.53 | valid_steps=2.53
[2025-11-19 16:19:06,888][INFO] Iter   6950 | loss=0.0275 | td_err=0.0603 | kl=0.6494 | temp=0.300 | eps=0.048 | success=0.969 | hit=0.969 | stage2=0.719 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.448 | avg_path=3.53 | valid_steps=2.53
[2025-11-19 16:19:12,721][INFO] Iter   7000 | loss=0.0265 | td_err=0.0554 | kl=0.6341 | temp=0.300 | eps=0.047 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.432 | avg_path=3.84 | valid_steps=2.84
[2025-11-19 16:19:15,027][INFO] ---- Evaluation at iter 7000 ----
[2025-11-19 16:19:15,028][INFO]   S1->S2: 100.00% (89 / 89)
[2025-11-19 16:19:15,028][INFO]   S2->S3: 95.60% (87 / 91)
[2025-11-19 16:19:15,028][INFO]   S1->S3: 57.04% (77 / 135)
[2025-11-19 16:19:15,029][INFO]   overall: 80.32% (253 / 315)
[2025-11-19 16:19:20,886][INFO] Iter   7050 | loss=0.0276 | td_err=0.0619 | kl=0.6418 | temp=0.300 | eps=0.047 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.504 | avg_path=3.56 | valid_steps=2.56
[2025-11-19 16:19:26,649][INFO] Iter   7100 | loss=0.0277 | td_err=0.0573 | kl=0.6523 | temp=0.300 | eps=0.047 | success=0.938 | hit=0.938 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.426 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 16:19:32,474][INFO] Iter   7150 | loss=0.0274 | td_err=0.0577 | kl=0.6386 | temp=0.300 | eps=0.046 | success=0.969 | hit=0.969 | stage2=0.562 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.456 | avg_path=3.47 | valid_steps=2.47
[2025-11-19 16:19:38,290][INFO] Iter   7200 | loss=0.0277 | td_err=0.0629 | kl=0.6181 | temp=0.300 | eps=0.046 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.473 | avg_path=4.00 | valid_steps=3.00
[2025-11-19 16:19:44,088][INFO] Iter   7250 | loss=0.0245 | td_err=0.0627 | kl=0.5630 | temp=0.300 | eps=0.046 | success=1.000 | hit=1.000 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.550 | avg_path=4.22 | valid_steps=3.22
[2025-11-19 16:19:49,966][INFO] Iter   7300 | loss=0.0301 | td_err=0.0744 | kl=0.6282 | temp=0.300 | eps=0.045 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.463 | avg_path=3.56 | valid_steps=2.56
[2025-11-19 16:19:55,803][INFO] Iter   7350 | loss=0.0279 | td_err=0.0631 | kl=0.6288 | temp=0.300 | eps=0.045 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.449 | avg_path=3.94 | valid_steps=2.94
