[2025-11-19 16:48:18,517][INFO] Q-learning training started.
[2025-11-19 16:48:18,517][INFO] Output directory: out_ql_no_target/ql_20251119_164818
[2025-11-19 16:48:18,517][INFO] Reward type: process
[2025-11-19 16:48:18,521][INFO] Resolved model configuration: {"vocab_size": 92, "block_size": 32, "n_layer": 1, "n_head": 1, "n_embd": 92, "dropout": 0.0, "bias": false}
[2025-11-19 16:48:19,294][INFO] KL 正则启用：coef=0.0500, warmup=0, anneal=20000
[2025-11-19 16:48:19,309][INFO] Loaded 1544 unique (source, target) pairs for Q-learning training.
[2025-11-19 16:48:26,235][INFO] Iter     50 | loss=22.5948 | td_err=3.3066 | kl=1.7456 | temp=0.003 | eps=0.100 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.346 | avg_path=4.72 | valid_steps=3.72
[2025-11-19 16:48:32,420][INFO] Iter    100 | loss=12.3536 | td_err=2.5707 | kl=1.9148 | temp=0.005 | eps=0.099 | success=0.625 | hit=0.625 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=0.721 | avg_path=4.56 | valid_steps=3.19
[2025-11-19 16:48:38,725][INFO] Iter    150 | loss=11.6121 | td_err=2.5707 | kl=1.8924 | temp=0.007 | eps=0.099 | success=0.094 | hit=0.094 | stage2=0.781 | first_src=0.031 | first_valid=0.906 | invalid_edge=0.844 | invalid_tok=0.000 | avg_ep_reward=-0.198 | avg_path=4.69 | valid_steps=2.84
[2025-11-19 16:48:45,832][INFO] Iter    200 | loss=8.0987 | td_err=2.1852 | kl=2.0363 | temp=0.010 | eps=0.099 | success=0.062 | hit=0.062 | stage2=0.844 | first_src=0.031 | first_valid=0.906 | invalid_edge=0.781 | invalid_tok=0.000 | avg_ep_reward=-0.192 | avg_path=6.09 | valid_steps=4.31
[2025-11-19 16:48:53,500][INFO] Iter    250 | loss=5.2155 | td_err=1.6822 | kl=2.5013 | temp=0.012 | eps=0.098 | success=0.219 | hit=0.219 | stage2=0.750 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.750 | invalid_tok=0.000 | avg_ep_reward=0.052 | avg_path=6.00 | valid_steps=4.25
[2025-11-19 16:49:01,303][INFO] Iter    300 | loss=4.0517 | td_err=1.4307 | kl=2.6514 | temp=0.015 | eps=0.098 | success=0.062 | hit=0.062 | stage2=0.938 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.844 | invalid_tok=0.000 | avg_ep_reward=-0.202 | avg_path=7.03 | valid_steps=5.19
[2025-11-19 16:49:09,172][INFO] Iter    350 | loss=3.3756 | td_err=1.2838 | kl=2.1626 | temp=0.017 | eps=0.097 | success=0.156 | hit=0.156 | stage2=0.531 | first_src=0.062 | first_valid=0.875 | invalid_edge=0.812 | invalid_tok=0.000 | avg_ep_reward=-0.156 | avg_path=5.47 | valid_steps=3.66
[2025-11-19 16:49:17,027][INFO] Iter    400 | loss=1.7862 | td_err=0.9066 | kl=2.4992 | temp=0.020 | eps=0.097 | success=0.062 | hit=0.062 | stage2=0.906 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.906 | invalid_tok=0.000 | avg_ep_reward=-0.256 | avg_path=6.78 | valid_steps=4.88
[2025-11-19 16:49:24,869][INFO] Iter    450 | loss=0.8631 | td_err=0.6061 | kl=2.4544 | temp=0.022 | eps=0.097 | success=0.094 | hit=0.094 | stage2=0.906 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.844 | invalid_tok=0.000 | avg_ep_reward=-0.217 | avg_path=7.03 | valid_steps=5.19
[2025-11-19 16:49:32,790][INFO] Iter    500 | loss=0.5537 | td_err=0.4718 | kl=2.6757 | temp=0.025 | eps=0.096 | success=0.094 | hit=0.094 | stage2=0.781 | first_src=0.000 | first_valid=0.875 | invalid_edge=0.781 | invalid_tok=0.000 | avg_ep_reward=-0.180 | avg_path=6.28 | valid_steps=4.50
[2025-11-19 16:49:41,010][INFO] Iter    550 | loss=0.3215 | td_err=0.3524 | kl=2.4645 | temp=0.027 | eps=0.096 | success=0.219 | hit=0.219 | stage2=0.812 | first_src=0.000 | first_valid=0.906 | invalid_edge=0.656 | invalid_tok=0.000 | avg_ep_reward=0.057 | avg_path=5.66 | valid_steps=4.00
[2025-11-19 16:49:49,248][INFO] Iter    600 | loss=0.2917 | td_err=0.2679 | kl=2.6893 | temp=0.030 | eps=0.096 | success=0.531 | hit=0.531 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=0.588 | avg_path=6.94 | valid_steps=5.59
[2025-11-19 16:49:57,276][INFO] Iter    650 | loss=0.2609 | td_err=0.2695 | kl=2.5017 | temp=0.033 | eps=0.095 | success=0.656 | hit=0.656 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.312 | invalid_tok=0.000 | avg_ep_reward=0.772 | avg_path=6.84 | valid_steps=5.53
[2025-11-19 16:50:04,647][INFO] Iter    700 | loss=0.2178 | td_err=0.2484 | kl=2.2727 | temp=0.035 | eps=0.095 | success=0.750 | hit=0.750 | stage2=0.531 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.188 | invalid_tok=0.000 | avg_ep_reward=0.934 | avg_path=5.16 | valid_steps=3.97
[2025-11-19 16:50:11,431][INFO] Iter    750 | loss=0.1997 | td_err=0.2163 | kl=2.2938 | temp=0.037 | eps=0.094 | success=0.688 | hit=0.688 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.250 | invalid_tok=0.000 | avg_ep_reward=0.886 | avg_path=5.06 | valid_steps=3.81
[2025-11-19 16:50:18,171][INFO] Iter    800 | loss=0.2137 | td_err=0.2228 | kl=2.2653 | temp=0.040 | eps=0.094 | success=0.625 | hit=0.625 | stage2=0.719 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.312 | invalid_tok=0.000 | avg_ep_reward=0.787 | avg_path=5.50 | valid_steps=4.19
[2025-11-19 16:50:24,561][INFO] Iter    850 | loss=0.1334 | td_err=0.1255 | kl=2.1765 | temp=0.042 | eps=0.094 | success=0.906 | hit=0.906 | stage2=0.500 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=1.228 | avg_path=4.16 | valid_steps=3.06
[2025-11-19 16:50:30,795][INFO] Iter    900 | loss=0.1993 | td_err=0.1966 | kl=2.1729 | temp=0.045 | eps=0.093 | success=0.844 | hit=0.844 | stage2=0.688 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.156 | invalid_tok=0.000 | avg_ep_reward=1.087 | avg_path=4.00 | valid_steps=2.84
[2025-11-19 16:50:36,840][INFO] Iter    950 | loss=0.1481 | td_err=0.1517 | kl=2.0543 | temp=0.047 | eps=0.093 | success=0.875 | hit=0.875 | stage2=0.625 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=1.168 | avg_path=4.47 | valid_steps=3.38
[2025-11-19 16:50:42,973][INFO] Iter   1000 | loss=0.1242 | td_err=0.1246 | kl=2.0397 | temp=0.050 | eps=0.092 | success=0.875 | hit=0.875 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=1.173 | avg_path=4.38 | valid_steps=3.28
[2025-11-19 16:50:45,288][INFO] ---- Evaluation at iter 1000 ----
[2025-11-19 16:50:45,289][INFO]   S1->S2: 4.49% (4 / 89)
[2025-11-19 16:50:45,289][INFO]   S2->S3: 17.58% (16 / 91)
[2025-11-19 16:50:45,290][INFO]   S1->S3: 14.07% (19 / 135)
[2025-11-19 16:50:45,290][INFO]   overall: 12.38% (39 / 315)
[2025-11-19 16:50:51,349][INFO] Iter   1050 | loss=0.1189 | td_err=0.1171 | kl=2.0467 | temp=0.052 | eps=0.092 | success=0.906 | hit=0.906 | stage2=0.594 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.062 | invalid_tok=0.000 | avg_ep_reward=1.220 | avg_path=4.00 | valid_steps=2.94
[2025-11-19 16:50:57,351][INFO] Iter   1100 | loss=0.1137 | td_err=0.1098 | kl=1.9332 | temp=0.055 | eps=0.092 | success=0.938 | hit=0.938 | stage2=0.562 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.062 | invalid_tok=0.000 | avg_ep_reward=1.304 | avg_path=4.16 | valid_steps=3.09
[2025-11-19 16:51:03,328][INFO] Iter   1150 | loss=0.1064 | td_err=0.0919 | kl=1.9463 | temp=0.058 | eps=0.091 | success=0.938 | hit=0.938 | stage2=0.625 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.274 | avg_path=4.28 | valid_steps=3.28
[2025-11-19 16:51:09,196][INFO] Iter   1200 | loss=0.1046 | td_err=0.0890 | kl=1.9131 | temp=0.060 | eps=0.091 | success=0.969 | hit=0.969 | stage2=0.625 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.337 | avg_path=3.78 | valid_steps=2.78
[2025-11-19 16:51:15,088][INFO] Iter   1250 | loss=0.1432 | td_err=0.1076 | kl=2.0197 | temp=0.062 | eps=0.091 | success=0.844 | hit=0.844 | stage2=0.625 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.062 | invalid_tok=0.000 | avg_ep_reward=1.159 | avg_path=3.62 | valid_steps=2.56
[2025-11-19 16:51:20,945][INFO] Iter   1300 | loss=0.1059 | td_err=0.0920 | kl=1.9278 | temp=0.065 | eps=0.090 | success=0.906 | hit=0.906 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=1.273 | avg_path=3.91 | valid_steps=2.88
[2025-11-19 16:51:26,770][INFO] Iter   1350 | loss=0.1135 | td_err=0.1014 | kl=1.8192 | temp=0.068 | eps=0.090 | success=0.938 | hit=0.938 | stage2=0.500 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.361 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 16:51:32,515][INFO] Iter   1400 | loss=0.0920 | td_err=0.0731 | kl=1.7732 | temp=0.070 | eps=0.090 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.390 | avg_path=4.56 | valid_steps=3.56
[2025-11-19 16:51:38,264][INFO] Iter   1450 | loss=0.1083 | td_err=0.0953 | kl=1.7519 | temp=0.072 | eps=0.089 | success=0.906 | hit=0.906 | stage2=0.469 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=1.256 | avg_path=3.22 | valid_steps=2.19
[2025-11-19 16:51:44,041][INFO] Iter   1500 | loss=0.0885 | td_err=0.0749 | kl=1.6789 | temp=0.075 | eps=0.089 | success=0.969 | hit=0.969 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.402 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 16:51:49,869][INFO] Iter   1550 | loss=0.0992 | td_err=0.0941 | kl=1.7417 | temp=0.077 | eps=0.088 | success=0.938 | hit=0.938 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.316 | avg_path=3.72 | valid_steps=2.72
[2025-11-19 16:51:55,570][INFO] Iter   1600 | loss=0.0872 | td_err=0.0695 | kl=1.7143 | temp=0.080 | eps=0.088 | success=0.969 | hit=0.969 | stage2=0.531 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.378 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 16:52:01,342][INFO] Iter   1650 | loss=0.0893 | td_err=0.0742 | kl=1.7389 | temp=0.083 | eps=0.088 | success=0.906 | hit=0.906 | stage2=0.625 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.281 | avg_path=3.31 | valid_steps=2.31
[2025-11-19 16:52:07,169][INFO] Iter   1700 | loss=0.0938 | td_err=0.0871 | kl=1.6940 | temp=0.085 | eps=0.087 | success=0.844 | hit=0.844 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.203 | avg_path=4.22 | valid_steps=3.22
[2025-11-19 16:52:12,935][INFO] Iter   1750 | loss=0.0806 | td_err=0.0721 | kl=1.5851 | temp=0.088 | eps=0.087 | success=1.000 | hit=1.000 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.442 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 16:52:18,709][INFO] Iter   1800 | loss=0.0828 | td_err=0.0745 | kl=1.5773 | temp=0.090 | eps=0.087 | success=0.969 | hit=0.969 | stage2=0.625 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.397 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 16:52:24,496][INFO] Iter   1850 | loss=0.1195 | td_err=0.1027 | kl=1.5909 | temp=0.092 | eps=0.086 | success=0.906 | hit=0.906 | stage2=0.562 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.062 | invalid_tok=0.000 | avg_ep_reward=1.276 | avg_path=3.38 | valid_steps=2.31
[2025-11-19 16:52:30,270][INFO] Iter   1900 | loss=0.0758 | td_err=0.0568 | kl=1.5407 | temp=0.095 | eps=0.086 | success=0.969 | hit=0.969 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.399 | avg_path=3.31 | valid_steps=2.31
[2025-11-19 16:52:35,986][INFO] Iter   1950 | loss=0.0815 | td_err=0.0683 | kl=1.5504 | temp=0.098 | eps=0.085 | success=1.000 | hit=1.000 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.446 | avg_path=3.16 | valid_steps=2.16
[2025-11-19 16:52:41,738][INFO] Iter   2000 | loss=0.0768 | td_err=0.0735 | kl=1.4524 | temp=0.100 | eps=0.085 | success=0.938 | hit=0.938 | stage2=0.688 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.360 | avg_path=4.34 | valid_steps=3.34
[2025-11-19 16:52:44,039][INFO] ---- Evaluation at iter 2000 ----
[2025-11-19 16:52:44,039][INFO]   S1->S2: 43.82% (39 / 89)
[2025-11-19 16:52:44,040][INFO]   S2->S3: 73.63% (67 / 91)
[2025-11-19 16:52:44,040][INFO]   S1->S3: 74.07% (100 / 135)
[2025-11-19 16:52:44,040][INFO]   overall: 65.40% (206 / 315)
[2025-11-19 16:52:44,044][INFO] Saved Q-learning checkpoint to out_ql_no_target/ql_20251119_164818/ckpt_ql_2000.pt
[2025-11-19 16:52:49,779][INFO] Iter   2050 | loss=0.0744 | td_err=0.0589 | kl=1.5038 | temp=0.102 | eps=0.085 | success=0.969 | hit=0.969 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.402 | avg_path=3.50 | valid_steps=2.50
[2025-11-19 16:52:55,502][INFO] Iter   2100 | loss=0.0727 | td_err=0.0590 | kl=1.4727 | temp=0.105 | eps=0.084 | success=0.938 | hit=0.938 | stage2=0.719 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.362 | avg_path=3.44 | valid_steps=2.44
[2025-11-19 16:53:01,274][INFO] Iter   2150 | loss=0.0727 | td_err=0.0652 | kl=1.4163 | temp=0.107 | eps=0.084 | success=0.969 | hit=0.969 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.418 | avg_path=3.47 | valid_steps=2.47
[2025-11-19 16:53:07,031][INFO] Iter   2200 | loss=0.0710 | td_err=0.0687 | kl=1.4376 | temp=0.110 | eps=0.084 | success=1.000 | hit=1.000 | stage2=0.656 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.444 | avg_path=3.28 | valid_steps=2.28
[2025-11-19 16:53:12,779][INFO] Iter   2250 | loss=0.0674 | td_err=0.0558 | kl=1.4048 | temp=0.112 | eps=0.083 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.461 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 16:53:18,560][INFO] Iter   2300 | loss=0.0642 | td_err=0.0506 | kl=1.3472 | temp=0.115 | eps=0.083 | success=0.875 | hit=0.875 | stage2=0.844 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.299 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 16:53:24,316][INFO] Iter   2350 | loss=0.0693 | td_err=0.0671 | kl=1.3305 | temp=0.117 | eps=0.082 | success=0.875 | hit=0.875 | stage2=0.781 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.317 | avg_path=3.50 | valid_steps=2.50
[2025-11-19 16:53:30,009][INFO] Iter   2400 | loss=0.0681 | td_err=0.0670 | kl=1.3443 | temp=0.120 | eps=0.082 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.490 | avg_path=3.62 | valid_steps=2.62
[2025-11-19 16:53:35,810][INFO] Iter   2450 | loss=0.0651 | td_err=0.0630 | kl=1.3262 | temp=0.122 | eps=0.082 | success=0.938 | hit=0.938 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.373 | avg_path=4.03 | valid_steps=3.03
[2025-11-19 16:53:41,626][INFO] Iter   2500 | loss=0.0626 | td_err=0.0537 | kl=1.3125 | temp=0.125 | eps=0.081 | success=0.938 | hit=0.938 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.401 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 16:53:47,440][INFO] Iter   2550 | loss=0.0624 | td_err=0.0607 | kl=1.2608 | temp=0.128 | eps=0.081 | success=0.969 | hit=0.969 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.406 | avg_path=3.62 | valid_steps=2.62
[2025-11-19 16:53:53,175][INFO] Iter   2600 | loss=0.0624 | td_err=0.0616 | kl=1.2748 | temp=0.130 | eps=0.081 | success=0.969 | hit=0.969 | stage2=0.594 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.388 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 16:53:58,905][INFO] Iter   2650 | loss=0.0620 | td_err=0.0651 | kl=1.2490 | temp=0.132 | eps=0.080 | success=0.906 | hit=0.906 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.384 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 16:54:04,720][INFO] Iter   2700 | loss=0.0593 | td_err=0.0603 | kl=1.2103 | temp=0.135 | eps=0.080 | success=0.969 | hit=0.969 | stage2=0.750 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.428 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 16:54:10,455][INFO] Iter   2750 | loss=0.0608 | td_err=0.0741 | kl=1.2132 | temp=0.137 | eps=0.079 | success=0.969 | hit=0.969 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.431 | avg_path=3.78 | valid_steps=2.78
[2025-11-19 16:54:16,204][INFO] Iter   2800 | loss=0.0575 | td_err=0.0612 | kl=1.1830 | temp=0.140 | eps=0.079 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.384 | avg_path=3.62 | valid_steps=2.62
[2025-11-19 16:54:21,839][INFO] Iter   2850 | loss=0.0569 | td_err=0.0647 | kl=1.1503 | temp=0.142 | eps=0.079 | success=0.969 | hit=0.969 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.477 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 16:54:27,460][INFO] Iter   2900 | loss=0.0585 | td_err=0.0688 | kl=1.1754 | temp=0.145 | eps=0.078 | success=1.000 | hit=1.000 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.465 | avg_path=3.78 | valid_steps=2.78
[2025-11-19 16:54:33,211][INFO] Iter   2950 | loss=0.0604 | td_err=0.0656 | kl=1.2174 | temp=0.147 | eps=0.078 | success=0.938 | hit=0.938 | stage2=0.656 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.390 | avg_path=3.62 | valid_steps=2.62
[2025-11-19 16:54:38,939][INFO] Iter   3000 | loss=0.0545 | td_err=0.0586 | kl=1.1387 | temp=0.150 | eps=0.077 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.475 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 16:54:41,264][INFO] ---- Evaluation at iter 3000 ----
[2025-11-19 16:54:41,264][INFO]   S1->S2: 98.88% (88 / 89)
[2025-11-19 16:54:41,264][INFO]   S2->S3: 90.11% (82 / 91)
[2025-11-19 16:54:41,264][INFO]   S1->S3: 88.89% (120 / 135)
[2025-11-19 16:54:41,264][INFO]   overall: 92.06% (290 / 315)
[2025-11-19 16:54:46,895][INFO] Iter   3050 | loss=0.0580 | td_err=0.0624 | kl=1.2064 | temp=0.152 | eps=0.077 | success=0.938 | hit=0.938 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.365 | avg_path=3.47 | valid_steps=2.47
[2025-11-19 16:54:52,616][INFO] Iter   3100 | loss=0.0545 | td_err=0.0645 | kl=1.0998 | temp=0.155 | eps=0.077 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.397 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 16:54:58,423][INFO] Iter   3150 | loss=0.0489 | td_err=0.0534 | kl=1.0374 | temp=0.158 | eps=0.076 | success=1.000 | hit=1.000 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.492 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 16:55:04,314][INFO] Iter   3200 | loss=0.0505 | td_err=0.0506 | kl=1.0702 | temp=0.160 | eps=0.076 | success=0.906 | hit=0.906 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.359 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 16:55:10,011][INFO] Iter   3250 | loss=0.0532 | td_err=0.0543 | kl=1.1356 | temp=0.162 | eps=0.076 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.467 | avg_path=3.34 | valid_steps=2.34
[2025-11-19 16:55:15,711][INFO] Iter   3300 | loss=0.0510 | td_err=0.0523 | kl=1.1032 | temp=0.165 | eps=0.075 | success=1.000 | hit=1.000 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.475 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 16:55:21,457][INFO] Iter   3350 | loss=0.0530 | td_err=0.0663 | kl=1.0630 | temp=0.168 | eps=0.075 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.425 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 16:55:27,155][INFO] Iter   3400 | loss=0.0503 | td_err=0.0653 | kl=1.0246 | temp=0.170 | eps=0.075 | success=1.000 | hit=1.000 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.500 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 16:55:32,834][INFO] Iter   3450 | loss=0.0503 | td_err=0.0589 | kl=1.0803 | temp=0.172 | eps=0.074 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.479 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 16:55:38,570][INFO] Iter   3500 | loss=0.0497 | td_err=0.0654 | kl=1.0213 | temp=0.175 | eps=0.074 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.471 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 16:55:44,326][INFO] Iter   3550 | loss=0.0493 | td_err=0.0644 | kl=1.0283 | temp=0.177 | eps=0.073 | success=0.969 | hit=0.969 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.474 | avg_path=4.09 | valid_steps=3.09
[2025-11-19 16:55:50,117][INFO] Iter   3600 | loss=0.0512 | td_err=0.0652 | kl=1.0394 | temp=0.180 | eps=0.073 | success=0.875 | hit=0.875 | stage2=0.562 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.296 | avg_path=3.47 | valid_steps=2.47
[2025-11-19 16:55:55,824][INFO] Iter   3650 | loss=0.0487 | td_err=0.0723 | kl=0.9870 | temp=0.182 | eps=0.073 | success=0.938 | hit=0.938 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.411 | avg_path=3.97 | valid_steps=2.97
[2025-11-19 16:56:01,548][INFO] Iter   3700 | loss=0.0528 | td_err=0.0789 | kl=1.0552 | temp=0.185 | eps=0.072 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.396 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 16:56:07,193][INFO] Iter   3750 | loss=0.0478 | td_err=0.0573 | kl=1.0073 | temp=0.188 | eps=0.072 | success=0.938 | hit=0.938 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.417 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 16:56:12,868][INFO] Iter   3800 | loss=0.0474 | td_err=0.0690 | kl=0.9661 | temp=0.190 | eps=0.072 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.446 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 16:56:18,603][INFO] Iter   3850 | loss=0.0488 | td_err=0.0648 | kl=1.0116 | temp=0.193 | eps=0.071 | success=0.969 | hit=0.969 | stage2=0.625 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.403 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 16:56:24,378][INFO] Iter   3900 | loss=0.0478 | td_err=0.0722 | kl=0.9606 | temp=0.195 | eps=0.071 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.449 | avg_path=4.09 | valid_steps=3.09
[2025-11-19 16:56:30,120][INFO] Iter   3950 | loss=0.0468 | td_err=0.0548 | kl=1.0206 | temp=0.197 | eps=0.070 | success=1.000 | hit=1.000 | stage2=0.625 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.480 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 16:56:35,934][INFO] Iter   4000 | loss=0.0469 | td_err=0.0601 | kl=1.0165 | temp=0.200 | eps=0.070 | success=1.000 | hit=1.000 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.460 | avg_path=3.41 | valid_steps=2.41
[2025-11-19 16:56:38,233][INFO] ---- Evaluation at iter 4000 ----
[2025-11-19 16:56:38,233][INFO]   S1->S2: 100.00% (89 / 89)
[2025-11-19 16:56:38,233][INFO]   S2->S3: 91.21% (83 / 91)
[2025-11-19 16:56:38,233][INFO]   S1->S3: 73.33% (99 / 135)
[2025-11-19 16:56:38,233][INFO]   overall: 86.03% (271 / 315)
[2025-11-19 16:56:38,237][INFO] Saved Q-learning checkpoint to out_ql_no_target/ql_20251119_164818/ckpt_ql_4000.pt
[2025-11-19 16:56:43,993][INFO] Iter   4050 | loss=0.0448 | td_err=0.0663 | kl=0.9307 | temp=0.203 | eps=0.070 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.480 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 16:56:49,738][INFO] Iter   4100 | loss=0.0428 | td_err=0.0547 | kl=0.9384 | temp=0.205 | eps=0.069 | success=0.969 | hit=0.969 | stage2=0.656 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.411 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 16:56:55,524][INFO] Iter   4150 | loss=0.0422 | td_err=0.0602 | kl=0.9081 | temp=0.207 | eps=0.069 | success=0.875 | hit=0.875 | stage2=0.719 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.305 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 16:57:01,368][INFO] Iter   4200 | loss=0.0466 | td_err=0.0704 | kl=0.9517 | temp=0.210 | eps=0.069 | success=1.000 | hit=1.000 | stage2=0.656 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.435 | avg_path=3.72 | valid_steps=2.72
[2025-11-19 16:57:07,194][INFO] Iter   4250 | loss=0.0442 | td_err=0.0653 | kl=0.9143 | temp=0.212 | eps=0.068 | success=0.938 | hit=0.938 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.400 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 16:57:12,955][INFO] Iter   4300 | loss=0.0446 | td_err=0.0752 | kl=0.8826 | temp=0.215 | eps=0.068 | success=0.938 | hit=0.938 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.404 | avg_path=3.41 | valid_steps=2.41
[2025-11-19 16:57:18,684][INFO] Iter   4350 | loss=0.0397 | td_err=0.0493 | kl=0.9055 | temp=0.217 | eps=0.067 | success=0.906 | hit=0.906 | stage2=0.562 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.328 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 16:57:24,441][INFO] Iter   4400 | loss=0.0419 | td_err=0.0620 | kl=0.8962 | temp=0.220 | eps=0.067 | success=0.906 | hit=0.906 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.327 | avg_path=3.97 | valid_steps=2.97
[2025-11-19 16:57:30,199][INFO] Iter   4450 | loss=0.0366 | td_err=0.0522 | kl=0.8227 | temp=0.223 | eps=0.067 | success=0.906 | hit=0.906 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.362 | avg_path=4.25 | valid_steps=3.25
[2025-11-19 16:57:35,950][INFO] Iter   4500 | loss=0.0395 | td_err=0.0628 | kl=0.8436 | temp=0.225 | eps=0.066 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.484 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 16:57:41,712][INFO] Iter   4550 | loss=0.0448 | td_err=0.0690 | kl=0.8889 | temp=0.227 | eps=0.066 | success=0.906 | hit=0.906 | stage2=0.719 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.352 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 16:57:47,487][INFO] Iter   4600 | loss=0.0394 | td_err=0.0593 | kl=0.8363 | temp=0.230 | eps=0.066 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.532 | avg_path=4.00 | valid_steps=3.00
[2025-11-19 16:57:53,245][INFO] Iter   4650 | loss=0.0376 | td_err=0.0515 | kl=0.8523 | temp=0.232 | eps=0.065 | success=0.938 | hit=0.938 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.394 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 16:57:59,005][INFO] Iter   4700 | loss=0.0406 | td_err=0.0660 | kl=0.8490 | temp=0.235 | eps=0.065 | success=0.969 | hit=0.969 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.486 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 16:58:04,802][INFO] Iter   4750 | loss=0.0399 | td_err=0.0697 | kl=0.8142 | temp=0.237 | eps=0.064 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.486 | avg_path=3.97 | valid_steps=2.97
[2025-11-19 16:58:10,597][INFO] Iter   4800 | loss=0.0382 | td_err=0.0629 | kl=0.8364 | temp=0.240 | eps=0.064 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.485 | avg_path=3.72 | valid_steps=2.72
[2025-11-19 16:58:16,375][INFO] Iter   4850 | loss=0.0390 | td_err=0.0638 | kl=0.8157 | temp=0.242 | eps=0.064 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.467 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 16:58:22,192][INFO] Iter   4900 | loss=0.0419 | td_err=0.0730 | kl=0.8432 | temp=0.245 | eps=0.063 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.460 | avg_path=4.19 | valid_steps=3.19
[2025-11-19 16:58:27,975][INFO] Iter   4950 | loss=0.0402 | td_err=0.0686 | kl=0.8156 | temp=0.247 | eps=0.063 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.509 | avg_path=4.06 | valid_steps=3.06
[2025-11-19 16:58:33,798][INFO] Iter   5000 | loss=0.0352 | td_err=0.0467 | kl=0.8343 | temp=0.250 | eps=0.062 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.463 | avg_path=3.72 | valid_steps=2.72
[2025-11-19 16:58:36,104][INFO] ---- Evaluation at iter 5000 ----
[2025-11-19 16:58:36,105][INFO]   S1->S2: 100.00% (89 / 89)
[2025-11-19 16:58:36,105][INFO]   S2->S3: 95.60% (87 / 91)
[2025-11-19 16:58:36,105][INFO]   S1->S3: 72.59% (98 / 135)
[2025-11-19 16:58:36,105][INFO]   overall: 86.98% (274 / 315)
[2025-11-19 16:58:41,911][INFO] Iter   5050 | loss=0.0383 | td_err=0.0525 | kl=0.8620 | temp=0.253 | eps=0.062 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.464 | avg_path=3.53 | valid_steps=2.53
[2025-11-19 16:58:47,676][INFO] Iter   5100 | loss=0.0383 | td_err=0.0678 | kl=0.7934 | temp=0.255 | eps=0.062 | success=0.938 | hit=0.938 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.420 | avg_path=3.84 | valid_steps=2.84
[2025-11-19 16:58:53,454][INFO] Iter   5150 | loss=0.0388 | td_err=0.0660 | kl=0.8375 | temp=0.257 | eps=0.061 | success=0.938 | hit=0.938 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.397 | avg_path=4.03 | valid_steps=3.03
[2025-11-19 16:58:59,260][INFO] Iter   5200 | loss=0.0359 | td_err=0.0577 | kl=0.7946 | temp=0.260 | eps=0.061 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.514 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 16:59:05,116][INFO] Iter   5250 | loss=0.0377 | td_err=0.0731 | kl=0.7599 | temp=0.263 | eps=0.061 | success=0.938 | hit=0.938 | stage2=0.750 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.400 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 16:59:10,934][INFO] Iter   5300 | loss=0.0374 | td_err=0.0693 | kl=0.7762 | temp=0.265 | eps=0.060 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.455 | avg_path=4.12 | valid_steps=3.12
[2025-11-19 16:59:16,749][INFO] Iter   5350 | loss=0.0380 | td_err=0.0686 | kl=0.7858 | temp=0.268 | eps=0.060 | success=0.969 | hit=0.969 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.438 | avg_path=4.19 | valid_steps=3.19
[2025-11-19 16:59:22,515][INFO] Iter   5400 | loss=0.0337 | td_err=0.0565 | kl=0.7594 | temp=0.270 | eps=0.059 | success=0.969 | hit=0.969 | stage2=0.500 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.428 | avg_path=3.28 | valid_steps=2.28
[2025-11-19 16:59:28,294][INFO] Iter   5450 | loss=0.0338 | td_err=0.0400 | kl=0.8496 | temp=0.272 | eps=0.059 | success=0.938 | hit=0.938 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.419 | avg_path=3.28 | valid_steps=2.28
[2025-11-19 16:59:34,057][INFO] Iter   5500 | loss=0.0299 | td_err=0.0431 | kl=0.7347 | temp=0.275 | eps=0.059 | success=0.938 | hit=0.938 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.451 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 16:59:39,848][INFO] Iter   5550 | loss=0.0337 | td_err=0.0500 | kl=0.8047 | temp=0.278 | eps=0.058 | success=0.906 | hit=0.906 | stage2=0.719 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.343 | avg_path=3.47 | valid_steps=2.47
[2025-11-19 16:59:45,691][INFO] Iter   5600 | loss=0.0322 | td_err=0.0526 | kl=0.7603 | temp=0.280 | eps=0.058 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.469 | avg_path=3.56 | valid_steps=2.56
[2025-11-19 16:59:51,504][INFO] Iter   5650 | loss=0.0373 | td_err=0.0716 | kl=0.7299 | temp=0.282 | eps=0.058 | success=1.000 | hit=1.000 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.518 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 16:59:57,244][INFO] Iter   5700 | loss=0.0354 | td_err=0.0629 | kl=0.7890 | temp=0.285 | eps=0.057 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.462 | avg_path=3.47 | valid_steps=2.47
[2025-11-19 17:00:03,079][INFO] Iter   5750 | loss=0.0317 | td_err=0.0599 | kl=0.7144 | temp=0.287 | eps=0.057 | success=0.969 | hit=0.969 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.463 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 17:00:09,003][INFO] Iter   5800 | loss=0.0384 | td_err=0.0806 | kl=0.7534 | temp=0.290 | eps=0.057 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.470 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 17:00:14,758][INFO] Iter   5850 | loss=0.0380 | td_err=0.0678 | kl=0.7491 | temp=0.292 | eps=0.056 | success=0.938 | hit=0.938 | stage2=0.781 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.396 | avg_path=3.78 | valid_steps=2.78
[2025-11-19 17:00:20,572][INFO] Iter   5900 | loss=0.0367 | td_err=0.0699 | kl=0.7653 | temp=0.295 | eps=0.056 | success=0.906 | hit=0.906 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.356 | avg_path=3.78 | valid_steps=2.78
[2025-11-19 17:00:26,383][INFO] Iter   5950 | loss=0.0311 | td_err=0.0587 | kl=0.7047 | temp=0.297 | eps=0.055 | success=0.938 | hit=0.938 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.421 | avg_path=3.94 | valid_steps=2.94
[2025-11-19 17:00:32,194][INFO] Iter   6000 | loss=0.0337 | td_err=0.0692 | kl=0.6850 | temp=0.300 | eps=0.055 | success=0.969 | hit=0.969 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.434 | avg_path=4.22 | valid_steps=3.22
[2025-11-19 17:00:34,503][INFO] ---- Evaluation at iter 6000 ----
[2025-11-19 17:00:34,503][INFO]   S1->S2: 100.00% (89 / 89)
[2025-11-19 17:00:34,503][INFO]   S2->S3: 95.60% (87 / 91)
[2025-11-19 17:00:34,503][INFO]   S1->S3: 71.85% (97 / 135)
[2025-11-19 17:00:34,503][INFO]   overall: 86.67% (273 / 315)
[2025-11-19 17:00:34,509][INFO] Saved Q-learning checkpoint to out_ql_no_target/ql_20251119_164818/ckpt_ql_6000.pt
[2025-11-19 17:00:40,359][INFO] Iter   6050 | loss=0.0323 | td_err=0.0587 | kl=0.7308 | temp=0.300 | eps=0.055 | success=0.938 | hit=0.938 | stage2=0.781 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.441 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 17:00:46,159][INFO] Iter   6100 | loss=0.0300 | td_err=0.0583 | kl=0.6877 | temp=0.300 | eps=0.054 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.441 | avg_path=4.06 | valid_steps=3.06
[2025-11-19 17:00:51,917][INFO] Iter   6150 | loss=0.0306 | td_err=0.0530 | kl=0.7259 | temp=0.300 | eps=0.054 | success=1.000 | hit=1.000 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.508 | avg_path=3.22 | valid_steps=2.22
[2025-11-19 17:00:57,648][INFO] Iter   6200 | loss=0.0305 | td_err=0.0557 | kl=0.7288 | temp=0.300 | eps=0.053 | success=0.875 | hit=0.875 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.289 | avg_path=3.38 | valid_steps=2.38
[2025-11-19 17:01:03,460][INFO] Iter   6250 | loss=0.0301 | td_err=0.0553 | kl=0.6990 | temp=0.300 | eps=0.053 | success=1.000 | hit=1.000 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.506 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 17:01:09,198][INFO] Iter   6300 | loss=0.0318 | td_err=0.0627 | kl=0.7218 | temp=0.300 | eps=0.053 | success=0.969 | hit=0.969 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.456 | avg_path=3.62 | valid_steps=2.62
[2025-11-19 17:01:14,972][INFO] Iter   6350 | loss=0.0350 | td_err=0.0768 | kl=0.6961 | temp=0.300 | eps=0.052 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.481 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 17:01:20,760][INFO] Iter   6400 | loss=0.0339 | td_err=0.0755 | kl=0.6683 | temp=0.300 | eps=0.052 | success=1.000 | hit=1.000 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.509 | avg_path=3.62 | valid_steps=2.62
[2025-11-19 17:01:26,653][INFO] Iter   6450 | loss=0.0280 | td_err=0.0534 | kl=0.6867 | temp=0.300 | eps=0.052 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.539 | avg_path=3.84 | valid_steps=2.84
[2025-11-19 17:01:32,570][INFO] Iter   6500 | loss=0.0291 | td_err=0.0567 | kl=0.6651 | temp=0.300 | eps=0.051 | success=0.906 | hit=0.906 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.372 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 17:01:38,423][INFO] Iter   6550 | loss=0.0271 | td_err=0.0516 | kl=0.6673 | temp=0.300 | eps=0.051 | success=0.938 | hit=0.938 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.422 | avg_path=3.72 | valid_steps=2.72
[2025-11-19 17:01:44,310][INFO] Iter   6600 | loss=0.0278 | td_err=0.0585 | kl=0.6394 | temp=0.300 | eps=0.050 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.518 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 17:01:50,166][INFO] Iter   6650 | loss=0.0276 | td_err=0.0531 | kl=0.6771 | temp=0.300 | eps=0.050 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.454 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 17:01:56,069][INFO] Iter   6700 | loss=0.0314 | td_err=0.0766 | kl=0.6369 | temp=0.300 | eps=0.050 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.469 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 17:02:01,901][INFO] Iter   6750 | loss=0.0276 | td_err=0.0522 | kl=0.6917 | temp=0.300 | eps=0.049 | success=1.000 | hit=1.000 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.494 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 17:02:07,746][INFO] Iter   6800 | loss=0.0291 | td_err=0.0652 | kl=0.6220 | temp=0.300 | eps=0.049 | success=0.844 | hit=0.844 | stage2=0.844 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.296 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 17:02:13,534][INFO] Iter   6850 | loss=0.0277 | td_err=0.0608 | kl=0.6432 | temp=0.300 | eps=0.049 | success=0.938 | hit=0.938 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.395 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 17:02:19,344][INFO] Iter   6900 | loss=0.0279 | td_err=0.0569 | kl=0.6634 | temp=0.300 | eps=0.048 | success=0.969 | hit=0.969 | stage2=0.656 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.436 | avg_path=3.53 | valid_steps=2.53
[2025-11-19 17:02:25,115][INFO] Iter   6950 | loss=0.0275 | td_err=0.0603 | kl=0.6494 | temp=0.300 | eps=0.048 | success=0.969 | hit=0.969 | stage2=0.719 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.448 | avg_path=3.53 | valid_steps=2.53
[2025-11-19 17:02:30,943][INFO] Iter   7000 | loss=0.0265 | td_err=0.0554 | kl=0.6341 | temp=0.300 | eps=0.047 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.432 | avg_path=3.84 | valid_steps=2.84
[2025-11-19 17:02:33,252][INFO] ---- Evaluation at iter 7000 ----
[2025-11-19 17:02:33,252][INFO]   S1->S2: 100.00% (89 / 89)
[2025-11-19 17:02:33,252][INFO]   S2->S3: 95.60% (87 / 91)
[2025-11-19 17:02:33,252][INFO]   S1->S3: 57.04% (77 / 135)
[2025-11-19 17:02:33,252][INFO]   overall: 80.32% (253 / 315)
[2025-11-19 17:02:39,104][INFO] Iter   7050 | loss=0.0276 | td_err=0.0619 | kl=0.6418 | temp=0.300 | eps=0.047 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.504 | avg_path=3.56 | valid_steps=2.56
[2025-11-19 17:02:44,865][INFO] Iter   7100 | loss=0.0277 | td_err=0.0573 | kl=0.6523 | temp=0.300 | eps=0.047 | success=0.938 | hit=0.938 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.426 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 17:02:50,673][INFO] Iter   7150 | loss=0.0274 | td_err=0.0577 | kl=0.6386 | temp=0.300 | eps=0.046 | success=0.969 | hit=0.969 | stage2=0.562 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.456 | avg_path=3.47 | valid_steps=2.47
[2025-11-19 17:02:56,499][INFO] Iter   7200 | loss=0.0277 | td_err=0.0629 | kl=0.6181 | temp=0.300 | eps=0.046 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.473 | avg_path=4.00 | valid_steps=3.00
[2025-11-19 17:03:02,289][INFO] Iter   7250 | loss=0.0245 | td_err=0.0627 | kl=0.5630 | temp=0.300 | eps=0.046 | success=1.000 | hit=1.000 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.550 | avg_path=4.22 | valid_steps=3.22
[2025-11-19 17:03:08,146][INFO] Iter   7300 | loss=0.0301 | td_err=0.0744 | kl=0.6282 | temp=0.300 | eps=0.045 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.463 | avg_path=3.56 | valid_steps=2.56
[2025-11-19 17:03:13,983][INFO] Iter   7350 | loss=0.0279 | td_err=0.0631 | kl=0.6288 | temp=0.300 | eps=0.045 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.449 | avg_path=3.94 | valid_steps=2.94
[2025-11-19 17:03:19,790][INFO] Iter   7400 | loss=0.0246 | td_err=0.0555 | kl=0.5917 | temp=0.300 | eps=0.044 | success=0.938 | hit=0.938 | stage2=0.781 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.436 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 17:03:25,632][INFO] Iter   7450 | loss=0.0252 | td_err=0.0615 | kl=0.5794 | temp=0.300 | eps=0.044 | success=0.969 | hit=0.969 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.488 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 17:03:31,459][INFO] Iter   7500 | loss=0.0273 | td_err=0.0731 | kl=0.5730 | temp=0.300 | eps=0.044 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.488 | avg_path=4.03 | valid_steps=3.03
[2025-11-19 17:03:37,367][INFO] Iter   7550 | loss=0.0262 | td_err=0.0611 | kl=0.6208 | temp=0.300 | eps=0.043 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.468 | avg_path=3.62 | valid_steps=2.62
[2025-11-19 17:03:43,213][INFO] Iter   7600 | loss=0.0244 | td_err=0.0462 | kl=0.6555 | temp=0.300 | eps=0.043 | success=0.938 | hit=0.938 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.400 | avg_path=3.28 | valid_steps=2.28
[2025-11-19 17:03:49,099][INFO] Iter   7650 | loss=0.0251 | td_err=0.0639 | kl=0.5857 | temp=0.300 | eps=0.043 | success=0.969 | hit=0.969 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.491 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 17:03:54,957][INFO] Iter   7700 | loss=0.0287 | td_err=0.0712 | kl=0.6360 | temp=0.300 | eps=0.042 | success=0.969 | hit=0.969 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.409 | avg_path=3.28 | valid_steps=2.28
[2025-11-19 17:04:00,834][INFO] Iter   7750 | loss=0.0257 | td_err=0.0661 | kl=0.5833 | temp=0.300 | eps=0.042 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.456 | avg_path=3.94 | valid_steps=2.94
[2025-11-19 17:04:06,730][INFO] Iter   7800 | loss=0.0240 | td_err=0.0567 | kl=0.5667 | temp=0.300 | eps=0.041 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.482 | avg_path=4.31 | valid_steps=3.31
[2025-11-19 17:04:12,637][INFO] Iter   7850 | loss=0.0231 | td_err=0.0565 | kl=0.5430 | temp=0.300 | eps=0.041 | success=1.000 | hit=1.000 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.515 | avg_path=3.94 | valid_steps=2.94
[2025-11-19 17:04:18,996][INFO] Iter   7900 | loss=0.0213 | td_err=0.0492 | kl=0.5510 | temp=0.300 | eps=0.041 | success=0.938 | hit=0.938 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.453 | avg_path=3.94 | valid_steps=2.94
[2025-11-19 17:04:25,061][INFO] Iter   7950 | loss=0.0246 | td_err=0.0625 | kl=0.5671 | temp=0.300 | eps=0.040 | success=0.969 | hit=0.969 | stage2=0.906 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.514 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 17:04:30,905][INFO] Iter   8000 | loss=0.0274 | td_err=0.0738 | kl=0.5624 | temp=0.300 | eps=0.040 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.531 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 17:04:33,212][INFO] ---- Evaluation at iter 8000 ----
[2025-11-19 17:04:33,213][INFO]   S1->S2: 100.00% (89 / 89)
[2025-11-19 17:04:33,213][INFO]   S2->S3: 95.60% (87 / 91)
[2025-11-19 17:04:33,213][INFO]   S1->S3: 65.19% (88 / 135)
[2025-11-19 17:04:33,213][INFO]   overall: 83.81% (264 / 315)
[2025-11-19 17:04:33,217][INFO] Saved Q-learning checkpoint to out_ql_no_target/ql_20251119_164818/ckpt_ql_8000.pt
[2025-11-19 17:04:39,078][INFO] Iter   8050 | loss=0.0248 | td_err=0.0651 | kl=0.5706 | temp=0.300 | eps=0.040 | success=1.000 | hit=1.000 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.520 | avg_path=3.84 | valid_steps=2.84
[2025-11-19 17:04:44,993][INFO] Iter   8100 | loss=0.0306 | td_err=0.0806 | kl=0.5749 | temp=0.300 | eps=0.039 | success=0.938 | hit=0.938 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.414 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 17:04:50,833][INFO] Iter   8150 | loss=0.0204 | td_err=0.0542 | kl=0.5008 | temp=0.300 | eps=0.039 | success=0.969 | hit=0.969 | stage2=1.000 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.536 | avg_path=4.47 | valid_steps=3.47
[2025-11-19 17:04:56,720][INFO] Iter   8200 | loss=0.0275 | td_err=0.0759 | kl=0.5674 | temp=0.300 | eps=0.038 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.516 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 17:05:02,564][INFO] Iter   8250 | loss=0.0254 | td_err=0.0639 | kl=0.5681 | temp=0.300 | eps=0.038 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.479 | avg_path=3.72 | valid_steps=2.72
[2025-11-19 17:05:08,407][INFO] Iter   8300 | loss=0.0245 | td_err=0.0666 | kl=0.5522 | temp=0.300 | eps=0.038 | success=0.969 | hit=0.969 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.456 | avg_path=3.62 | valid_steps=2.62
[2025-11-19 17:05:14,327][INFO] Iter   8350 | loss=0.0232 | td_err=0.0607 | kl=0.5784 | temp=0.300 | eps=0.037 | success=0.938 | hit=0.938 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.458 | avg_path=4.00 | valid_steps=3.00
[2025-11-19 17:05:20,153][INFO] Iter   8400 | loss=0.0224 | td_err=0.0569 | kl=0.5772 | temp=0.300 | eps=0.037 | success=0.938 | hit=0.938 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.439 | avg_path=3.84 | valid_steps=2.84
[2025-11-19 17:05:26,070][INFO] Iter   8450 | loss=0.0215 | td_err=0.0551 | kl=0.5285 | temp=0.300 | eps=0.037 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.474 | avg_path=4.09 | valid_steps=3.09
[2025-11-19 17:05:31,932][INFO] Iter   8500 | loss=0.0220 | td_err=0.0562 | kl=0.5603 | temp=0.300 | eps=0.036 | success=0.875 | hit=0.875 | stage2=0.844 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.286 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 17:05:37,823][INFO] Iter   8550 | loss=0.0223 | td_err=0.0628 | kl=0.5303 | temp=0.300 | eps=0.036 | success=0.938 | hit=0.938 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.420 | avg_path=3.84 | valid_steps=2.84
[2025-11-19 17:05:43,674][INFO] Iter   8600 | loss=0.0239 | td_err=0.0597 | kl=0.5820 | temp=0.300 | eps=0.036 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.437 | avg_path=3.62 | valid_steps=2.62
[2025-11-19 17:05:49,431][INFO] Iter   8650 | loss=0.0218 | td_err=0.0544 | kl=0.5450 | temp=0.300 | eps=0.035 | success=1.000 | hit=1.000 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.536 | avg_path=3.97 | valid_steps=2.97
[2025-11-19 17:05:55,259][INFO] Iter   8700 | loss=0.0226 | td_err=0.0650 | kl=0.5251 | temp=0.300 | eps=0.035 | success=0.938 | hit=0.938 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.412 | avg_path=4.06 | valid_steps=3.06
[2025-11-19 17:06:01,035][INFO] Iter   8750 | loss=0.0222 | td_err=0.0633 | kl=0.5352 | temp=0.300 | eps=0.034 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.488 | avg_path=4.03 | valid_steps=3.03
[2025-11-19 17:06:06,878][INFO] Iter   8800 | loss=0.0237 | td_err=0.0684 | kl=0.5379 | temp=0.300 | eps=0.034 | success=0.938 | hit=0.938 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.401 | avg_path=4.00 | valid_steps=3.00
[2025-11-19 17:06:12,705][INFO] Iter   8850 | loss=0.0236 | td_err=0.0653 | kl=0.5634 | temp=0.300 | eps=0.034 | success=0.938 | hit=0.938 | stage2=0.656 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.391 | avg_path=3.56 | valid_steps=2.56
[2025-11-19 17:06:18,614][INFO] Iter   8900 | loss=0.0232 | td_err=0.0635 | kl=0.5676 | temp=0.300 | eps=0.033 | success=0.938 | hit=0.938 | stage2=0.656 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.355 | avg_path=3.50 | valid_steps=2.50
[2025-11-19 17:06:24,437][INFO] Iter   8950 | loss=0.0189 | td_err=0.0494 | kl=0.5142 | temp=0.300 | eps=0.033 | success=0.938 | hit=0.938 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.468 | avg_path=4.28 | valid_steps=3.28
[2025-11-19 17:06:30,226][INFO] Iter   9000 | loss=0.0209 | td_err=0.0616 | kl=0.5123 | temp=0.300 | eps=0.033 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.558 | avg_path=4.16 | valid_steps=3.16
[2025-11-19 17:06:32,510][INFO] ---- Evaluation at iter 9000 ----
[2025-11-19 17:06:32,511][INFO]   S1->S2: 100.00% (89 / 89)
[2025-11-19 17:06:32,511][INFO]   S2->S3: 95.60% (87 / 91)
[2025-11-19 17:06:32,511][INFO]   S1->S3: 58.52% (79 / 135)
[2025-11-19 17:06:32,511][INFO]   overall: 80.95% (255 / 315)
[2025-11-19 17:06:38,349][INFO] Iter   9050 | loss=0.0183 | td_err=0.0431 | kl=0.5423 | temp=0.300 | eps=0.032 | success=0.906 | hit=0.906 | stage2=0.688 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.322 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 17:06:44,124][INFO] Iter   9100 | loss=0.0214 | td_err=0.0592 | kl=0.5342 | temp=0.300 | eps=0.032 | success=0.906 | hit=0.906 | stage2=0.844 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.398 | avg_path=3.84 | valid_steps=2.84
[2025-11-19 17:06:49,973][INFO] Iter   9150 | loss=0.0197 | td_err=0.0533 | kl=0.5333 | temp=0.300 | eps=0.031 | success=1.000 | hit=1.000 | stage2=0.656 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.496 | avg_path=3.78 | valid_steps=2.78
[2025-11-19 17:06:55,858][INFO] Iter   9200 | loss=0.0205 | td_err=0.0576 | kl=0.5142 | temp=0.300 | eps=0.031 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.473 | avg_path=4.00 | valid_steps=3.00
[2025-11-19 17:07:01,634][INFO] Iter   9250 | loss=0.0187 | td_err=0.0498 | kl=0.5239 | temp=0.300 | eps=0.031 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.490 | avg_path=3.78 | valid_steps=2.78
[2025-11-19 17:07:07,399][INFO] Iter   9300 | loss=0.0194 | td_err=0.0523 | kl=0.5032 | temp=0.300 | eps=0.030 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.538 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 17:07:13,255][INFO] Iter   9350 | loss=0.0215 | td_err=0.0571 | kl=0.4937 | temp=0.300 | eps=0.030 | success=0.938 | hit=0.938 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.458 | avg_path=4.31 | valid_steps=3.31
[2025-11-19 17:07:19,007][INFO] Iter   9400 | loss=0.0207 | td_err=0.0633 | kl=0.4934 | temp=0.300 | eps=0.029 | success=1.000 | hit=1.000 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.550 | avg_path=4.06 | valid_steps=3.06
[2025-11-19 17:07:24,867][INFO] Iter   9450 | loss=0.0199 | td_err=0.0562 | kl=0.5224 | temp=0.300 | eps=0.029 | success=1.000 | hit=1.000 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.518 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 17:07:30,777][INFO] Iter   9500 | loss=0.0182 | td_err=0.0488 | kl=0.5247 | temp=0.300 | eps=0.029 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.523 | avg_path=3.84 | valid_steps=2.84
[2025-11-19 17:07:36,617][INFO] Iter   9550 | loss=0.0169 | td_err=0.0430 | kl=0.5131 | temp=0.300 | eps=0.028 | success=0.938 | hit=0.938 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.491 | avg_path=4.19 | valid_steps=3.19
[2025-11-19 17:07:42,424][INFO] Iter   9600 | loss=0.0200 | td_err=0.0607 | kl=0.5033 | temp=0.300 | eps=0.028 | success=0.938 | hit=0.938 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.406 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 17:07:48,307][INFO] Iter   9650 | loss=0.0182 | td_err=0.0497 | kl=0.5136 | temp=0.300 | eps=0.028 | success=0.906 | hit=0.906 | stage2=0.844 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.386 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 17:07:54,174][INFO] Iter   9700 | loss=0.0163 | td_err=0.0415 | kl=0.5067 | temp=0.300 | eps=0.027 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.505 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 17:08:00,075][INFO] Iter   9750 | loss=0.0190 | td_err=0.0584 | kl=0.4972 | temp=0.300 | eps=0.027 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.487 | avg_path=3.62 | valid_steps=2.62
[2025-11-19 17:08:06,034][INFO] Iter   9800 | loss=0.0209 | td_err=0.0679 | kl=0.4988 | temp=0.300 | eps=0.026 | success=0.938 | hit=0.938 | stage2=0.875 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.431 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 17:08:11,912][INFO] Iter   9850 | loss=0.0194 | td_err=0.0575 | kl=0.5164 | temp=0.300 | eps=0.026 | success=0.969 | hit=0.969 | stage2=0.625 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.434 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 17:08:17,793][INFO] Iter   9900 | loss=0.0234 | td_err=0.0708 | kl=0.5010 | temp=0.300 | eps=0.026 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.481 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 17:08:23,697][INFO] Iter   9950 | loss=0.0155 | td_err=0.0479 | kl=0.4642 | temp=0.300 | eps=0.025 | success=1.000 | hit=1.000 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.540 | avg_path=3.94 | valid_steps=2.94
[2025-11-19 17:08:29,577][INFO] Iter  10000 | loss=0.0191 | td_err=0.0626 | kl=0.4721 | temp=0.300 | eps=0.025 | success=0.969 | hit=0.969 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.534 | avg_path=4.06 | valid_steps=3.06
[2025-11-19 17:08:31,892][INFO] ---- Evaluation at iter 10000 ----
[2025-11-19 17:08:31,892][INFO]   S1->S2: 100.00% (89 / 89)
[2025-11-19 17:08:31,892][INFO]   S2->S3: 95.60% (87 / 91)
[2025-11-19 17:08:31,892][INFO]   S1->S3: 57.04% (77 / 135)
[2025-11-19 17:08:31,892][INFO]   overall: 80.32% (253 / 315)
[2025-11-19 17:08:31,898][INFO] Saved Q-learning checkpoint to out_ql_no_target/ql_20251119_164818/ckpt_ql_10000.pt
[2025-11-19 17:08:38,070][INFO] Iter  10050 | loss=0.0207 | td_err=0.0700 | kl=0.4817 | temp=0.300 | eps=0.025 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.560 | avg_path=3.72 | valid_steps=2.72
[2025-11-19 17:08:43,918][INFO] Iter  10100 | loss=0.0208 | td_err=0.0664 | kl=0.4754 | temp=0.300 | eps=0.024 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.472 | avg_path=4.06 | valid_steps=3.06
[2025-11-19 17:08:49,840][INFO] Iter  10150 | loss=0.0174 | td_err=0.0535 | kl=0.4797 | temp=0.300 | eps=0.024 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.479 | avg_path=4.16 | valid_steps=3.16
[2025-11-19 17:08:55,733][INFO] Iter  10200 | loss=0.0182 | td_err=0.0571 | kl=0.4810 | temp=0.300 | eps=0.023 | success=1.000 | hit=1.000 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.526 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 17:09:01,584][INFO] Iter  10250 | loss=0.0193 | td_err=0.0597 | kl=0.5021 | temp=0.300 | eps=0.023 | success=0.938 | hit=0.938 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.425 | avg_path=3.44 | valid_steps=2.44
[2025-11-19 17:09:07,451][INFO] Iter  10300 | loss=0.0193 | td_err=0.0596 | kl=0.4747 | temp=0.300 | eps=0.023 | success=1.000 | hit=1.000 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.542 | avg_path=4.12 | valid_steps=3.12
[2025-11-19 17:09:13,332][INFO] Iter  10350 | loss=0.0196 | td_err=0.0630 | kl=0.4835 | temp=0.300 | eps=0.022 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.508 | avg_path=3.53 | valid_steps=2.53
[2025-11-19 17:09:19,218][INFO] Iter  10400 | loss=0.0158 | td_err=0.0505 | kl=0.4803 | temp=0.300 | eps=0.022 | success=0.844 | hit=0.844 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.311 | avg_path=3.84 | valid_steps=2.84
[2025-11-19 17:09:25,156][INFO] Iter  10450 | loss=0.0160 | td_err=0.0472 | kl=0.4775 | temp=0.300 | eps=0.022 | success=0.938 | hit=0.938 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.425 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 17:09:31,027][INFO] Iter  10500 | loss=0.0228 | td_err=0.0765 | kl=0.4815 | temp=0.300 | eps=0.021 | success=1.000 | hit=1.000 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.475 | avg_path=3.44 | valid_steps=2.44
[2025-11-19 17:09:36,934][INFO] Iter  10550 | loss=0.0186 | td_err=0.0597 | kl=0.4836 | temp=0.300 | eps=0.021 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.457 | avg_path=3.72 | valid_steps=2.72
[2025-11-19 17:09:42,788][INFO] Iter  10600 | loss=0.0194 | td_err=0.0663 | kl=0.4690 | temp=0.300 | eps=0.021 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.507 | avg_path=3.56 | valid_steps=2.56
[2025-11-19 17:09:48,668][INFO] Iter  10650 | loss=0.0183 | td_err=0.0604 | kl=0.4528 | temp=0.300 | eps=0.020 | success=0.906 | hit=0.906 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.397 | avg_path=4.06 | valid_steps=3.06
[2025-11-19 17:09:54,517][INFO] Iter  10700 | loss=0.0170 | td_err=0.0598 | kl=0.4315 | temp=0.300 | eps=0.020 | success=0.969 | hit=0.969 | stage2=0.906 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.541 | avg_path=4.22 | valid_steps=3.22
[2025-11-19 17:10:00,339][INFO] Iter  10750 | loss=0.0177 | td_err=0.0552 | kl=0.4800 | temp=0.300 | eps=0.019 | success=0.906 | hit=0.906 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.392 | avg_path=3.53 | valid_steps=2.53
[2025-11-19 17:10:06,149][INFO] Iter  10800 | loss=0.0156 | td_err=0.0454 | kl=0.4846 | temp=0.300 | eps=0.019 | success=0.906 | hit=0.906 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.358 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 17:10:12,027][INFO] Iter  10850 | loss=0.0197 | td_err=0.0643 | kl=0.4476 | temp=0.300 | eps=0.019 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.514 | avg_path=4.12 | valid_steps=3.12
[2025-11-19 17:10:17,900][INFO] Iter  10900 | loss=0.0201 | td_err=0.0714 | kl=0.4564 | temp=0.300 | eps=0.018 | success=0.875 | hit=0.875 | stage2=0.875 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.350 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 17:10:23,769][INFO] Iter  10950 | loss=0.0157 | td_err=0.0534 | kl=0.4570 | temp=0.300 | eps=0.018 | success=0.969 | hit=0.969 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.463 | avg_path=4.03 | valid_steps=3.03
[2025-11-19 17:10:29,653][INFO] Iter  11000 | loss=0.0161 | td_err=0.0565 | kl=0.4706 | temp=0.300 | eps=0.018 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.486 | avg_path=4.16 | valid_steps=3.16
[2025-11-19 17:10:32,015][INFO] ---- Evaluation at iter 11000 ----
[2025-11-19 17:10:32,015][INFO]   S1->S2: 100.00% (89 / 89)
[2025-11-19 17:10:32,015][INFO]   S2->S3: 95.60% (87 / 91)
[2025-11-19 17:10:32,015][INFO]   S1->S3: 61.48% (83 / 135)
[2025-11-19 17:10:32,015][INFO]   overall: 82.22% (259 / 315)
[2025-11-19 17:10:37,932][INFO] Iter  11050 | loss=0.0163 | td_err=0.0577 | kl=0.4557 | temp=0.300 | eps=0.017 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.511 | avg_path=4.12 | valid_steps=3.12
[2025-11-19 17:10:43,753][INFO] Iter  11100 | loss=0.0178 | td_err=0.0613 | kl=0.4571 | temp=0.300 | eps=0.017 | success=0.969 | hit=0.969 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.434 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 17:10:49,566][INFO] Iter  11150 | loss=0.0162 | td_err=0.0587 | kl=0.4431 | temp=0.300 | eps=0.016 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.534 | avg_path=4.09 | valid_steps=3.09
[2025-11-19 17:10:55,383][INFO] Iter  11200 | loss=0.0167 | td_err=0.0618 | kl=0.4438 | temp=0.300 | eps=0.016 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.528 | avg_path=3.94 | valid_steps=2.94
[2025-11-19 17:11:01,129][INFO] Iter  11250 | loss=0.0164 | td_err=0.0564 | kl=0.4535 | temp=0.300 | eps=0.016 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.487 | avg_path=3.94 | valid_steps=2.94
[2025-11-19 17:11:06,940][INFO] Iter  11300 | loss=0.0174 | td_err=0.0596 | kl=0.4386 | temp=0.300 | eps=0.015 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.478 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 17:11:12,745][INFO] Iter  11350 | loss=0.0153 | td_err=0.0546 | kl=0.4594 | temp=0.300 | eps=0.015 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.447 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 17:11:18,531][INFO] Iter  11400 | loss=0.0152 | td_err=0.0538 | kl=0.4476 | temp=0.300 | eps=0.014 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.523 | avg_path=4.00 | valid_steps=3.00
[2025-11-19 17:11:24,366][INFO] Iter  11450 | loss=0.0134 | td_err=0.0442 | kl=0.4422 | temp=0.300 | eps=0.014 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.473 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 17:11:30,190][INFO] Iter  11500 | loss=0.0153 | td_err=0.0500 | kl=0.4690 | temp=0.300 | eps=0.014 | success=0.938 | hit=0.938 | stage2=0.719 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.391 | avg_path=3.09 | valid_steps=2.09
[2025-11-19 17:11:36,035][INFO] Iter  11550 | loss=0.0144 | td_err=0.0504 | kl=0.4493 | temp=0.300 | eps=0.013 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.467 | avg_path=3.53 | valid_steps=2.53
[2025-11-19 17:11:41,993][INFO] Iter  11600 | loss=0.0154 | td_err=0.0550 | kl=0.4522 | temp=0.300 | eps=0.013 | success=0.938 | hit=0.938 | stage2=0.812 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.413 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 17:11:47,783][INFO] Iter  11650 | loss=0.0201 | td_err=0.0785 | kl=0.4268 | temp=0.300 | eps=0.013 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.492 | avg_path=4.00 | valid_steps=3.00
[2025-11-19 17:11:53,677][INFO] Iter  11700 | loss=0.0164 | td_err=0.0630 | kl=0.4436 | temp=0.300 | eps=0.012 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.478 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 17:11:59,455][INFO] Iter  11750 | loss=0.0151 | td_err=0.0569 | kl=0.4556 | temp=0.300 | eps=0.012 | success=1.000 | hit=1.000 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.556 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 17:12:05,288][INFO] Iter  11800 | loss=0.0138 | td_err=0.0518 | kl=0.4369 | temp=0.300 | eps=0.011 | success=0.969 | hit=0.969 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.493 | avg_path=3.94 | valid_steps=2.94
[2025-11-19 17:12:11,064][INFO] Iter  11850 | loss=0.0143 | td_err=0.0526 | kl=0.4710 | temp=0.300 | eps=0.011 | success=0.969 | hit=0.969 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.466 | avg_path=3.44 | valid_steps=2.44
[2025-11-19 17:12:16,898][INFO] Iter  11900 | loss=0.0114 | td_err=0.0396 | kl=0.4189 | temp=0.300 | eps=0.011 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.486 | avg_path=3.84 | valid_steps=2.84
[2025-11-19 17:12:22,740][INFO] Iter  11950 | loss=0.0156 | td_err=0.0621 | kl=0.4320 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.493 | avg_path=4.25 | valid_steps=3.25
[2025-11-19 17:12:28,568][INFO] Iter  12000 | loss=0.0126 | td_err=0.0439 | kl=0.4506 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.431 | avg_path=4.06 | valid_steps=3.06
[2025-11-19 17:12:30,849][INFO] ---- Evaluation at iter 12000 ----
[2025-11-19 17:12:30,849][INFO]   S1->S2: 100.00% (89 / 89)
[2025-11-19 17:12:30,849][INFO]   S2->S3: 96.70% (88 / 91)
[2025-11-19 17:12:30,849][INFO]   S1->S3: 60.74% (82 / 135)
[2025-11-19 17:12:30,849][INFO]   overall: 82.22% (259 / 315)
[2025-11-19 17:12:30,854][INFO] Saved Q-learning checkpoint to out_ql_no_target/ql_20251119_164818/ckpt_ql_12000.pt
[2025-11-19 17:12:36,683][INFO] Iter  12050 | loss=0.0146 | td_err=0.0548 | kl=0.4370 | temp=0.300 | eps=0.010 | success=0.875 | hit=0.875 | stage2=0.906 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.348 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 17:12:42,569][INFO] Iter  12100 | loss=0.0201 | td_err=0.0713 | kl=0.4254 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.527 | avg_path=4.41 | valid_steps=3.41
[2025-11-19 17:12:48,453][INFO] Iter  12150 | loss=0.0135 | td_err=0.0496 | kl=0.4375 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.482 | avg_path=3.84 | valid_steps=2.84
[2025-11-19 17:12:54,371][INFO] Iter  12200 | loss=0.0119 | td_err=0.0398 | kl=0.4669 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.501 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 17:13:00,264][INFO] Iter  12250 | loss=0.0148 | td_err=0.0610 | kl=0.4114 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.544 | avg_path=4.06 | valid_steps=3.06
[2025-11-19 17:13:06,235][INFO] Iter  12300 | loss=0.0131 | td_err=0.0534 | kl=0.4083 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.512 | avg_path=4.09 | valid_steps=3.09
[2025-11-19 17:13:12,116][INFO] Iter  12350 | loss=0.0123 | td_err=0.0433 | kl=0.4387 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.719 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.448 | avg_path=3.53 | valid_steps=2.53
[2025-11-19 17:13:18,005][INFO] Iter  12400 | loss=0.0135 | td_err=0.0549 | kl=0.4263 | temp=0.300 | eps=0.010 | success=0.906 | hit=0.906 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.419 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 17:13:23,861][INFO] Iter  12450 | loss=0.0144 | td_err=0.0571 | kl=0.4153 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.416 | avg_path=3.72 | valid_steps=2.72
[2025-11-19 17:13:29,716][INFO] Iter  12500 | loss=0.0119 | td_err=0.0442 | kl=0.4361 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.512 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 17:13:35,593][INFO] Iter  12550 | loss=0.0130 | td_err=0.0539 | kl=0.4036 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.453 | avg_path=4.06 | valid_steps=3.06
[2025-11-19 17:13:41,426][INFO] Iter  12600 | loss=0.0145 | td_err=0.0624 | kl=0.4234 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.480 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 17:13:47,274][INFO] Iter  12650 | loss=0.0183 | td_err=0.0720 | kl=0.4151 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.526 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 17:13:53,190][INFO] Iter  12700 | loss=0.0144 | td_err=0.0584 | kl=0.4177 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.446 | avg_path=3.94 | valid_steps=2.94
[2025-11-19 17:13:59,062][INFO] Iter  12750 | loss=0.0134 | td_err=0.0521 | kl=0.4495 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.781 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.421 | avg_path=3.31 | valid_steps=2.31
[2025-11-19 17:14:04,922][INFO] Iter  12800 | loss=0.0164 | td_err=0.0636 | kl=0.4410 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.521 | avg_path=3.94 | valid_steps=2.94
[2025-11-19 17:14:10,820][INFO] Iter  12850 | loss=0.0122 | td_err=0.0504 | kl=0.4047 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.511 | avg_path=4.00 | valid_steps=3.00
[2025-11-19 17:14:16,691][INFO] Iter  12900 | loss=0.0131 | td_err=0.0527 | kl=0.4509 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.492 | avg_path=3.84 | valid_steps=2.84
[2025-11-19 17:14:22,626][INFO] Iter  12950 | loss=0.0113 | td_err=0.0470 | kl=0.4119 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.511 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 17:14:28,472][INFO] Iter  13000 | loss=0.0125 | td_err=0.0496 | kl=0.4326 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.452 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 17:14:30,755][INFO] ---- Evaluation at iter 13000 ----
[2025-11-19 17:14:30,755][INFO]   S1->S2: 100.00% (89 / 89)
[2025-11-19 17:14:30,755][INFO]   S2->S3: 96.70% (88 / 91)
[2025-11-19 17:14:30,755][INFO]   S1->S3: 68.89% (93 / 135)
[2025-11-19 17:14:30,755][INFO]   overall: 85.71% (270 / 315)
[2025-11-19 17:14:36,682][INFO] Iter  13050 | loss=0.0149 | td_err=0.0589 | kl=0.4029 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.468 | avg_path=4.25 | valid_steps=3.25
[2025-11-19 17:14:42,509][INFO] Iter  13100 | loss=0.0135 | td_err=0.0532 | kl=0.4306 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.411 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 17:14:48,322][INFO] Iter  13150 | loss=0.0153 | td_err=0.0622 | kl=0.4141 | temp=0.300 | eps=0.010 | success=0.906 | hit=0.906 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.406 | avg_path=4.09 | valid_steps=3.09
[2025-11-19 17:14:54,171][INFO] Iter  13200 | loss=0.0124 | td_err=0.0506 | kl=0.4352 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.477 | avg_path=3.97 | valid_steps=2.97
[2025-11-19 17:15:00,024][INFO] Iter  13250 | loss=0.0141 | td_err=0.0599 | kl=0.3979 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.505 | avg_path=4.12 | valid_steps=3.12
[2025-11-19 17:15:05,859][INFO] Iter  13300 | loss=0.0160 | td_err=0.0675 | kl=0.4109 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.474 | avg_path=3.94 | valid_steps=2.94
[2025-11-19 17:15:11,778][INFO] Iter  13350 | loss=0.0146 | td_err=0.0589 | kl=0.4278 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.456 | avg_path=3.78 | valid_steps=2.78
[2025-11-19 17:15:17,627][INFO] Iter  13400 | loss=0.0141 | td_err=0.0588 | kl=0.4218 | temp=0.300 | eps=0.010 | success=0.875 | hit=0.875 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.363 | avg_path=4.22 | valid_steps=3.22
[2025-11-19 17:15:23,503][INFO] Iter  13450 | loss=0.0140 | td_err=0.0581 | kl=0.3993 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.406 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 17:15:29,356][INFO] Iter  13500 | loss=0.0133 | td_err=0.0561 | kl=0.4144 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.491 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 17:15:35,276][INFO] Iter  13550 | loss=0.0134 | td_err=0.0581 | kl=0.4223 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.446 | avg_path=4.09 | valid_steps=3.09
[2025-11-19 17:15:41,182][INFO] Iter  13600 | loss=0.0103 | td_err=0.0410 | kl=0.4157 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.434 | avg_path=3.78 | valid_steps=2.78
[2025-11-19 17:15:47,005][INFO] Iter  13650 | loss=0.0168 | td_err=0.0693 | kl=0.4153 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.483 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 17:15:52,908][INFO] Iter  13700 | loss=0.0107 | td_err=0.0494 | kl=0.4046 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.512 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 17:15:58,792][INFO] Iter  13750 | loss=0.0102 | td_err=0.0415 | kl=0.3956 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.462 | avg_path=3.62 | valid_steps=2.62
[2025-11-19 17:16:04,681][INFO] Iter  13800 | loss=0.0106 | td_err=0.0484 | kl=0.3853 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.471 | avg_path=3.78 | valid_steps=2.78
[2025-11-19 17:16:10,606][INFO] Iter  13850 | loss=0.0102 | td_err=0.0465 | kl=0.3826 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.544 | avg_path=4.34 | valid_steps=3.34
[2025-11-19 17:16:16,544][INFO] Iter  13900 | loss=0.0173 | td_err=0.0772 | kl=0.4419 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.454 | avg_path=3.72 | valid_steps=2.72
[2025-11-19 17:16:22,416][INFO] Iter  13950 | loss=0.0118 | td_err=0.0504 | kl=0.4103 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.452 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 17:16:28,339][INFO] Iter  14000 | loss=0.0129 | td_err=0.0572 | kl=0.4225 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.468 | avg_path=3.78 | valid_steps=2.78
[2025-11-19 17:16:30,625][INFO] ---- Evaluation at iter 14000 ----
[2025-11-19 17:16:30,626][INFO]   S1->S2: 100.00% (89 / 89)
[2025-11-19 17:16:30,626][INFO]   S2->S3: 96.70% (88 / 91)
[2025-11-19 17:16:30,626][INFO]   S1->S3: 66.67% (90 / 135)
[2025-11-19 17:16:30,626][INFO]   overall: 84.76% (267 / 315)
[2025-11-19 17:16:30,630][INFO] Saved Q-learning checkpoint to out_ql_no_target/ql_20251119_164818/ckpt_ql_14000.pt
[2025-11-19 17:16:36,508][INFO] Iter  14050 | loss=0.0124 | td_err=0.0567 | kl=0.4042 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.504 | avg_path=3.72 | valid_steps=2.72
[2025-11-19 17:16:42,395][INFO] Iter  14100 | loss=0.0160 | td_err=0.0675 | kl=0.4182 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.452 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 17:16:48,260][INFO] Iter  14150 | loss=0.0111 | td_err=0.0505 | kl=0.3945 | temp=0.300 | eps=0.010 | success=0.875 | hit=0.875 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.373 | avg_path=4.03 | valid_steps=3.03
[2025-11-19 17:16:54,195][INFO] Iter  14200 | loss=0.0103 | td_err=0.0479 | kl=0.4070 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.482 | avg_path=4.03 | valid_steps=3.03
[2025-11-19 17:17:00,089][INFO] Iter  14250 | loss=0.0125 | td_err=0.0583 | kl=0.3872 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.688 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.439 | avg_path=4.16 | valid_steps=3.16
[2025-11-19 17:17:06,049][INFO] Iter  14300 | loss=0.0136 | td_err=0.0659 | kl=0.4269 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.474 | avg_path=3.62 | valid_steps=2.62
[2025-11-19 17:17:11,915][INFO] Iter  14350 | loss=0.0181 | td_err=0.0774 | kl=0.4092 | temp=0.300 | eps=0.010 | success=0.844 | hit=0.844 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.311 | avg_path=4.00 | valid_steps=3.00
[2025-11-19 17:17:17,802][INFO] Iter  14400 | loss=0.0087 | td_err=0.0388 | kl=0.3844 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.750 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.473 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 17:17:23,751][INFO] Iter  14450 | loss=0.0111 | td_err=0.0506 | kl=0.4159 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.812 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.416 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 17:17:29,708][INFO] Iter  14500 | loss=0.0099 | td_err=0.0487 | kl=0.3750 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.530 | avg_path=4.12 | valid_steps=3.12
[2025-11-19 17:17:35,605][INFO] Iter  14550 | loss=0.0128 | td_err=0.0578 | kl=0.3937 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.969 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.519 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 17:17:41,491][INFO] Iter  14600 | loss=0.0101 | td_err=0.0461 | kl=0.4037 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.481 | avg_path=3.94 | valid_steps=2.94
[2025-11-19 17:17:47,373][INFO] Iter  14650 | loss=0.0119 | td_err=0.0570 | kl=0.4122 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.458 | avg_path=4.16 | valid_steps=3.16
[2025-11-19 17:17:53,222][INFO] Iter  14700 | loss=0.0118 | td_err=0.0539 | kl=0.4100 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.425 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 17:17:59,116][INFO] Iter  14750 | loss=0.0093 | td_err=0.0446 | kl=0.3921 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.501 | avg_path=4.00 | valid_steps=3.00
[2025-11-19 17:18:05,044][INFO] Iter  14800 | loss=0.0093 | td_err=0.0432 | kl=0.4071 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.487 | avg_path=3.94 | valid_steps=2.94
[2025-11-19 17:18:11,011][INFO] Iter  14850 | loss=0.0084 | td_err=0.0426 | kl=0.3994 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.416 | avg_path=4.19 | valid_steps=3.19
[2025-11-19 17:18:16,836][INFO] Iter  14900 | loss=0.0088 | td_err=0.0415 | kl=0.4262 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.403 | avg_path=3.47 | valid_steps=2.47
[2025-11-19 17:18:22,743][INFO] Iter  14950 | loss=0.0083 | td_err=0.0432 | kl=0.3876 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.511 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 17:18:28,670][INFO] Iter  15000 | loss=0.0085 | td_err=0.0455 | kl=0.3869 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.497 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 17:18:30,971][INFO] ---- Evaluation at iter 15000 ----
[2025-11-19 17:18:30,971][INFO]   S1->S2: 100.00% (89 / 89)
[2025-11-19 17:18:30,972][INFO]   S2->S3: 96.70% (88 / 91)
[2025-11-19 17:18:30,972][INFO]   S1->S3: 71.11% (96 / 135)
[2025-11-19 17:18:30,972][INFO]   overall: 86.67% (273 / 315)
[2025-11-19 17:18:36,895][INFO] Iter  15050 | loss=0.0107 | td_err=0.0559 | kl=0.3967 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.812 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.421 | avg_path=3.94 | valid_steps=2.94
[2025-11-19 17:18:42,823][INFO] Iter  15100 | loss=0.0104 | td_err=0.0521 | kl=0.4158 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.472 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 17:18:48,702][INFO] Iter  15150 | loss=0.0108 | td_err=0.0534 | kl=0.4012 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.468 | avg_path=3.78 | valid_steps=2.78
[2025-11-19 17:18:54,601][INFO] Iter  15200 | loss=0.0098 | td_err=0.0499 | kl=0.3926 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.521 | avg_path=3.97 | valid_steps=2.97
[2025-11-19 17:19:00,445][INFO] Iter  15250 | loss=0.0095 | td_err=0.0491 | kl=0.3955 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.454 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 17:19:06,299][INFO] Iter  15300 | loss=0.0101 | td_err=0.0539 | kl=0.3839 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.906 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.482 | avg_path=4.00 | valid_steps=3.00
[2025-11-19 17:19:12,169][INFO] Iter  15350 | loss=0.0088 | td_err=0.0456 | kl=0.3934 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.429 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 17:19:18,076][INFO] Iter  15400 | loss=0.0118 | td_err=0.0595 | kl=0.3797 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.403 | avg_path=3.62 | valid_steps=2.62
[2025-11-19 17:19:23,978][INFO] Iter  15450 | loss=0.0103 | td_err=0.0513 | kl=0.3853 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.501 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 17:19:29,810][INFO] Iter  15500 | loss=0.0079 | td_err=0.0414 | kl=0.3889 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.476 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 17:19:35,753][INFO] Iter  15550 | loss=0.0121 | td_err=0.0650 | kl=0.3926 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.476 | avg_path=4.19 | valid_steps=3.19
[2025-11-19 17:19:41,686][INFO] Iter  15600 | loss=0.0100 | td_err=0.0506 | kl=0.4118 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.421 | avg_path=3.62 | valid_steps=2.62
[2025-11-19 17:19:47,507][INFO] Iter  15650 | loss=0.0084 | td_err=0.0449 | kl=0.3995 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.531 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 17:19:53,352][INFO] Iter  15700 | loss=0.0082 | td_err=0.0468 | kl=0.3660 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.549 | avg_path=3.97 | valid_steps=2.97
[2025-11-19 17:19:59,241][INFO] Iter  15750 | loss=0.0086 | td_err=0.0473 | kl=0.3893 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.494 | avg_path=3.41 | valid_steps=2.41
[2025-11-19 17:20:05,095][INFO] Iter  15800 | loss=0.0088 | td_err=0.0505 | kl=0.3723 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.576 | avg_path=4.31 | valid_steps=3.31
[2025-11-19 17:20:10,979][INFO] Iter  15850 | loss=0.0091 | td_err=0.0476 | kl=0.3775 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.456 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 17:20:16,865][INFO] Iter  15900 | loss=0.0083 | td_err=0.0449 | kl=0.3753 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.501 | avg_path=3.84 | valid_steps=2.84
[2025-11-19 17:20:22,760][INFO] Iter  15950 | loss=0.0094 | td_err=0.0512 | kl=0.4009 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.524 | avg_path=3.34 | valid_steps=2.34
[2025-11-19 17:20:28,634][INFO] Iter  16000 | loss=0.0073 | td_err=0.0379 | kl=0.3966 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.492 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 17:20:30,934][INFO] ---- Evaluation at iter 16000 ----
[2025-11-19 17:20:30,934][INFO]   S1->S2: 100.00% (89 / 89)
[2025-11-19 17:20:30,934][INFO]   S2->S3: 96.70% (88 / 91)
[2025-11-19 17:20:30,934][INFO]   S1->S3: 71.85% (97 / 135)
[2025-11-19 17:20:30,934][INFO]   overall: 86.98% (274 / 315)
[2025-11-19 17:20:30,939][INFO] Saved Q-learning checkpoint to out_ql_no_target/ql_20251119_164818/ckpt_ql_16000.pt
[2025-11-19 17:20:36,942][INFO] Iter  16050 | loss=0.0093 | td_err=0.0524 | kl=0.3922 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.530 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 17:20:42,803][INFO] Iter  16100 | loss=0.0120 | td_err=0.0615 | kl=0.3856 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.513 | avg_path=3.72 | valid_steps=2.72
[2025-11-19 17:20:48,646][INFO] Iter  16150 | loss=0.0083 | td_err=0.0482 | kl=0.3767 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.457 | avg_path=3.72 | valid_steps=2.72
[2025-11-19 17:20:54,533][INFO] Iter  16200 | loss=0.0082 | td_err=0.0491 | kl=0.3992 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.500 | avg_path=3.44 | valid_steps=2.44
[2025-11-19 17:21:00,452][INFO] Iter  16250 | loss=0.0057 | td_err=0.0316 | kl=0.3926 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.458 | avg_path=3.50 | valid_steps=2.50
[2025-11-19 17:21:06,372][INFO] Iter  16300 | loss=0.0075 | td_err=0.0457 | kl=0.3860 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.474 | avg_path=3.78 | valid_steps=2.78
[2025-11-19 17:21:12,313][INFO] Iter  16350 | loss=0.0082 | td_err=0.0510 | kl=0.3589 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.500 | avg_path=4.38 | valid_steps=3.38
[2025-11-19 17:21:18,219][INFO] Iter  16400 | loss=0.0119 | td_err=0.0632 | kl=0.3815 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.522 | avg_path=4.03 | valid_steps=3.03
[2025-11-19 17:21:24,079][INFO] Iter  16450 | loss=0.0075 | td_err=0.0455 | kl=0.3976 | temp=0.300 | eps=0.010 | success=0.906 | hit=0.906 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.378 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 17:21:29,980][INFO] Iter  16500 | loss=0.0064 | td_err=0.0394 | kl=0.4028 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.479 | avg_path=3.38 | valid_steps=2.38
[2025-11-19 17:21:35,810][INFO] Iter  16550 | loss=0.0089 | td_err=0.0536 | kl=0.3949 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.441 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 17:21:41,745][INFO] Iter  16600 | loss=0.0094 | td_err=0.0524 | kl=0.3839 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.478 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 17:21:47,676][INFO] Iter  16650 | loss=0.0077 | td_err=0.0505 | kl=0.3732 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.546 | avg_path=3.94 | valid_steps=2.94
[2025-11-19 17:21:53,554][INFO] Iter  16700 | loss=0.0105 | td_err=0.0631 | kl=0.3913 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.456 | avg_path=3.78 | valid_steps=2.78
[2025-11-19 17:21:59,448][INFO] Iter  16750 | loss=0.0086 | td_err=0.0564 | kl=0.3897 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.526 | avg_path=4.00 | valid_steps=3.00
[2025-11-19 17:22:05,323][INFO] Iter  16800 | loss=0.0081 | td_err=0.0524 | kl=0.3717 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.518 | avg_path=4.25 | valid_steps=3.25
[2025-11-19 17:22:11,142][INFO] Iter  16850 | loss=0.0070 | td_err=0.0439 | kl=0.4291 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.467 | avg_path=3.50 | valid_steps=2.50
[2025-11-19 17:22:17,027][INFO] Iter  16900 | loss=0.0092 | td_err=0.0570 | kl=0.3814 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.474 | avg_path=3.94 | valid_steps=2.94
[2025-11-19 17:22:22,869][INFO] Iter  16950 | loss=0.0086 | td_err=0.0531 | kl=0.3858 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.497 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 17:22:28,659][INFO] Iter  17000 | loss=0.0070 | td_err=0.0470 | kl=0.3961 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.812 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.421 | avg_path=3.47 | valid_steps=2.47
[2025-11-19 17:22:30,954][INFO] ---- Evaluation at iter 17000 ----
[2025-11-19 17:22:30,954][INFO]   S1->S2: 100.00% (89 / 89)
[2025-11-19 17:22:30,954][INFO]   S2->S3: 96.70% (88 / 91)
[2025-11-19 17:22:30,954][INFO]   S1->S3: 72.59% (98 / 135)
[2025-11-19 17:22:30,954][INFO]   overall: 87.30% (275 / 315)
[2025-11-19 17:22:36,852][INFO] Iter  17050 | loss=0.0069 | td_err=0.0463 | kl=0.3760 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.518 | avg_path=4.12 | valid_steps=3.12
[2025-11-19 17:22:42,698][INFO] Iter  17100 | loss=0.0080 | td_err=0.0454 | kl=0.3769 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.513 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 17:22:48,523][INFO] Iter  17150 | loss=0.0060 | td_err=0.0424 | kl=0.3819 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.559 | avg_path=4.09 | valid_steps=3.09
[2025-11-19 17:22:54,415][INFO] Iter  17200 | loss=0.0073 | td_err=0.0425 | kl=0.3925 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.750 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.441 | avg_path=3.41 | valid_steps=2.41
[2025-11-19 17:23:00,242][INFO] Iter  17250 | loss=0.0072 | td_err=0.0482 | kl=0.4057 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.463 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 17:23:06,161][INFO] Iter  17300 | loss=0.0078 | td_err=0.0523 | kl=0.3745 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.485 | avg_path=4.19 | valid_steps=3.19
[2025-11-19 17:23:11,961][INFO] Iter  17350 | loss=0.0085 | td_err=0.0492 | kl=0.3932 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.491 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 17:23:17,817][INFO] Iter  17400 | loss=0.0080 | td_err=0.0473 | kl=0.3894 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.484 | avg_path=3.78 | valid_steps=2.78
[2025-11-19 17:23:23,565][INFO] Iter  17450 | loss=0.0091 | td_err=0.0559 | kl=0.3967 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.484 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 17:23:29,383][INFO] Iter  17500 | loss=0.0065 | td_err=0.0461 | kl=0.3743 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.551 | avg_path=4.47 | valid_steps=3.47
[2025-11-19 17:23:35,221][INFO] Iter  17550 | loss=0.0067 | td_err=0.0444 | kl=0.4165 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.688 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.387 | avg_path=3.28 | valid_steps=2.28
[2025-11-19 17:23:41,074][INFO] Iter  17600 | loss=0.0065 | td_err=0.0477 | kl=0.3892 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.488 | avg_path=4.03 | valid_steps=3.03
[2025-11-19 17:23:47,012][INFO] Iter  17650 | loss=0.0091 | td_err=0.0591 | kl=0.3856 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.484 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 17:23:52,864][INFO] Iter  17700 | loss=0.0087 | td_err=0.0578 | kl=0.3907 | temp=0.300 | eps=0.010 | success=0.875 | hit=0.875 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.379 | avg_path=4.34 | valid_steps=3.34
[2025-11-19 17:23:58,733][INFO] Iter  17750 | loss=0.0058 | td_err=0.0436 | kl=0.3916 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.555 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 17:24:04,608][INFO] Iter  17800 | loss=0.0061 | td_err=0.0442 | kl=0.3886 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.478 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 17:24:10,511][INFO] Iter  17850 | loss=0.0071 | td_err=0.0479 | kl=0.4053 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.531 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 17:24:16,283][INFO] Iter  17900 | loss=0.0061 | td_err=0.0465 | kl=0.4021 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.449 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 17:24:22,182][INFO] Iter  17950 | loss=0.0062 | td_err=0.0466 | kl=0.3825 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.483 | avg_path=4.12 | valid_steps=3.12
[2025-11-19 17:24:28,108][INFO] Iter  18000 | loss=0.0056 | td_err=0.0451 | kl=0.3567 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.550 | avg_path=4.06 | valid_steps=3.06
[2025-11-19 17:24:30,396][INFO] ---- Evaluation at iter 18000 ----
[2025-11-19 17:24:30,396][INFO]   S1->S2: 100.00% (89 / 89)
[2025-11-19 17:24:30,396][INFO]   S2->S3: 96.70% (88 / 91)
[2025-11-19 17:24:30,396][INFO]   S1->S3: 78.52% (106 / 135)
[2025-11-19 17:24:30,396][INFO]   overall: 89.84% (283 / 315)
[2025-11-19 17:24:30,401][INFO] Saved Q-learning checkpoint to out_ql_no_target/ql_20251119_164818/ckpt_ql_18000.pt
[2025-11-19 17:24:36,303][INFO] Iter  18050 | loss=0.0079 | td_err=0.0560 | kl=0.4045 | temp=0.300 | eps=0.010 | success=0.875 | hit=0.875 | stage2=0.844 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.344 | avg_path=3.91 | valid_steps=2.91
[2025-11-19 17:24:42,117][INFO] Iter  18100 | loss=0.0065 | td_err=0.0481 | kl=0.3941 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.508 | avg_path=3.84 | valid_steps=2.84
[2025-11-19 17:24:47,983][INFO] Iter  18150 | loss=0.0060 | td_err=0.0468 | kl=0.3922 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.580 | avg_path=4.12 | valid_steps=3.12
[2025-11-19 17:24:53,823][INFO] Iter  18200 | loss=0.0057 | td_err=0.0454 | kl=0.4163 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.425 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 17:24:59,756][INFO] Iter  18250 | loss=0.0085 | td_err=0.0610 | kl=0.3864 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.481 | avg_path=4.09 | valid_steps=3.09
[2025-11-19 17:25:05,649][INFO] Iter  18300 | loss=0.0050 | td_err=0.0404 | kl=0.4101 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.906 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.419 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 17:25:11,605][INFO] Iter  18350 | loss=0.0068 | td_err=0.0497 | kl=0.3858 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.451 | avg_path=3.84 | valid_steps=2.84
[2025-11-19 17:25:17,501][INFO] Iter  18400 | loss=0.0056 | td_err=0.0441 | kl=0.3895 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.521 | avg_path=3.78 | valid_steps=2.78
[2025-11-19 17:25:23,361][INFO] Iter  18450 | loss=0.0049 | td_err=0.0415 | kl=0.4224 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.656 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.402 | avg_path=3.47 | valid_steps=2.47
[2025-11-19 17:25:29,214][INFO] Iter  18500 | loss=0.0074 | td_err=0.0522 | kl=0.3959 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.541 | avg_path=4.03 | valid_steps=3.03
[2025-11-19 17:25:35,058][INFO] Iter  18550 | loss=0.0059 | td_err=0.0467 | kl=0.4056 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.540 | avg_path=3.94 | valid_steps=2.94
[2025-11-19 17:25:40,869][INFO] Iter  18600 | loss=0.0069 | td_err=0.0528 | kl=0.4275 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.481 | avg_path=3.12 | valid_steps=2.12
[2025-11-19 17:25:46,686][INFO] Iter  18650 | loss=0.0110 | td_err=0.0680 | kl=0.4064 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.425 | avg_path=4.06 | valid_steps=3.06
[2025-11-19 17:25:52,472][INFO] Iter  18700 | loss=0.0047 | td_err=0.0442 | kl=0.3851 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.552 | avg_path=3.94 | valid_steps=2.94
[2025-11-19 17:25:58,346][INFO] Iter  18750 | loss=0.0070 | td_err=0.0545 | kl=0.3775 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.529 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 17:26:04,215][INFO] Iter  18800 | loss=0.0041 | td_err=0.0362 | kl=0.4080 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.511 | avg_path=3.34 | valid_steps=2.34
[2025-11-19 17:26:10,119][INFO] Iter  18850 | loss=0.0043 | td_err=0.0408 | kl=0.3849 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.526 | avg_path=4.00 | valid_steps=3.00
[2025-11-19 17:26:16,015][INFO] Iter  18900 | loss=0.0048 | td_err=0.0434 | kl=0.3872 | temp=0.300 | eps=0.010 | success=0.906 | hit=0.906 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.369 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 17:26:21,864][INFO] Iter  18950 | loss=0.0040 | td_err=0.0401 | kl=0.3895 | temp=0.300 | eps=0.010 | success=0.969 | hit=0.969 | stage2=0.750 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.488 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 17:26:27,724][INFO] Iter  19000 | loss=0.0054 | td_err=0.0480 | kl=0.3825 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.526 | avg_path=3.84 | valid_steps=2.84
[2025-11-19 17:26:30,044][INFO] ---- Evaluation at iter 19000 ----
[2025-11-19 17:26:30,044][INFO]   S1->S2: 100.00% (89 / 89)
[2025-11-19 17:26:30,044][INFO]   S2->S3: 96.70% (88 / 91)
[2025-11-19 17:26:30,044][INFO]   S1->S3: 83.70% (113 / 135)
[2025-11-19 17:26:30,044][INFO]   overall: 92.06% (290 / 315)
[2025-11-19 17:26:35,996][INFO] Iter  19050 | loss=0.0052 | td_err=0.0460 | kl=0.3944 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.495 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 17:26:41,912][INFO] Iter  19100 | loss=0.0029 | td_err=0.0344 | kl=0.4260 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.719 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.525 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 17:26:47,740][INFO] Iter  19150 | loss=0.0065 | td_err=0.0510 | kl=0.3958 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.458 | avg_path=3.84 | valid_steps=2.84
[2025-11-19 17:26:53,643][INFO] Iter  19200 | loss=0.0053 | td_err=0.0470 | kl=0.3968 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.906 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.434 | avg_path=3.78 | valid_steps=2.78
[2025-11-19 17:26:59,503][INFO] Iter  19250 | loss=0.0053 | td_err=0.0439 | kl=0.4106 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.688 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.525 | avg_path=3.59 | valid_steps=2.59
[2025-11-19 17:27:05,319][INFO] Iter  19300 | loss=0.0064 | td_err=0.0533 | kl=0.4032 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.560 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 17:27:11,094][INFO] Iter  19350 | loss=0.0082 | td_err=0.0625 | kl=0.4238 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.511 | avg_path=3.66 | valid_steps=2.66
[2025-11-19 17:27:16,961][INFO] Iter  19400 | loss=0.0060 | td_err=0.0543 | kl=0.3870 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.461 | avg_path=4.12 | valid_steps=3.12
[2025-11-19 17:27:22,834][INFO] Iter  19450 | loss=0.0080 | td_err=0.0590 | kl=0.4073 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.485 | avg_path=4.19 | valid_steps=3.19
[2025-11-19 17:27:28,760][INFO] Iter  19500 | loss=0.0054 | td_err=0.0490 | kl=0.4203 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.491 | avg_path=3.88 | valid_steps=2.88
[2025-11-19 17:27:34,652][INFO] Iter  19550 | loss=0.0058 | td_err=0.0518 | kl=0.4297 | temp=0.300 | eps=0.010 | success=0.906 | hit=0.906 | stage2=0.812 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.363 | avg_path=4.03 | valid_steps=3.03
[2025-11-19 17:27:40,488][INFO] Iter  19600 | loss=0.0063 | td_err=0.0516 | kl=0.4101 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.497 | avg_path=3.56 | valid_steps=2.56
[2025-11-19 17:27:46,324][INFO] Iter  19650 | loss=0.0022 | td_err=0.0332 | kl=0.4070 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.812 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.438 | avg_path=3.75 | valid_steps=2.75
[2025-11-19 17:27:52,180][INFO] Iter  19700 | loss=0.0068 | td_err=0.0526 | kl=0.3988 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.906 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.471 | avg_path=4.25 | valid_steps=3.25
[2025-11-19 17:27:58,029][INFO] Iter  19750 | loss=0.0036 | td_err=0.0431 | kl=0.4090 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.844 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.458 | avg_path=3.84 | valid_steps=2.84
[2025-11-19 17:28:03,997][INFO] Iter  19800 | loss=0.0054 | td_err=0.0489 | kl=0.4169 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.433 | avg_path=3.84 | valid_steps=2.84
[2025-11-19 17:28:09,891][INFO] Iter  19850 | loss=0.0045 | td_err=0.0471 | kl=0.4164 | temp=0.300 | eps=0.010 | success=1.000 | hit=1.000 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.526 | avg_path=3.69 | valid_steps=2.69
[2025-11-19 17:28:15,781][INFO] Iter  19900 | loss=0.0045 | td_err=0.0463 | kl=0.4101 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.875 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.433 | avg_path=4.16 | valid_steps=3.16
[2025-11-19 17:28:21,788][INFO] Iter  19950 | loss=0.0055 | td_err=0.0532 | kl=0.3983 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.875 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.480 | avg_path=3.81 | valid_steps=2.81
[2025-11-19 17:28:27,868][INFO] Iter  20000 | loss=0.0032 | td_err=0.0376 | kl=0.0000 | temp=0.300 | eps=0.010 | success=0.938 | hit=0.938 | stage2=0.812 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.426 | avg_path=3.53 | valid_steps=2.53
[2025-11-19 17:28:30,225][INFO] ---- Evaluation at iter 20000 ----
[2025-11-19 17:28:30,226][INFO]   S1->S2: 100.00% (89 / 89)
[2025-11-19 17:28:30,226][INFO]   S2->S3: 96.70% (88 / 91)
[2025-11-19 17:28:30,226][INFO]   S1->S3: 88.15% (119 / 135)
[2025-11-19 17:28:30,226][INFO]   overall: 93.97% (296 / 315)
[2025-11-19 17:28:30,231][INFO] Saved Q-learning checkpoint to out_ql_no_target/ql_20251119_164818/ckpt_ql_20000.pt
[2025-11-19 17:28:30,231][INFO] Q-learning training finished.
