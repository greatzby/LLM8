[2025-11-18 20:30:30,524][INFO] Q-learning training started.
[2025-11-18 20:30:30,524][INFO] Output directory: out_qlearning/ql_20251118_203030
[2025-11-18 20:30:30,524][INFO] Reward type: outcome
[2025-11-18 20:30:30,528][INFO] Resolved model configuration: {"vocab_size": 92, "block_size": 32, "n_layer": 1, "n_head": 1, "n_embd": 92, "dropout": 0.0, "bias": false}
[2025-11-18 20:30:31,342][INFO] KL 正则禁用。
[2025-11-18 20:30:31,356][INFO] Loaded 1544 unique (source, target) pairs for Q-learning training.
[2025-11-18 20:30:37,567][INFO] Iter     50 | loss=26.9929 | td_err=3.8072 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.938 | hit=0.938 | stage2=0.625 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.938 | avg_path=4.28 | valid_steps=3.28
[2025-11-18 20:30:43,705][INFO] Iter    100 | loss=13.5565 | td_err=2.7400 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.781 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=4.62 | valid_steps=3.25
[2025-11-18 20:30:50,189][INFO] Iter    150 | loss=10.0896 | td_err=2.4523 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.281 | hit=0.281 | stage2=0.844 | first_src=0.031 | first_valid=0.969 | invalid_edge=0.625 | invalid_tok=0.000 | avg_ep_reward=0.281 | avg_path=5.12 | valid_steps=3.50
[2025-11-18 20:30:57,595][INFO] Iter    200 | loss=6.5894 | td_err=1.8759 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.250 | hit=0.250 | stage2=0.812 | first_src=0.031 | first_valid=0.969 | invalid_edge=0.750 | invalid_tok=0.000 | avg_ep_reward=0.250 | avg_path=6.12 | valid_steps=4.38
[2025-11-18 20:31:05,105][INFO] Iter    250 | loss=5.3951 | td_err=1.6961 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.156 | hit=0.156 | stage2=0.781 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.844 | invalid_tok=0.000 | avg_ep_reward=0.156 | avg_path=5.47 | valid_steps=3.62
[2025-11-18 20:31:12,732][INFO] Iter    300 | loss=3.6271 | td_err=1.3930 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.125 | hit=0.125 | stage2=0.781 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.875 | invalid_tok=0.000 | avg_ep_reward=0.125 | avg_path=6.56 | valid_steps=4.69
[2025-11-18 20:31:20,264][INFO] Iter    350 | loss=3.0369 | td_err=1.2770 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.062 | hit=0.062 | stage2=0.750 | first_src=0.000 | first_valid=0.969 | invalid_edge=0.812 | invalid_tok=0.000 | avg_ep_reward=0.062 | avg_path=6.84 | valid_steps=5.03
[2025-11-18 20:31:27,878][INFO] Iter    400 | loss=1.5638 | td_err=0.9081 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.094 | hit=0.094 | stage2=0.938 | first_src=0.000 | first_valid=1.000 | invalid_edge=0.875 | invalid_tok=0.000 | avg_ep_reward=0.094 | avg_path=6.31 | valid_steps=4.44
[2025-11-18 20:31:35,630][INFO] Iter    450 | loss=1.0865 | td_err=0.7634 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.062 | hit=0.062 | stage2=0.906 | first_src=0.031 | first_valid=0.969 | invalid_edge=0.844 | invalid_tok=0.000 | avg_ep_reward=0.062 | avg_path=6.66 | valid_steps=4.81
[2025-11-18 20:31:43,240][INFO] Iter    500 | loss=0.8547 | td_err=0.6547 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.000 | hit=0.000 | stage2=0.812 | first_src=0.031 | first_valid=0.938 | invalid_edge=0.969 | invalid_tok=0.000 | avg_ep_reward=0.000 | avg_path=6.09 | valid_steps=4.12
[2025-11-18 20:31:50,756][INFO] Iter    550 | loss=0.4606 | td_err=0.4985 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.031 | hit=0.031 | stage2=0.844 | first_src=0.031 | first_valid=0.906 | invalid_edge=0.906 | invalid_tok=0.000 | avg_ep_reward=0.031 | avg_path=6.59 | valid_steps=4.69
[2025-11-18 20:31:57,917][INFO] Iter    600 | loss=0.3370 | td_err=0.4032 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.000 | hit=0.000 | stage2=0.812 | first_src=0.031 | first_valid=0.875 | invalid_edge=1.000 | invalid_tok=0.000 | avg_ep_reward=0.000 | avg_path=6.09 | valid_steps=4.09
[2025-11-18 20:32:04,675][INFO] Iter    650 | loss=0.1144 | td_err=0.2627 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.000 | hit=0.000 | stage2=0.875 | first_src=0.062 | first_valid=0.906 | invalid_edge=0.969 | invalid_tok=0.000 | avg_ep_reward=0.000 | avg_path=5.12 | valid_steps=3.16
[2025-11-18 20:32:11,054][INFO] Iter    700 | loss=0.0566 | td_err=0.1720 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.094 | hit=0.094 | stage2=0.656 | first_src=0.031 | first_valid=0.812 | invalid_edge=0.594 | invalid_tok=0.000 | avg_ep_reward=0.094 | avg_path=4.28 | valid_steps=2.69
[2025-11-18 20:32:16,986][INFO] Iter    750 | loss=0.0486 | td_err=0.1406 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.094 | hit=0.094 | stage2=0.906 | first_src=0.000 | first_valid=0.938 | invalid_edge=0.500 | invalid_tok=0.031 | avg_ep_reward=0.094 | avg_path=5.47 | valid_steps=3.97
[2025-11-18 20:32:22,652][INFO] Iter    800 | loss=0.0409 | td_err=0.1277 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.219 | hit=0.219 | stage2=0.531 | first_src=0.000 | first_valid=0.812 | invalid_edge=0.219 | invalid_tok=0.000 | avg_ep_reward=0.219 | avg_path=3.75 | valid_steps=2.53
[2025-11-18 20:32:28,156][INFO] Iter    850 | loss=0.0232 | td_err=0.1093 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.156 | hit=0.156 | stage2=0.625 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.312 | invalid_tok=0.000 | avg_ep_reward=0.156 | avg_path=3.88 | valid_steps=2.56
[2025-11-18 20:32:33,900][INFO] Iter    900 | loss=0.0362 | td_err=0.1385 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.312 | hit=0.312 | stage2=0.688 | first_src=0.000 | first_valid=0.875 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=0.312 | avg_path=3.72 | valid_steps=2.34
[2025-11-18 20:32:39,565][INFO] Iter    950 | loss=0.0428 | td_err=0.1378 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.406 | hit=0.406 | stage2=0.531 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=0.406 | avg_path=3.81 | valid_steps=2.53
[2025-11-18 20:32:45,131][INFO] Iter   1000 | loss=0.0451 | td_err=0.1308 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.438 | hit=0.438 | stage2=0.594 | first_src=0.000 | first_valid=0.844 | invalid_edge=0.125 | invalid_tok=0.000 | avg_ep_reward=0.438 | avg_path=3.66 | valid_steps=2.53
[2025-11-18 20:32:47,513][INFO] ---- Evaluation at iter 1000 ----
[2025-11-18 20:32:47,515][INFO]   S1->S2: 23.60% (21 / 89)
[2025-11-18 20:32:47,515][INFO]   S2->S3: 6.59% (6 / 91)
[2025-11-18 20:32:47,515][INFO]   S1->S3: 13.33% (18 / 135)
[2025-11-18 20:32:47,515][INFO]   overall: 14.29% (45 / 315)
[2025-11-18 20:32:52,932][INFO] Iter   1050 | loss=0.0297 | td_err=0.1199 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.781 | first_src=0.000 | first_valid=0.875 | invalid_edge=0.156 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=3.56 | valid_steps=2.41
[2025-11-18 20:32:58,331][INFO] Iter   1100 | loss=0.0126 | td_err=0.0726 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.625 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.94 | valid_steps=1.91
[2025-11-18 20:33:03,596][INFO] Iter   1150 | loss=0.0267 | td_err=0.1089 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.375 | hit=0.375 | stage2=0.688 | first_src=0.000 | first_valid=0.875 | invalid_edge=0.156 | invalid_tok=0.000 | avg_ep_reward=0.375 | avg_path=3.56 | valid_steps=2.41
[2025-11-18 20:33:08,888][INFO] Iter   1200 | loss=0.0129 | td_err=0.0772 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.500 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=3.31 | valid_steps=2.22
[2025-11-18 20:33:14,116][INFO] Iter   1250 | loss=0.0198 | td_err=0.0807 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.406 | hit=0.406 | stage2=0.469 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.250 | invalid_tok=0.000 | avg_ep_reward=0.406 | avg_path=2.91 | valid_steps=1.66
[2025-11-18 20:33:19,312][INFO] Iter   1300 | loss=0.0114 | td_err=0.0668 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.531 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=3.09 | valid_steps=2.00
[2025-11-18 20:33:24,226][INFO] Iter   1350 | loss=0.0135 | td_err=0.0755 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.531 | first_src=0.000 | first_valid=0.844 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=3.12 | valid_steps=2.03
[2025-11-18 20:33:29,271][INFO] Iter   1400 | loss=0.0123 | td_err=0.0757 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.562 | first_src=0.000 | first_valid=0.906 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=3.06 | valid_steps=2.03
[2025-11-18 20:33:34,339][INFO] Iter   1450 | loss=0.0081 | td_err=0.0634 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.500 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.125 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=3.31 | valid_steps=2.19
[2025-11-18 20:33:39,250][INFO] Iter   1500 | loss=0.0140 | td_err=0.0722 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.469 | first_src=0.000 | first_valid=0.875 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=3.28 | valid_steps=2.25
[2025-11-18 20:33:43,990][INFO] Iter   1550 | loss=0.0040 | td_err=0.0442 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.500 | hit=0.500 | stage2=0.500 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.500 | avg_path=2.81 | valid_steps=1.81
[2025-11-18 20:33:48,812][INFO] Iter   1600 | loss=0.0064 | td_err=0.0572 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.781 | first_src=0.000 | first_valid=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.81 | valid_steps=1.81
[2025-11-18 20:33:53,593][INFO] Iter   1650 | loss=0.0052 | td_err=0.0509 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.594 | first_src=0.000 | first_valid=0.875 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=3.34 | valid_steps=2.31
[2025-11-18 20:33:58,430][INFO] Iter   1700 | loss=0.0119 | td_err=0.0627 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.656 | first_src=0.000 | first_valid=0.812 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.94 | valid_steps=1.91
[2025-11-18 20:34:03,203][INFO] Iter   1750 | loss=0.0068 | td_err=0.0617 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.625 | first_src=0.000 | first_valid=0.812 | invalid_edge=0.062 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=3.41 | valid_steps=2.34
[2025-11-18 20:34:08,210][INFO] Iter   1800 | loss=0.0033 | td_err=0.0412 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.562 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=2.66 | valid_steps=1.66
[2025-11-18 20:34:12,995][INFO] Iter   1850 | loss=0.0030 | td_err=0.0401 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.562 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.062 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.97 | valid_steps=1.91
[2025-11-18 20:34:17,969][INFO] Iter   1900 | loss=0.0028 | td_err=0.0396 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.438 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.81 | valid_steps=1.81
[2025-11-18 20:34:23,038][INFO] Iter   1950 | loss=0.0040 | td_err=0.0468 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.594 | first_src=0.000 | first_valid=0.812 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.81 | valid_steps=1.81
[2025-11-18 20:34:27,878][INFO] Iter   2000 | loss=0.0064 | td_err=0.0557 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.500 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.94 | valid_steps=1.94
[2025-11-18 20:34:30,327][INFO] ---- Evaluation at iter 2000 ----
[2025-11-18 20:34:30,328][INFO]   S1->S2: 47.19% (42 / 89)
[2025-11-18 20:34:30,328][INFO]   S2->S3: 38.46% (35 / 91)
[2025-11-18 20:34:30,328][INFO]   S1->S3: 25.19% (34 / 135)
[2025-11-18 20:34:30,328][INFO]   overall: 35.24% (111 / 315)
[2025-11-18 20:34:30,332][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251118_203030/ckpt_ql_2000.pt
[2025-11-18 20:34:35,216][INFO] Iter   2050 | loss=0.0027 | td_err=0.0382 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.344 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.81 | valid_steps=1.81
[2025-11-18 20:34:39,915][INFO] Iter   2100 | loss=0.0041 | td_err=0.0430 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.750 | hit=0.750 | stage2=0.688 | first_src=0.000 | first_valid=0.812 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.750 | avg_path=3.31 | valid_steps=2.28
[2025-11-18 20:34:44,589][INFO] Iter   2150 | loss=0.0054 | td_err=0.0502 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.562 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=3.03 | valid_steps=2.00
[2025-11-18 20:34:49,240][INFO] Iter   2200 | loss=0.0033 | td_err=0.0412 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.500 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.78 | valid_steps=1.78
[2025-11-18 20:34:53,893][INFO] Iter   2250 | loss=0.0027 | td_err=0.0362 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.750 | hit=0.750 | stage2=0.438 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.750 | avg_path=2.91 | valid_steps=1.91
[2025-11-18 20:34:58,515][INFO] Iter   2300 | loss=0.0046 | td_err=0.0475 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.500 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=3.00 | valid_steps=2.00
[2025-11-18 20:35:03,302][INFO] Iter   2350 | loss=0.0041 | td_err=0.0431 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.812 | hit=0.812 | stage2=0.594 | first_src=0.000 | first_valid=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.812 | avg_path=3.75 | valid_steps=2.75
[2025-11-18 20:35:08,196][INFO] Iter   2400 | loss=0.0038 | td_err=0.0413 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.531 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.81 | valid_steps=1.81
[2025-11-18 20:35:12,903][INFO] Iter   2450 | loss=0.0052 | td_err=0.0500 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.500 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=3.12 | valid_steps=2.12
[2025-11-18 20:35:17,735][INFO] Iter   2500 | loss=0.0017 | td_err=0.0310 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.531 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=3.03 | valid_steps=2.03
[2025-11-18 20:35:22,452][INFO] Iter   2550 | loss=0.0031 | td_err=0.0376 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.562 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=3.28 | valid_steps=2.28
[2025-11-18 20:35:27,187][INFO] Iter   2600 | loss=0.0039 | td_err=0.0460 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.594 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.94 | valid_steps=1.94
[2025-11-18 20:35:31,716][INFO] Iter   2650 | loss=0.0021 | td_err=0.0313 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.406 | hit=0.406 | stage2=0.406 | first_src=0.000 | first_valid=0.531 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.406 | avg_path=2.34 | valid_steps=1.34
[2025-11-18 20:35:36,275][INFO] Iter   2700 | loss=0.0022 | td_err=0.0340 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.469 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=3.03 | valid_steps=2.03
[2025-11-18 20:35:41,222][INFO] Iter   2750 | loss=0.0028 | td_err=0.0346 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.469 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.66 | valid_steps=1.66
[2025-11-18 20:35:46,164][INFO] Iter   2800 | loss=0.0019 | td_err=0.0308 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.500 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.97 | valid_steps=1.97
[2025-11-18 20:35:51,154][INFO] Iter   2850 | loss=0.0024 | td_err=0.0322 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.406 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.59 | valid_steps=1.59
[2025-11-18 20:35:55,942][INFO] Iter   2900 | loss=0.0032 | td_err=0.0414 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.781 | hit=0.781 | stage2=0.469 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.781 | avg_path=3.12 | valid_steps=2.12
[2025-11-18 20:36:00,949][INFO] Iter   2950 | loss=0.0019 | td_err=0.0319 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.531 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=3.06 | valid_steps=2.06
[2025-11-18 20:36:05,692][INFO] Iter   3000 | loss=0.0018 | td_err=0.0321 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.500 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.19 | valid_steps=1.19
[2025-11-18 20:36:08,053][INFO] ---- Evaluation at iter 3000 ----
[2025-11-18 20:36:08,054][INFO]   S1->S2: 41.57% (37 / 89)
[2025-11-18 20:36:08,054][INFO]   S2->S3: 13.19% (12 / 91)
[2025-11-18 20:36:08,054][INFO]   S1->S3: 15.56% (21 / 135)
[2025-11-18 20:36:08,054][INFO]   overall: 22.22% (70 / 315)
[2025-11-18 20:36:12,707][INFO] Iter   3050 | loss=0.0032 | td_err=0.0376 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.438 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.59 | valid_steps=1.56
[2025-11-18 20:36:17,341][INFO] Iter   3100 | loss=0.0028 | td_err=0.0354 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.531 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.94 | valid_steps=1.94
[2025-11-18 20:36:21,989][INFO] Iter   3150 | loss=0.0017 | td_err=0.0308 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.469 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.75 | valid_steps=1.75
[2025-11-18 20:36:26,805][INFO] Iter   3200 | loss=0.0032 | td_err=0.0379 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.469 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.84 | valid_steps=1.84
[2025-11-18 20:36:31,451][INFO] Iter   3250 | loss=0.0019 | td_err=0.0308 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.500 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.81 | valid_steps=1.81
[2025-11-18 20:36:36,127][INFO] Iter   3300 | loss=0.0023 | td_err=0.0360 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.594 | first_src=0.000 | first_valid=0.812 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=2.97 | valid_steps=1.97
[2025-11-18 20:36:40,777][INFO] Iter   3350 | loss=0.0048 | td_err=0.0422 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.500 | hit=0.500 | stage2=0.375 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.500 | avg_path=2.72 | valid_steps=1.72
[2025-11-18 20:36:45,336][INFO] Iter   3400 | loss=0.0019 | td_err=0.0302 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.750 | hit=0.750 | stage2=0.500 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.750 | avg_path=2.84 | valid_steps=1.84
[2025-11-18 20:36:49,930][INFO] Iter   3450 | loss=0.0033 | td_err=0.0370 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.469 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=3.12 | valid_steps=2.12
[2025-11-18 20:36:54,535][INFO] Iter   3500 | loss=0.0022 | td_err=0.0320 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.500 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=3.09 | valid_steps=2.09
[2025-11-18 20:36:59,257][INFO] Iter   3550 | loss=0.0026 | td_err=0.0347 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.500 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=3.09 | valid_steps=2.09
[2025-11-18 20:37:04,232][INFO] Iter   3600 | loss=0.0024 | td_err=0.0366 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.531 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.41 | valid_steps=2.41
[2025-11-18 20:37:09,034][INFO] Iter   3650 | loss=0.0040 | td_err=0.0423 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.719 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.62 | valid_steps=1.62
[2025-11-18 20:37:13,918][INFO] Iter   3700 | loss=0.0055 | td_err=0.0535 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.750 | hit=0.750 | stage2=0.719 | first_src=0.000 | first_valid=0.875 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.750 | avg_path=4.16 | valid_steps=3.12
[2025-11-18 20:37:18,590][INFO] Iter   3750 | loss=0.0028 | td_err=0.0346 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.500 | hit=0.500 | stage2=0.406 | first_src=0.000 | first_valid=0.531 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.500 | avg_path=2.84 | valid_steps=1.81
[2025-11-18 20:37:23,164][INFO] Iter   3800 | loss=0.0024 | td_err=0.0326 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.469 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.97 | valid_steps=1.97
[2025-11-18 20:37:27,679][INFO] Iter   3850 | loss=0.0025 | td_err=0.0339 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.500 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.22 | valid_steps=2.22
[2025-11-18 20:37:32,317][INFO] Iter   3900 | loss=0.0012 | td_err=0.0242 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.469 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=3.47 | valid_steps=2.44
[2025-11-18 20:37:36,929][INFO] Iter   3950 | loss=0.0019 | td_err=0.0286 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.406 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=3.09 | valid_steps=2.09
[2025-11-18 20:37:41,658][INFO] Iter   4000 | loss=0.0038 | td_err=0.0403 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.500 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.34 | valid_steps=1.34
[2025-11-18 20:37:44,030][INFO] ---- Evaluation at iter 4000 ----
[2025-11-18 20:37:44,031][INFO]   S1->S2: 37.08% (33 / 89)
[2025-11-18 20:37:44,031][INFO]   S2->S3: 36.26% (33 / 91)
[2025-11-18 20:37:44,031][INFO]   S1->S3: 28.15% (38 / 135)
[2025-11-18 20:37:44,031][INFO]   overall: 33.02% (104 / 315)
[2025-11-18 20:37:44,035][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251118_203030/ckpt_ql_4000.pt
[2025-11-18 20:37:48,845][INFO] Iter   4050 | loss=0.0026 | td_err=0.0335 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.375 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.75 | valid_steps=1.75
[2025-11-18 20:37:53,718][INFO] Iter   4100 | loss=0.0016 | td_err=0.0279 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.469 | hit=0.469 | stage2=0.406 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.469 | avg_path=2.41 | valid_steps=1.41
[2025-11-18 20:37:58,502][INFO] Iter   4150 | loss=0.0038 | td_err=0.0402 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.562 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=2.97 | valid_steps=1.97
[2025-11-18 20:38:03,270][INFO] Iter   4200 | loss=0.0020 | td_err=0.0298 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.531 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=3.03 | valid_steps=2.03
[2025-11-18 20:38:08,290][INFO] Iter   4250 | loss=0.0044 | td_err=0.0418 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.500 | hit=0.500 | stage2=0.438 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.500 | avg_path=2.62 | valid_steps=1.59
[2025-11-18 20:38:12,991][INFO] Iter   4300 | loss=0.0024 | td_err=0.0327 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.750 | hit=0.750 | stage2=0.656 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.750 | avg_path=3.00 | valid_steps=2.00
[2025-11-18 20:38:17,516][INFO] Iter   4350 | loss=0.0017 | td_err=0.0289 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.750 | hit=0.750 | stage2=0.562 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.750 | avg_path=3.38 | valid_steps=2.38
[2025-11-18 20:38:22,060][INFO] Iter   4400 | loss=0.0024 | td_err=0.0325 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.594 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=3.03 | valid_steps=2.03
[2025-11-18 20:38:26,645][INFO] Iter   4450 | loss=0.0022 | td_err=0.0306 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.438 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.75 | valid_steps=1.75
[2025-11-18 20:38:31,208][INFO] Iter   4500 | loss=0.0016 | td_err=0.0295 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.531 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=3.25 | valid_steps=2.25
[2025-11-18 20:38:35,979][INFO] Iter   4550 | loss=0.0023 | td_err=0.0298 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.500 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.94 | valid_steps=1.91
[2025-11-18 20:38:40,634][INFO] Iter   4600 | loss=0.0030 | td_err=0.0393 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.500 | hit=0.500 | stage2=0.594 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.500 | avg_path=2.88 | valid_steps=1.84
[2025-11-18 20:38:45,180][INFO] Iter   4650 | loss=0.0017 | td_err=0.0289 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.406 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=3.03 | valid_steps=2.03
[2025-11-18 20:38:49,707][INFO] Iter   4700 | loss=0.0021 | td_err=0.0288 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.594 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.47 | valid_steps=1.47
[2025-11-18 20:38:54,271][INFO] Iter   4750 | loss=0.0019 | td_err=0.0293 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.281 | first_src=0.000 | first_valid=0.531 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.38 | valid_steps=1.38
[2025-11-18 20:38:58,932][INFO] Iter   4800 | loss=0.0023 | td_err=0.0311 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.406 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.00 | valid_steps=2.00
[2025-11-18 20:39:03,547][INFO] Iter   4850 | loss=0.0020 | td_err=0.0284 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.406 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.81 | valid_steps=1.81
[2025-11-18 20:39:08,106][INFO] Iter   4900 | loss=0.0019 | td_err=0.0306 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.438 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=2.91 | valid_steps=1.91
[2025-11-18 20:39:12,634][INFO] Iter   4950 | loss=0.0017 | td_err=0.0265 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.844 | hit=0.844 | stage2=0.719 | first_src=0.000 | first_valid=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.844 | avg_path=3.56 | valid_steps=2.56
[2025-11-18 20:39:17,156][INFO] Iter   5000 | loss=0.0013 | td_err=0.0248 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.375 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.88 | valid_steps=1.88
[2025-11-18 20:39:19,598][INFO] ---- Evaluation at iter 5000 ----
[2025-11-18 20:39:19,599][INFO]   S1->S2: 42.70% (38 / 89)
[2025-11-18 20:39:19,599][INFO]   S2->S3: 7.69% (7 / 91)
[2025-11-18 20:39:19,599][INFO]   S1->S3: 20.00% (27 / 135)
[2025-11-18 20:39:19,599][INFO]   overall: 22.86% (72 / 315)
[2025-11-18 20:39:24,214][INFO] Iter   5050 | loss=0.0012 | td_err=0.0246 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.781 | hit=0.781 | stage2=0.562 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.781 | avg_path=3.19 | valid_steps=2.19
[2025-11-18 20:39:28,887][INFO] Iter   5100 | loss=0.0013 | td_err=0.0283 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.344 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.03 | valid_steps=2.03
[2025-11-18 20:39:33,477][INFO] Iter   5150 | loss=0.0012 | td_err=0.0218 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.469 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.88 | valid_steps=1.84
[2025-11-18 20:39:38,036][INFO] Iter   5200 | loss=0.0006 | td_err=0.0164 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.500 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.53 | valid_steps=1.53
[2025-11-18 20:39:42,613][INFO] Iter   5250 | loss=0.0010 | td_err=0.0213 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.469 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=3.00 | valid_steps=2.00
[2025-11-18 20:39:47,174][INFO] Iter   5300 | loss=0.0027 | td_err=0.0341 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.656 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.16 | valid_steps=2.16
[2025-11-18 20:39:51,699][INFO] Iter   5350 | loss=0.0025 | td_err=0.0320 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.594 | first_src=0.000 | first_valid=0.812 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=3.00 | valid_steps=2.00
[2025-11-18 20:39:56,249][INFO] Iter   5400 | loss=0.0011 | td_err=0.0227 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.531 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.25 | valid_steps=2.25
[2025-11-18 20:40:00,818][INFO] Iter   5450 | loss=0.0007 | td_err=0.0194 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.500 | hit=0.500 | stage2=0.281 | first_src=0.000 | first_valid=0.531 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.500 | avg_path=2.56 | valid_steps=1.56
[2025-11-18 20:40:05,352][INFO] Iter   5500 | loss=0.0008 | td_err=0.0186 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.469 | hit=0.469 | stage2=0.375 | first_src=0.000 | first_valid=0.469 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.469 | avg_path=2.25 | valid_steps=1.25
[2025-11-18 20:40:10,052][INFO] Iter   5550 | loss=0.0011 | td_err=0.0231 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.469 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.69 | valid_steps=1.69
[2025-11-18 20:40:14,584][INFO] Iter   5600 | loss=0.0035 | td_err=0.0387 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.406 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.75 | valid_steps=1.75
[2025-11-18 20:40:19,071][INFO] Iter   5650 | loss=0.0032 | td_err=0.0371 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.531 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.75 | valid_steps=1.75
[2025-11-18 20:40:23,586][INFO] Iter   5700 | loss=0.0016 | td_err=0.0241 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.625 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=2.88 | valid_steps=1.88
[2025-11-18 20:40:28,131][INFO] Iter   5750 | loss=0.0019 | td_err=0.0270 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.562 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.91 | valid_steps=1.91
[2025-11-18 20:40:32,995][INFO] Iter   5800 | loss=0.0014 | td_err=0.0225 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.406 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.56 | valid_steps=1.56
[2025-11-18 20:40:37,478][INFO] Iter   5850 | loss=0.0007 | td_err=0.0199 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.406 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.19 | valid_steps=1.19
[2025-11-18 20:40:42,257][INFO] Iter   5900 | loss=0.0016 | td_err=0.0273 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.531 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=2.97 | valid_steps=1.97
[2025-11-18 20:40:47,068][INFO] Iter   5950 | loss=0.0008 | td_err=0.0179 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.375 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.44 | valid_steps=1.44
[2025-11-18 20:40:51,834][INFO] Iter   6000 | loss=0.0014 | td_err=0.0253 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.562 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.78 | valid_steps=1.78
[2025-11-18 20:40:54,307][INFO] ---- Evaluation at iter 6000 ----
[2025-11-18 20:40:54,308][INFO]   S1->S2: 38.20% (34 / 89)
[2025-11-18 20:40:54,308][INFO]   S2->S3: 19.78% (18 / 91)
[2025-11-18 20:40:54,308][INFO]   S1->S3: 22.96% (31 / 135)
[2025-11-18 20:40:54,308][INFO]   overall: 26.35% (83 / 315)
[2025-11-18 20:40:54,312][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251118_203030/ckpt_ql_6000.pt
[2025-11-18 20:40:58,972][INFO] Iter   6050 | loss=0.0026 | td_err=0.0352 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.812 | hit=0.812 | stage2=0.719 | first_src=0.000 | first_valid=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.812 | avg_path=3.06 | valid_steps=2.06
[2025-11-18 20:41:03,460][INFO] Iter   6100 | loss=0.0019 | td_err=0.0310 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.781 | hit=0.781 | stage2=0.625 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.781 | avg_path=2.97 | valid_steps=1.97
[2025-11-18 20:41:08,046][INFO] Iter   6150 | loss=0.0016 | td_err=0.0261 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.406 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.91 | valid_steps=1.91
[2025-11-18 20:41:12,665][INFO] Iter   6200 | loss=0.0026 | td_err=0.0360 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.469 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.19 | valid_steps=2.19
[2025-11-18 20:41:17,232][INFO] Iter   6250 | loss=0.0022 | td_err=0.0307 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.469 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=3.06 | valid_steps=2.06
[2025-11-18 20:41:21,744][INFO] Iter   6300 | loss=0.0011 | td_err=0.0225 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.406 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=2.97 | valid_steps=1.97
[2025-11-18 20:41:26,320][INFO] Iter   6350 | loss=0.0027 | td_err=0.0345 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.625 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=3.00 | valid_steps=2.00
[2025-11-18 20:41:30,879][INFO] Iter   6400 | loss=0.0020 | td_err=0.0331 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.438 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.78 | valid_steps=1.78
[2025-11-18 20:41:35,491][INFO] Iter   6450 | loss=0.0007 | td_err=0.0167 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.438 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.94 | valid_steps=1.94
[2025-11-18 20:41:40,036][INFO] Iter   6500 | loss=0.0010 | td_err=0.0209 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.531 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.91 | valid_steps=1.91
[2025-11-18 20:41:44,512][INFO] Iter   6550 | loss=0.0009 | td_err=0.0194 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.312 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.81 | valid_steps=1.81
[2025-11-18 20:41:48,988][INFO] Iter   6600 | loss=0.0009 | td_err=0.0217 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.500 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.03 | valid_steps=2.03
[2025-11-18 20:41:53,600][INFO] Iter   6650 | loss=0.0010 | td_err=0.0213 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.531 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=3.09 | valid_steps=2.09
[2025-11-18 20:41:58,075][INFO] Iter   6700 | loss=0.0013 | td_err=0.0252 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.500 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.91 | valid_steps=1.91
[2025-11-18 20:42:02,617][INFO] Iter   6750 | loss=0.0018 | td_err=0.0285 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.469 | hit=0.469 | stage2=0.406 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.469 | avg_path=2.25 | valid_steps=1.25
[2025-11-18 20:42:07,188][INFO] Iter   6800 | loss=0.0015 | td_err=0.0227 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.500 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.59 | valid_steps=1.59
[2025-11-18 20:42:11,721][INFO] Iter   6850 | loss=0.0017 | td_err=0.0250 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.500 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.75 | valid_steps=1.72
[2025-11-18 20:42:16,268][INFO] Iter   6900 | loss=0.0025 | td_err=0.0326 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.531 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=3.12 | valid_steps=2.12
[2025-11-18 20:42:20,699][INFO] Iter   6950 | loss=0.0025 | td_err=0.0312 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.594 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=2.84 | valid_steps=1.84
[2025-11-18 20:42:25,359][INFO] Iter   7000 | loss=0.0025 | td_err=0.0337 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.438 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=3.16 | valid_steps=2.16
[2025-11-18 20:42:27,774][INFO] ---- Evaluation at iter 7000 ----
[2025-11-18 20:42:27,775][INFO]   S1->S2: 42.70% (38 / 89)
[2025-11-18 20:42:27,775][INFO]   S2->S3: 3.30% (3 / 91)
[2025-11-18 20:42:27,775][INFO]   S1->S3: 8.89% (12 / 135)
[2025-11-18 20:42:27,775][INFO]   overall: 16.83% (53 / 315)
[2025-11-18 20:42:32,461][INFO] Iter   7050 | loss=0.0020 | td_err=0.0281 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.500 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.66 | valid_steps=1.66
[2025-11-18 20:42:37,378][INFO] Iter   7100 | loss=0.0018 | td_err=0.0274 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.750 | hit=0.750 | stage2=0.406 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.750 | avg_path=3.12 | valid_steps=2.12
[2025-11-18 20:42:41,899][INFO] Iter   7150 | loss=0.0014 | td_err=0.0249 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.625 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.81 | valid_steps=1.81
[2025-11-18 20:42:46,535][INFO] Iter   7200 | loss=0.0013 | td_err=0.0222 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.281 | first_src=0.000 | first_valid=0.531 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.56 | valid_steps=1.56
[2025-11-18 20:42:51,110][INFO] Iter   7250 | loss=0.0006 | td_err=0.0165 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.219 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.72 | valid_steps=1.72
[2025-11-18 20:42:55,750][INFO] Iter   7300 | loss=0.0021 | td_err=0.0317 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.531 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.34 | valid_steps=2.34
[2025-11-18 20:43:00,301][INFO] Iter   7350 | loss=0.0015 | td_err=0.0249 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.562 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.84 | valid_steps=1.84
[2025-11-18 20:43:04,869][INFO] Iter   7400 | loss=0.0013 | td_err=0.0257 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.781 | hit=0.781 | stage2=0.562 | first_src=0.000 | first_valid=0.812 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.781 | avg_path=2.94 | valid_steps=1.94
[2025-11-18 20:43:09,437][INFO] Iter   7450 | loss=0.0015 | td_err=0.0249 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.469 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.88 | valid_steps=1.88
[2025-11-18 20:43:14,019][INFO] Iter   7500 | loss=0.0010 | td_err=0.0235 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.438 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=2.91 | valid_steps=1.88
[2025-11-18 20:43:18,497][INFO] Iter   7550 | loss=0.0011 | td_err=0.0220 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.531 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.97 | valid_steps=1.97
[2025-11-18 20:43:23,305][INFO] Iter   7600 | loss=0.0008 | td_err=0.0203 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.562 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.88 | valid_steps=1.88
[2025-11-18 20:43:28,156][INFO] Iter   7650 | loss=0.0023 | td_err=0.0285 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.812 | hit=0.812 | stage2=0.656 | first_src=0.000 | first_valid=0.844 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.812 | avg_path=3.34 | valid_steps=2.31
[2025-11-18 20:43:33,070][INFO] Iter   7700 | loss=0.0025 | td_err=0.0318 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.562 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=3.16 | valid_steps=2.12
[2025-11-18 20:43:37,711][INFO] Iter   7750 | loss=0.0013 | td_err=0.0212 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.406 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.38 | valid_steps=1.34
[2025-11-18 20:43:42,596][INFO] Iter   7800 | loss=0.0012 | td_err=0.0239 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.344 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.59 | valid_steps=1.59
[2025-11-18 20:43:47,366][INFO] Iter   7850 | loss=0.0016 | td_err=0.0253 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.406 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.69 | valid_steps=1.69
[2025-11-18 20:43:52,137][INFO] Iter   7900 | loss=0.0021 | td_err=0.0297 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.594 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.25 | valid_steps=2.25
[2025-11-18 20:43:56,846][INFO] Iter   7950 | loss=0.0012 | td_err=0.0217 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.469 | hit=0.469 | stage2=0.375 | first_src=0.000 | first_valid=0.469 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.469 | avg_path=2.69 | valid_steps=1.69
[2025-11-18 20:44:01,569][INFO] Iter   8000 | loss=0.0009 | td_err=0.0204 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.688 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=3.62 | valid_steps=2.62
[2025-11-18 20:44:03,989][INFO] ---- Evaluation at iter 8000 ----
[2025-11-18 20:44:03,990][INFO]   S1->S2: 38.20% (34 / 89)
[2025-11-18 20:44:03,990][INFO]   S2->S3: 15.38% (14 / 91)
[2025-11-18 20:44:03,990][INFO]   S1->S3: 12.59% (17 / 135)
[2025-11-18 20:44:03,990][INFO]   overall: 20.63% (65 / 315)
[2025-11-18 20:44:03,994][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251118_203030/ckpt_ql_8000.pt
[2025-11-18 20:44:08,698][INFO] Iter   8050 | loss=0.0009 | td_err=0.0188 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.406 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.50 | valid_steps=1.50
[2025-11-18 20:44:13,487][INFO] Iter   8100 | loss=0.0008 | td_err=0.0196 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.531 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=2.69 | valid_steps=1.69
[2025-11-18 20:44:18,414][INFO] Iter   8150 | loss=0.0012 | td_err=0.0237 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.438 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=3.19 | valid_steps=2.19
[2025-11-18 20:44:23,169][INFO] Iter   8200 | loss=0.0014 | td_err=0.0207 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.500 | hit=0.500 | stage2=0.469 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.500 | avg_path=2.56 | valid_steps=1.56
[2025-11-18 20:44:27,670][INFO] Iter   8250 | loss=0.0014 | td_err=0.0227 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.594 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=2.97 | valid_steps=1.97
[2025-11-18 20:44:32,333][INFO] Iter   8300 | loss=0.0031 | td_err=0.0321 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.812 | hit=0.812 | stage2=0.531 | first_src=0.000 | first_valid=0.875 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.812 | avg_path=3.34 | valid_steps=2.31
[2025-11-18 20:44:36,993][INFO] Iter   8350 | loss=0.0012 | td_err=0.0213 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.469 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.47 | valid_steps=1.47
[2025-11-18 20:44:41,651][INFO] Iter   8400 | loss=0.0016 | td_err=0.0234 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.406 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.59 | valid_steps=1.59
[2025-11-18 20:44:46,605][INFO] Iter   8450 | loss=0.0011 | td_err=0.0234 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.500 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=3.12 | valid_steps=2.12
[2025-11-18 20:44:51,095][INFO] Iter   8500 | loss=0.0009 | td_err=0.0179 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.500 | hit=0.500 | stage2=0.219 | first_src=0.000 | first_valid=0.531 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.500 | avg_path=2.62 | valid_steps=1.62
[2025-11-18 20:44:55,627][INFO] Iter   8550 | loss=0.0015 | td_err=0.0235 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.469 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.91 | valid_steps=1.91
[2025-11-18 20:45:00,192][INFO] Iter   8600 | loss=0.0023 | td_err=0.0306 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.625 | first_src=0.000 | first_valid=0.812 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=2.84 | valid_steps=1.84
[2025-11-18 20:45:04,617][INFO] Iter   8650 | loss=0.0013 | td_err=0.0228 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.500 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=2.75 | valid_steps=1.75
[2025-11-18 20:45:09,137][INFO] Iter   8700 | loss=0.0015 | td_err=0.0238 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.750 | hit=0.750 | stage2=0.406 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.750 | avg_path=3.06 | valid_steps=2.06
[2025-11-18 20:45:13,677][INFO] Iter   8750 | loss=0.0013 | td_err=0.0231 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.438 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=3.00 | valid_steps=1.97
[2025-11-18 20:45:18,190][INFO] Iter   8800 | loss=0.0012 | td_err=0.0207 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.438 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.59 | valid_steps=1.59
[2025-11-18 20:45:22,838][INFO] Iter   8850 | loss=0.0015 | td_err=0.0235 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.531 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=2.62 | valid_steps=1.62
[2025-11-18 20:45:27,556][INFO] Iter   8900 | loss=0.0015 | td_err=0.0235 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.406 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.69 | valid_steps=1.66
[2025-11-18 20:45:32,245][INFO] Iter   8950 | loss=0.0021 | td_err=0.0246 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.469 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.62 | valid_steps=1.62
[2025-11-18 20:45:37,029][INFO] Iter   9000 | loss=0.0012 | td_err=0.0241 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.750 | hit=0.750 | stage2=0.625 | first_src=0.000 | first_valid=0.812 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.750 | avg_path=3.06 | valid_steps=2.06
[2025-11-18 20:45:39,824][INFO] ---- Evaluation at iter 9000 ----
[2025-11-18 20:45:39,825][INFO]   S1->S2: 33.71% (30 / 89)
[2025-11-18 20:45:39,825][INFO]   S2->S3: 19.78% (18 / 91)
[2025-11-18 20:45:39,825][INFO]   S1->S3: 15.56% (21 / 135)
[2025-11-18 20:45:39,825][INFO]   overall: 21.90% (69 / 315)
[2025-11-18 20:45:44,667][INFO] Iter   9050 | loss=0.0013 | td_err=0.0230 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.531 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.72 | valid_steps=1.69
[2025-11-18 20:45:49,220][INFO] Iter   9100 | loss=0.0007 | td_err=0.0153 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.406 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.62 | valid_steps=1.62
[2025-11-18 20:45:53,679][INFO] Iter   9150 | loss=0.0005 | td_err=0.0141 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.406 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.53 | valid_steps=1.53
[2025-11-18 20:45:58,304][INFO] Iter   9200 | loss=0.0007 | td_err=0.0166 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.312 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.59 | valid_steps=1.59
[2025-11-18 20:46:02,953][INFO] Iter   9250 | loss=0.0013 | td_err=0.0231 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.781 | hit=0.781 | stage2=0.469 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.781 | avg_path=3.34 | valid_steps=2.34
[2025-11-18 20:46:07,771][INFO] Iter   9300 | loss=0.0010 | td_err=0.0192 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.406 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.75 | valid_steps=1.75
[2025-11-18 20:46:12,570][INFO] Iter   9350 | loss=0.0005 | td_err=0.0160 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.812 | hit=0.812 | stage2=0.656 | first_src=0.000 | first_valid=0.844 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.812 | avg_path=3.31 | valid_steps=2.31
[2025-11-18 20:46:17,166][INFO] Iter   9400 | loss=0.0008 | td_err=0.0176 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.469 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.81 | valid_steps=1.81
[2025-11-18 20:46:21,748][INFO] Iter   9450 | loss=0.0012 | td_err=0.0260 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.562 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=3.47 | valid_steps=2.47
[2025-11-18 20:46:26,318][INFO] Iter   9500 | loss=0.0014 | td_err=0.0240 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.500 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.16 | valid_steps=2.12
[2025-11-18 20:46:30,860][INFO] Iter   9550 | loss=0.0009 | td_err=0.0184 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.469 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.62 | valid_steps=1.62
[2025-11-18 20:46:35,335][INFO] Iter   9600 | loss=0.0017 | td_err=0.0256 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.500 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.59 | valid_steps=1.59
[2025-11-18 20:46:39,819][INFO] Iter   9650 | loss=0.0010 | td_err=0.0220 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.375 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=2.59 | valid_steps=1.59
[2025-11-18 20:46:44,398][INFO] Iter   9700 | loss=0.0011 | td_err=0.0217 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.750 | hit=0.750 | stage2=0.562 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.750 | avg_path=3.22 | valid_steps=2.22
[2025-11-18 20:46:48,850][INFO] Iter   9750 | loss=0.0011 | td_err=0.0206 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.500 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.84 | valid_steps=1.84
[2025-11-18 20:46:53,391][INFO] Iter   9800 | loss=0.0008 | td_err=0.0201 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.531 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=3.00 | valid_steps=2.00
[2025-11-18 20:46:57,931][INFO] Iter   9850 | loss=0.0012 | td_err=0.0222 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.469 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.47 | valid_steps=1.44
[2025-11-18 20:47:02,472][INFO] Iter   9900 | loss=0.0008 | td_err=0.0166 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.312 | first_src=0.000 | first_valid=0.531 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.34 | valid_steps=1.34
[2025-11-18 20:47:07,091][INFO] Iter   9950 | loss=0.0009 | td_err=0.0202 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.344 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.75 | valid_steps=1.75
[2025-11-18 20:47:11,746][INFO] Iter  10000 | loss=0.0013 | td_err=0.0238 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.562 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=3.31 | valid_steps=2.31
[2025-11-18 20:47:14,171][INFO] ---- Evaluation at iter 10000 ----
[2025-11-18 20:47:14,172][INFO]   S1->S2: 41.57% (37 / 89)
[2025-11-18 20:47:14,172][INFO]   S2->S3: 12.09% (11 / 91)
[2025-11-18 20:47:14,172][INFO]   S1->S3: 13.33% (18 / 135)
[2025-11-18 20:47:14,172][INFO]   overall: 20.95% (66 / 315)
[2025-11-18 20:47:14,175][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251118_203030/ckpt_ql_10000.pt
[2025-11-18 20:47:18,742][INFO] Iter  10050 | loss=0.0015 | td_err=0.0241 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.500 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.69 | valid_steps=1.69
[2025-11-18 20:47:23,273][INFO] Iter  10100 | loss=0.0024 | td_err=0.0292 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.781 | hit=0.781 | stage2=0.562 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.781 | avg_path=3.34 | valid_steps=2.34
[2025-11-18 20:47:27,715][INFO] Iter  10150 | loss=0.0013 | td_err=0.0195 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.438 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.38 | valid_steps=1.38
[2025-11-18 20:47:32,231][INFO] Iter  10200 | loss=0.0004 | td_err=0.0147 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.438 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.72 | valid_steps=1.72
[2025-11-18 20:47:36,687][INFO] Iter  10250 | loss=0.0002 | td_err=0.0093 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.438 | hit=0.438 | stage2=0.312 | first_src=0.000 | first_valid=0.438 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.438 | avg_path=2.31 | valid_steps=1.31
[2025-11-18 20:47:41,175][INFO] Iter  10300 | loss=0.0005 | td_err=0.0145 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.344 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=3.00 | valid_steps=2.00
[2025-11-18 20:47:45,683][INFO] Iter  10350 | loss=0.0005 | td_err=0.0133 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.406 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.50 | valid_steps=1.50
[2025-11-18 20:47:50,196][INFO] Iter  10400 | loss=0.0019 | td_err=0.0277 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.531 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.062 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.78 | valid_steps=1.72
[2025-11-18 20:47:54,817][INFO] Iter  10450 | loss=0.0012 | td_err=0.0227 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.500 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=3.09 | valid_steps=2.09
[2025-11-18 20:47:59,411][INFO] Iter  10500 | loss=0.0011 | td_err=0.0234 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.531 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.62 | valid_steps=1.62
[2025-11-18 20:48:03,926][INFO] Iter  10550 | loss=0.0013 | td_err=0.0225 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.312 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.47 | valid_steps=1.47
[2025-11-18 20:48:08,381][INFO] Iter  10600 | loss=0.0012 | td_err=0.0225 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.469 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.78 | valid_steps=1.78
[2025-11-18 20:48:13,089][INFO] Iter  10650 | loss=0.0010 | td_err=0.0199 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.562 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.31 | valid_steps=2.28
[2025-11-18 20:48:17,535][INFO] Iter  10700 | loss=0.0008 | td_err=0.0183 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.500 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.75 | valid_steps=1.75
[2025-11-18 20:48:22,123][INFO] Iter  10750 | loss=0.0010 | td_err=0.0194 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.438 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.84 | valid_steps=1.84
[2025-11-18 20:48:26,614][INFO] Iter  10800 | loss=0.0009 | td_err=0.0184 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.469 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.94 | valid_steps=1.94
[2025-11-18 20:48:31,194][INFO] Iter  10850 | loss=0.0005 | td_err=0.0139 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.406 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.66 | valid_steps=1.66
[2025-11-18 20:48:35,692][INFO] Iter  10900 | loss=0.0008 | td_err=0.0181 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.531 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.97 | valid_steps=1.97
[2025-11-18 20:48:40,230][INFO] Iter  10950 | loss=0.0021 | td_err=0.0302 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.562 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.94 | valid_steps=1.94
[2025-11-18 20:48:44,789][INFO] Iter  11000 | loss=0.0017 | td_err=0.0258 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.531 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.78 | valid_steps=1.78
[2025-11-18 20:48:47,108][INFO] ---- Evaluation at iter 11000 ----
[2025-11-18 20:48:47,110][INFO]   S1->S2: 37.08% (33 / 89)
[2025-11-18 20:48:47,110][INFO]   S2->S3: 6.59% (6 / 91)
[2025-11-18 20:48:47,110][INFO]   S1->S3: 15.56% (21 / 135)
[2025-11-18 20:48:47,110][INFO]   overall: 19.05% (60 / 315)
[2025-11-18 20:48:51,614][INFO] Iter  11050 | loss=0.0017 | td_err=0.0279 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.406 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.06 | valid_steps=2.03
[2025-11-18 20:48:56,052][INFO] Iter  11100 | loss=0.0008 | td_err=0.0163 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.375 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.34 | valid_steps=1.34
[2025-11-18 20:49:00,508][INFO] Iter  11150 | loss=0.0009 | td_err=0.0178 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.469 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=2.72 | valid_steps=1.72
[2025-11-18 20:49:05,095][INFO] Iter  11200 | loss=0.0010 | td_err=0.0196 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.344 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.91 | valid_steps=1.88
[2025-11-18 20:49:09,728][INFO] Iter  11250 | loss=0.0015 | td_err=0.0235 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.781 | hit=0.781 | stage2=0.656 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.781 | avg_path=3.06 | valid_steps=2.06
[2025-11-18 20:49:14,237][INFO] Iter  11300 | loss=0.0009 | td_err=0.0186 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.500 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.12 | valid_steps=2.12
[2025-11-18 20:49:18,742][INFO] Iter  11350 | loss=0.0006 | td_err=0.0161 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.438 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.56 | valid_steps=1.56
[2025-11-18 20:49:23,311][INFO] Iter  11400 | loss=0.0009 | td_err=0.0157 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.438 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.31 | valid_steps=1.31
[2025-11-18 20:49:27,802][INFO] Iter  11450 | loss=0.0016 | td_err=0.0257 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.594 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=3.03 | valid_steps=2.00
[2025-11-18 20:49:32,347][INFO] Iter  11500 | loss=0.0004 | td_err=0.0121 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.344 | hit=0.344 | stage2=0.219 | first_src=0.000 | first_valid=0.344 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.344 | avg_path=1.94 | valid_steps=0.94
[2025-11-18 20:49:36,857][INFO] Iter  11550 | loss=0.0008 | td_err=0.0167 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.500 | first_src=0.000 | first_valid=0.531 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.38 | valid_steps=1.38
[2025-11-18 20:49:41,381][INFO] Iter  11600 | loss=0.0011 | td_err=0.0214 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.531 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=2.91 | valid_steps=1.91
[2025-11-18 20:49:45,862][INFO] Iter  11650 | loss=0.0014 | td_err=0.0228 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.406 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.62 | valid_steps=1.62
[2025-11-18 20:49:50,527][INFO] Iter  11700 | loss=0.0009 | td_err=0.0179 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.531 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=3.03 | valid_steps=2.00
[2025-11-18 20:49:55,225][INFO] Iter  11750 | loss=0.0010 | td_err=0.0197 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.531 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.75 | valid_steps=1.75
[2025-11-18 20:49:59,749][INFO] Iter  11800 | loss=0.0014 | td_err=0.0241 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.625 | first_src=0.000 | first_valid=0.812 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=2.84 | valid_steps=1.81
[2025-11-18 20:50:04,268][INFO] Iter  11850 | loss=0.0007 | td_err=0.0180 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.469 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.50 | valid_steps=1.50
[2025-11-18 20:50:08,871][INFO] Iter  11900 | loss=0.0013 | td_err=0.0248 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.562 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=3.50 | valid_steps=2.50
[2025-11-18 20:50:13,394][INFO] Iter  11950 | loss=0.0010 | td_err=0.0210 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.531 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=3.22 | valid_steps=2.22
[2025-11-18 20:50:18,139][INFO] Iter  12000 | loss=0.0021 | td_err=0.0274 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.500 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.72 | valid_steps=1.72
[2025-11-18 20:50:20,849][INFO] ---- Evaluation at iter 12000 ----
[2025-11-18 20:50:20,851][INFO]   S1->S2: 24.72% (22 / 89)
[2025-11-18 20:50:20,851][INFO]   S2->S3: 17.58% (16 / 91)
[2025-11-18 20:50:20,851][INFO]   S1->S3: 17.04% (23 / 135)
[2025-11-18 20:50:20,851][INFO]   overall: 19.37% (61 / 315)
[2025-11-18 20:50:20,855][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251118_203030/ckpt_ql_12000.pt
[2025-11-18 20:50:25,504][INFO] Iter  12050 | loss=0.0013 | td_err=0.0204 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.375 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.50 | valid_steps=1.50
[2025-11-18 20:50:30,157][INFO] Iter  12100 | loss=0.0006 | td_err=0.0155 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.531 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.78 | valid_steps=1.78
[2025-11-18 20:50:34,780][INFO] Iter  12150 | loss=0.0005 | td_err=0.0133 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.312 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.84 | valid_steps=1.84
[2025-11-18 20:50:39,444][INFO] Iter  12200 | loss=0.0022 | td_err=0.0275 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.594 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.75 | valid_steps=1.72
[2025-11-18 20:50:43,986][INFO] Iter  12250 | loss=0.0011 | td_err=0.0230 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.500 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.062 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=2.81 | valid_steps=1.75
[2025-11-18 20:50:48,533][INFO] Iter  12300 | loss=0.0004 | td_err=0.0132 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.312 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.56 | valid_steps=1.56
[2025-11-18 20:50:53,084][INFO] Iter  12350 | loss=0.0023 | td_err=0.0320 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.812 | hit=0.812 | stage2=0.500 | first_src=0.000 | first_valid=0.812 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.812 | avg_path=3.53 | valid_steps=2.53
[2025-11-18 20:50:57,660][INFO] Iter  12400 | loss=0.0009 | td_err=0.0173 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.500 | hit=0.500 | stage2=0.375 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=0.500 | avg_path=2.59 | valid_steps=1.50
[2025-11-18 20:51:02,221][INFO] Iter  12450 | loss=0.0011 | td_err=0.0179 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.500 | hit=0.500 | stage2=0.500 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.500 | avg_path=2.56 | valid_steps=1.56
[2025-11-18 20:51:07,072][INFO] Iter  12500 | loss=0.0015 | td_err=0.0219 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.469 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.69 | valid_steps=1.69
[2025-11-18 20:51:11,984][INFO] Iter  12550 | loss=0.0015 | td_err=0.0278 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.812 | hit=0.812 | stage2=0.562 | first_src=0.000 | first_valid=0.812 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.812 | avg_path=3.41 | valid_steps=2.41
[2025-11-18 20:51:16,757][INFO] Iter  12600 | loss=0.0007 | td_err=0.0153 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.500 | hit=0.500 | stage2=0.375 | first_src=0.000 | first_valid=0.500 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.500 | avg_path=2.22 | valid_steps=1.22
[2025-11-18 20:51:21,325][INFO] Iter  12650 | loss=0.0010 | td_err=0.0201 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.500 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=3.38 | valid_steps=2.38
[2025-11-18 20:51:25,906][INFO] Iter  12700 | loss=0.0013 | td_err=0.0206 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.438 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.81 | valid_steps=1.81
[2025-11-18 20:51:30,449][INFO] Iter  12750 | loss=0.0016 | td_err=0.0226 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.625 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.72 | valid_steps=1.72
[2025-11-18 20:51:34,961][INFO] Iter  12800 | loss=0.0008 | td_err=0.0173 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.469 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.91 | valid_steps=1.91
[2025-11-18 20:51:39,481][INFO] Iter  12850 | loss=0.0007 | td_err=0.0161 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.438 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.78 | valid_steps=1.78
[2025-11-18 20:51:44,295][INFO] Iter  12900 | loss=0.0011 | td_err=0.0188 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.375 | first_src=0.000 | first_valid=0.531 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.22 | valid_steps=1.22
[2025-11-18 20:51:49,071][INFO] Iter  12950 | loss=0.0009 | td_err=0.0198 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.469 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=3.00 | valid_steps=2.00
[2025-11-18 20:51:53,833][INFO] Iter  13000 | loss=0.0009 | td_err=0.0173 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.500 | hit=0.500 | stage2=0.500 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.500 | avg_path=2.69 | valid_steps=1.69
[2025-11-18 20:51:56,588][INFO] ---- Evaluation at iter 13000 ----
[2025-11-18 20:51:56,589][INFO]   S1->S2: 26.97% (24 / 89)
[2025-11-18 20:51:56,589][INFO]   S2->S3: 13.19% (12 / 91)
[2025-11-18 20:51:56,589][INFO]   S1->S3: 14.07% (19 / 135)
[2025-11-18 20:51:56,589][INFO]   overall: 17.46% (55 / 315)
[2025-11-18 20:52:01,259][INFO] Iter  13050 | loss=0.0009 | td_err=0.0188 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.500 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.06 | valid_steps=2.06
[2025-11-18 20:52:05,856][INFO] Iter  13100 | loss=0.0010 | td_err=0.0202 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.469 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.97 | valid_steps=1.97
[2025-11-18 20:52:10,378][INFO] Iter  13150 | loss=0.0012 | td_err=0.0212 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.594 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=2.97 | valid_steps=1.97
[2025-11-18 20:52:14,960][INFO] Iter  13200 | loss=0.0006 | td_err=0.0152 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.406 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.50 | valid_steps=1.47
[2025-11-18 20:52:19,498][INFO] Iter  13250 | loss=0.0011 | td_err=0.0228 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.781 | hit=0.781 | stage2=0.594 | first_src=0.000 | first_valid=0.812 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.781 | avg_path=3.38 | valid_steps=2.38
[2025-11-18 20:52:23,912][INFO] Iter  13300 | loss=0.0005 | td_err=0.0126 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.375 | first_src=0.000 | first_valid=0.531 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.41 | valid_steps=1.41
[2025-11-18 20:52:28,390][INFO] Iter  13350 | loss=0.0011 | td_err=0.0208 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.781 | hit=0.781 | stage2=0.562 | first_src=0.000 | first_valid=0.812 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.781 | avg_path=3.03 | valid_steps=2.03
[2025-11-18 20:52:32,978][INFO] Iter  13400 | loss=0.0013 | td_err=0.0224 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.438 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=2.62 | valid_steps=1.62
[2025-11-18 20:52:37,602][INFO] Iter  13450 | loss=0.0006 | td_err=0.0159 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.375 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.56 | valid_steps=1.53
[2025-11-18 20:52:42,182][INFO] Iter  13500 | loss=0.0012 | td_err=0.0240 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.906 | hit=0.906 | stage2=0.625 | first_src=0.000 | first_valid=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.906 | avg_path=3.41 | valid_steps=2.41
[2025-11-18 20:52:46,874][INFO] Iter  13550 | loss=0.0011 | td_err=0.0183 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.469 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.72 | valid_steps=1.72
[2025-11-18 20:52:51,423][INFO] Iter  13600 | loss=0.0005 | td_err=0.0122 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.500 | hit=0.500 | stage2=0.312 | first_src=0.000 | first_valid=0.531 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.500 | avg_path=2.38 | valid_steps=1.38
[2025-11-18 20:52:55,974][INFO] Iter  13650 | loss=0.0007 | td_err=0.0172 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.562 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.00 | valid_steps=2.00
[2025-11-18 20:53:00,536][INFO] Iter  13700 | loss=0.0010 | td_err=0.0194 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.500 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.75 | valid_steps=1.75
[2025-11-18 20:53:05,294][INFO] Iter  13750 | loss=0.0008 | td_err=0.0174 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.500 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=2.69 | valid_steps=1.69
[2025-11-18 20:53:09,947][INFO] Iter  13800 | loss=0.0010 | td_err=0.0205 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.438 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=2.91 | valid_steps=1.91
[2025-11-18 20:53:14,421][INFO] Iter  13850 | loss=0.0007 | td_err=0.0174 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.531 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.81 | valid_steps=1.81
[2025-11-18 20:53:18,985][INFO] Iter  13900 | loss=0.0013 | td_err=0.0225 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.594 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.09 | valid_steps=2.09
[2025-11-18 20:53:23,484][INFO] Iter  13950 | loss=0.0009 | td_err=0.0189 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.562 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=3.25 | valid_steps=2.25
[2025-11-18 20:53:28,012][INFO] Iter  14000 | loss=0.0006 | td_err=0.0173 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.469 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=3.00 | valid_steps=1.97
[2025-11-18 20:53:30,690][INFO] ---- Evaluation at iter 14000 ----
[2025-11-18 20:53:30,691][INFO]   S1->S2: 34.83% (31 / 89)
[2025-11-18 20:53:30,691][INFO]   S2->S3: 9.89% (9 / 91)
[2025-11-18 20:53:30,691][INFO]   S1->S3: 6.67% (9 / 135)
[2025-11-18 20:53:30,691][INFO]   overall: 15.56% (49 / 315)
[2025-11-18 20:53:30,695][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251118_203030/ckpt_ql_14000.pt
[2025-11-18 20:53:35,469][INFO] Iter  14050 | loss=0.0005 | td_err=0.0142 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.500 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.66 | valid_steps=1.66
[2025-11-18 20:53:40,165][INFO] Iter  14100 | loss=0.0005 | td_err=0.0134 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.344 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.84 | valid_steps=1.81
[2025-11-18 20:53:44,694][INFO] Iter  14150 | loss=0.0014 | td_err=0.0247 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.500 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.28 | valid_steps=2.28
[2025-11-18 20:53:49,440][INFO] Iter  14200 | loss=0.0011 | td_err=0.0202 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.469 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=2.84 | valid_steps=1.84
[2025-11-18 20:53:54,096][INFO] Iter  14250 | loss=0.0018 | td_err=0.0270 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.750 | hit=0.750 | stage2=0.531 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.750 | avg_path=3.06 | valid_steps=2.06
[2025-11-18 20:53:58,978][INFO] Iter  14300 | loss=0.0007 | td_err=0.0166 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.438 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.94 | valid_steps=1.94
[2025-11-18 20:54:03,539][INFO] Iter  14350 | loss=0.0015 | td_err=0.0244 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.531 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=2.75 | valid_steps=1.75
[2025-11-18 20:54:08,379][INFO] Iter  14400 | loss=0.0005 | td_err=0.0150 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.438 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.78 | valid_steps=1.78
[2025-11-18 20:54:13,331][INFO] Iter  14450 | loss=0.0012 | td_err=0.0213 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.500 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.12 | valid_steps=2.12
[2025-11-18 20:54:18,097][INFO] Iter  14500 | loss=0.0008 | td_err=0.0188 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.469 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=2.94 | valid_steps=1.94
[2025-11-18 20:54:22,605][INFO] Iter  14550 | loss=0.0007 | td_err=0.0159 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.438 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.59 | valid_steps=1.59
[2025-11-18 20:54:27,066][INFO] Iter  14600 | loss=0.0005 | td_err=0.0146 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.469 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.38 | valid_steps=1.38
[2025-11-18 20:54:31,604][INFO] Iter  14650 | loss=0.0011 | td_err=0.0204 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.375 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=2.66 | valid_steps=1.66
[2025-11-18 20:54:36,134][INFO] Iter  14700 | loss=0.0007 | td_err=0.0154 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.531 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.03 | valid_steps=2.00
[2025-11-18 20:54:40,702][INFO] Iter  14750 | loss=0.0007 | td_err=0.0172 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.406 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.34 | valid_steps=1.34
[2025-11-18 20:54:45,246][INFO] Iter  14800 | loss=0.0007 | td_err=0.0170 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.281 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=3.12 | valid_steps=2.12
[2025-11-18 20:54:49,797][INFO] Iter  14850 | loss=0.0012 | td_err=0.0238 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.594 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.44 | valid_steps=2.44
[2025-11-18 20:54:54,220][INFO] Iter  14900 | loss=0.0007 | td_err=0.0154 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.469 | hit=0.469 | stage2=0.500 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.469 | avg_path=2.09 | valid_steps=1.09
[2025-11-18 20:54:58,715][INFO] Iter  14950 | loss=0.0004 | td_err=0.0135 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.781 | hit=0.781 | stage2=0.562 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.781 | avg_path=3.28 | valid_steps=2.28
[2025-11-18 20:55:03,278][INFO] Iter  15000 | loss=0.0009 | td_err=0.0198 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.469 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.72 | valid_steps=1.72
[2025-11-18 20:55:05,687][INFO] ---- Evaluation at iter 15000 ----
[2025-11-18 20:55:05,688][INFO]   S1->S2: 32.58% (29 / 89)
[2025-11-18 20:55:05,688][INFO]   S2->S3: 3.30% (3 / 91)
[2025-11-18 20:55:05,688][INFO]   S1->S3: 2.96% (4 / 135)
[2025-11-18 20:55:05,688][INFO]   overall: 11.43% (36 / 315)
[2025-11-18 20:55:10,207][INFO] Iter  15050 | loss=0.0006 | td_err=0.0148 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.594 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=3.03 | valid_steps=2.03
[2025-11-18 20:55:14,829][INFO] Iter  15100 | loss=0.0012 | td_err=0.0213 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.375 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.72 | valid_steps=1.72
[2025-11-18 20:55:19,363][INFO] Iter  15150 | loss=0.0008 | td_err=0.0173 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.438 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.56 | valid_steps=1.56
[2025-11-18 20:55:23,913][INFO] Iter  15200 | loss=0.0006 | td_err=0.0157 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.594 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=2.91 | valid_steps=1.91
[2025-11-18 20:55:28,414][INFO] Iter  15250 | loss=0.0008 | td_err=0.0164 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.469 | hit=0.469 | stage2=0.406 | first_src=0.000 | first_valid=0.500 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.469 | avg_path=2.44 | valid_steps=1.41
[2025-11-18 20:55:32,960][INFO] Iter  15300 | loss=0.0003 | td_err=0.0113 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.438 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.47 | valid_steps=1.47
[2025-11-18 20:55:37,620][INFO] Iter  15350 | loss=0.0008 | td_err=0.0182 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.438 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.69 | valid_steps=1.69
[2025-11-18 20:55:42,496][INFO] Iter  15400 | loss=0.0008 | td_err=0.0200 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.406 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.91 | valid_steps=1.91
[2025-11-18 20:55:47,050][INFO] Iter  15450 | loss=0.0005 | td_err=0.0138 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.469 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.66 | valid_steps=1.66
[2025-11-18 20:55:51,537][INFO] Iter  15500 | loss=0.0010 | td_err=0.0192 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.469 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.69 | valid_steps=1.66
[2025-11-18 20:55:56,235][INFO] Iter  15550 | loss=0.0016 | td_err=0.0221 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.656 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=2.75 | valid_steps=1.72
[2025-11-18 20:56:00,705][INFO] Iter  15600 | loss=0.0006 | td_err=0.0148 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.438 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.84 | valid_steps=1.84
[2025-11-18 20:56:05,506][INFO] Iter  15650 | loss=0.0005 | td_err=0.0159 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.469 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=2.81 | valid_steps=1.81
[2025-11-18 20:56:09,990][INFO] Iter  15700 | loss=0.0004 | td_err=0.0121 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.500 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.91 | valid_steps=1.91
[2025-11-18 20:56:14,629][INFO] Iter  15750 | loss=0.0004 | td_err=0.0143 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.844 | hit=0.844 | stage2=0.719 | first_src=0.000 | first_valid=0.844 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.844 | avg_path=3.41 | valid_steps=2.41
[2025-11-18 20:56:19,177][INFO] Iter  15800 | loss=0.0006 | td_err=0.0139 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.406 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.62 | valid_steps=1.62
[2025-11-18 20:56:23,773][INFO] Iter  15850 | loss=0.0012 | td_err=0.0214 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.656 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.16 | valid_steps=2.16
[2025-11-18 20:56:28,553][INFO] Iter  15900 | loss=0.0009 | td_err=0.0181 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.469 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=3.16 | valid_steps=2.12
[2025-11-18 20:56:33,448][INFO] Iter  15950 | loss=0.0009 | td_err=0.0187 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.344 | first_src=0.000 | first_valid=0.531 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.44 | valid_steps=1.44
[2025-11-18 20:56:38,092][INFO] Iter  16000 | loss=0.0010 | td_err=0.0187 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.438 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.75 | valid_steps=1.75
[2025-11-18 20:56:40,518][INFO] ---- Evaluation at iter 16000 ----
[2025-11-18 20:56:40,519][INFO]   S1->S2: 24.72% (22 / 89)
[2025-11-18 20:56:40,519][INFO]   S2->S3: 5.49% (5 / 91)
[2025-11-18 20:56:40,519][INFO]   S1->S3: 8.15% (11 / 135)
[2025-11-18 20:56:40,519][INFO]   overall: 12.06% (38 / 315)
[2025-11-18 20:56:40,522][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251118_203030/ckpt_ql_16000.pt
[2025-11-18 20:56:45,232][INFO] Iter  16050 | loss=0.0015 | td_err=0.0238 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.750 | hit=0.750 | stage2=0.531 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.750 | avg_path=2.81 | valid_steps=1.81
[2025-11-18 20:56:49,908][INFO] Iter  16100 | loss=0.0008 | td_err=0.0165 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.500 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.47 | valid_steps=1.44
[2025-11-18 20:56:54,471][INFO] Iter  16150 | loss=0.0007 | td_err=0.0163 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.406 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.69 | valid_steps=1.66
[2025-11-18 20:56:58,972][INFO] Iter  16200 | loss=0.0006 | td_err=0.0140 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.438 | first_src=0.000 | first_valid=0.531 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.56 | valid_steps=1.56
[2025-11-18 20:57:03,575][INFO] Iter  16250 | loss=0.0006 | td_err=0.0168 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.781 | hit=0.781 | stage2=0.594 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.781 | avg_path=3.09 | valid_steps=2.09
[2025-11-18 20:57:08,169][INFO] Iter  16300 | loss=0.0004 | td_err=0.0128 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.438 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.97 | valid_steps=1.97
[2025-11-18 20:57:12,782][INFO] Iter  16350 | loss=0.0005 | td_err=0.0157 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.469 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.22 | valid_steps=2.19
[2025-11-18 20:57:17,599][INFO] Iter  16400 | loss=0.0005 | td_err=0.0148 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.562 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.31 | valid_steps=2.31
[2025-11-18 20:57:22,228][INFO] Iter  16450 | loss=0.0003 | td_err=0.0098 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.500 | hit=0.500 | stage2=0.344 | first_src=0.000 | first_valid=0.500 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.500 | avg_path=2.78 | valid_steps=1.75
[2025-11-18 20:57:26,704][INFO] Iter  16500 | loss=0.0004 | td_err=0.0122 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.406 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=2.81 | valid_steps=1.81
[2025-11-18 20:57:31,192][INFO] Iter  16550 | loss=0.0004 | td_err=0.0127 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.469 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=3.03 | valid_steps=2.03
[2025-11-18 20:57:35,959][INFO] Iter  16600 | loss=0.0009 | td_err=0.0203 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.531 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=3.00 | valid_steps=2.00
[2025-11-18 20:57:40,580][INFO] Iter  16650 | loss=0.0008 | td_err=0.0177 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.562 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.78 | valid_steps=1.78
[2025-11-18 20:57:45,113][INFO] Iter  16700 | loss=0.0005 | td_err=0.0141 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.375 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.34 | valid_steps=1.34
[2025-11-18 20:57:49,801][INFO] Iter  16750 | loss=0.0005 | td_err=0.0137 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.500 | hit=0.500 | stage2=0.438 | first_src=0.000 | first_valid=0.562 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.500 | avg_path=2.62 | valid_steps=1.62
[2025-11-18 20:57:54,535][INFO] Iter  16800 | loss=0.0006 | td_err=0.0168 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.406 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.88 | valid_steps=1.88
[2025-11-18 20:57:59,077][INFO] Iter  16850 | loss=0.0008 | td_err=0.0189 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.500 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=3.00 | valid_steps=1.97
[2025-11-18 20:58:03,600][INFO] Iter  16900 | loss=0.0007 | td_err=0.0174 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.750 | hit=0.750 | stage2=0.562 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.750 | avg_path=3.22 | valid_steps=2.22
[2025-11-18 20:58:08,035][INFO] Iter  16950 | loss=0.0004 | td_err=0.0125 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.531 | hit=0.531 | stage2=0.438 | first_src=0.000 | first_valid=0.531 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.531 | avg_path=2.31 | valid_steps=1.31
[2025-11-18 20:58:12,574][INFO] Iter  17000 | loss=0.0003 | td_err=0.0111 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.344 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.75 | valid_steps=1.75
[2025-11-18 20:58:15,011][INFO] ---- Evaluation at iter 17000 ----
[2025-11-18 20:58:15,012][INFO]   S1->S2: 26.97% (24 / 89)
[2025-11-18 20:58:15,012][INFO]   S2->S3: 3.30% (3 / 91)
[2025-11-18 20:58:15,012][INFO]   S1->S3: 3.70% (5 / 135)
[2025-11-18 20:58:15,012][INFO]   overall: 10.16% (32 / 315)
[2025-11-18 20:58:19,575][INFO] Iter  17050 | loss=0.0006 | td_err=0.0148 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.406 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=3.06 | valid_steps=2.03
[2025-11-18 20:58:24,038][INFO] Iter  17100 | loss=0.0005 | td_err=0.0133 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.562 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.81 | valid_steps=1.81
[2025-11-18 20:58:28,565][INFO] Iter  17150 | loss=0.0004 | td_err=0.0125 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.500 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.94 | valid_steps=1.94
[2025-11-18 20:58:33,084][INFO] Iter  17200 | loss=0.0007 | td_err=0.0156 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.531 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=3.09 | valid_steps=2.09
[2025-11-18 20:58:37,940][INFO] Iter  17250 | loss=0.0018 | td_err=0.0239 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.500 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.47 | valid_steps=1.47
[2025-11-18 20:58:42,739][INFO] Iter  17300 | loss=0.0011 | td_err=0.0205 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.438 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.66 | valid_steps=1.66
[2025-11-18 20:58:47,426][INFO] Iter  17350 | loss=0.0011 | td_err=0.0220 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.750 | hit=0.750 | stage2=0.594 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.750 | avg_path=3.12 | valid_steps=2.12
[2025-11-18 20:58:52,149][INFO] Iter  17400 | loss=0.0008 | td_err=0.0167 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.438 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.34 | valid_steps=1.34
[2025-11-18 20:58:56,944][INFO] Iter  17450 | loss=0.0004 | td_err=0.0124 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.531 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.88 | valid_steps=1.88
[2025-11-18 20:59:01,717][INFO] Iter  17500 | loss=0.0007 | td_err=0.0170 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.500 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=3.28 | valid_steps=2.28
[2025-11-18 20:59:06,363][INFO] Iter  17550 | loss=0.0012 | td_err=0.0211 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.531 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=3.25 | valid_steps=2.25
[2025-11-18 20:59:10,911][INFO] Iter  17600 | loss=0.0006 | td_err=0.0152 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.469 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.59 | valid_steps=1.59
[2025-11-18 20:59:15,460][INFO] Iter  17650 | loss=0.0006 | td_err=0.0152 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.594 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.91 | valid_steps=1.91
[2025-11-18 20:59:19,990][INFO] Iter  17700 | loss=0.0003 | td_err=0.0100 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.500 | hit=0.500 | stage2=0.375 | first_src=0.000 | first_valid=0.500 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.500 | avg_path=2.41 | valid_steps=1.41
[2025-11-18 20:59:24,462][INFO] Iter  17750 | loss=0.0007 | td_err=0.0178 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.469 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.69 | valid_steps=1.69
[2025-11-18 20:59:28,914][INFO] Iter  17800 | loss=0.0007 | td_err=0.0155 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.344 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.56 | valid_steps=1.56
[2025-11-18 20:59:33,571][INFO] Iter  17850 | loss=0.0013 | td_err=0.0216 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.469 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=3.12 | valid_steps=2.12
[2025-11-18 20:59:38,185][INFO] Iter  17900 | loss=0.0007 | td_err=0.0146 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.469 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.59 | valid_steps=1.59
[2025-11-18 20:59:42,980][INFO] Iter  17950 | loss=0.0014 | td_err=0.0228 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.750 | hit=0.750 | stage2=0.562 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.750 | avg_path=2.81 | valid_steps=1.81
[2025-11-18 20:59:47,819][INFO] Iter  18000 | loss=0.0009 | td_err=0.0179 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.438 | hit=0.438 | stage2=0.438 | first_src=0.000 | first_valid=0.531 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.438 | avg_path=2.47 | valid_steps=1.44
[2025-11-18 20:59:50,208][INFO] ---- Evaluation at iter 18000 ----
[2025-11-18 20:59:50,209][INFO]   S1->S2: 16.85% (15 / 89)
[2025-11-18 20:59:50,209][INFO]   S2->S3: 2.20% (2 / 91)
[2025-11-18 20:59:50,209][INFO]   S1->S3: 0.74% (1 / 135)
[2025-11-18 20:59:50,209][INFO]   overall: 5.71% (18 / 315)
[2025-11-18 20:59:50,213][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251118_203030/ckpt_ql_18000.pt
[2025-11-18 20:59:54,772][INFO] Iter  18050 | loss=0.0008 | td_err=0.0161 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.375 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.53 | valid_steps=1.53
[2025-11-18 20:59:59,570][INFO] Iter  18100 | loss=0.0008 | td_err=0.0163 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.438 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.66 | valid_steps=1.66
[2025-11-18 21:00:04,247][INFO] Iter  18150 | loss=0.0006 | td_err=0.0169 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.781 | hit=0.781 | stage2=0.500 | first_src=0.000 | first_valid=0.781 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.781 | avg_path=3.22 | valid_steps=2.22
[2025-11-18 21:00:09,079][INFO] Iter  18200 | loss=0.0007 | td_err=0.0151 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.406 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.47 | valid_steps=1.47
[2025-11-18 21:00:13,812][INFO] Iter  18250 | loss=0.0003 | td_err=0.0091 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.344 | hit=0.344 | stage2=0.219 | first_src=0.000 | first_valid=0.406 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.344 | avg_path=1.91 | valid_steps=0.91
[2025-11-18 21:00:18,474][INFO] Iter  18300 | loss=0.0013 | td_err=0.0232 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.562 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.25 | valid_steps=2.25
[2025-11-18 21:00:23,103][INFO] Iter  18350 | loss=0.0004 | td_err=0.0129 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.469 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=2.62 | valid_steps=1.62
[2025-11-18 21:00:27,719][INFO] Iter  18400 | loss=0.0004 | td_err=0.0125 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.469 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=3.00 | valid_steps=2.00
[2025-11-18 21:00:32,211][INFO] Iter  18450 | loss=0.0007 | td_err=0.0168 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.594 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.28 | valid_steps=2.28
[2025-11-18 21:00:36,973][INFO] Iter  18500 | loss=0.0008 | td_err=0.0174 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.562 | hit=0.562 | stage2=0.469 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.562 | avg_path=2.53 | valid_steps=1.53
[2025-11-18 21:00:41,578][INFO] Iter  18550 | loss=0.0009 | td_err=0.0173 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.469 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=2.91 | valid_steps=1.91
[2025-11-18 21:00:46,351][INFO] Iter  18600 | loss=0.0004 | td_err=0.0148 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.469 | first_src=0.000 | first_valid=0.625 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.59 | valid_steps=1.56
[2025-11-18 21:00:51,308][INFO] Iter  18650 | loss=0.0009 | td_err=0.0177 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.406 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.62 | valid_steps=1.62
[2025-11-18 21:00:56,027][INFO] Iter  18700 | loss=0.0008 | td_err=0.0174 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.625 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.28 | valid_steps=2.28
[2025-11-18 21:01:00,547][INFO] Iter  18750 | loss=0.0011 | td_err=0.0224 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.750 | hit=0.750 | stage2=0.688 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.750 | avg_path=3.50 | valid_steps=2.47
[2025-11-18 21:01:05,142][INFO] Iter  18800 | loss=0.0007 | td_err=0.0169 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.500 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.56 | valid_steps=1.56
[2025-11-18 21:01:09,800][INFO] Iter  18850 | loss=0.0004 | td_err=0.0120 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.469 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=2.72 | valid_steps=1.72
[2025-11-18 21:01:14,786][INFO] Iter  18900 | loss=0.0010 | td_err=0.0172 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.531 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=3.03 | valid_steps=2.03
[2025-11-18 21:01:19,400][INFO] Iter  18950 | loss=0.0014 | td_err=0.0239 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.469 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.75 | valid_steps=1.75
[2025-11-18 21:01:24,055][INFO] Iter  19000 | loss=0.0030 | td_err=0.0248 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.406 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.72 | valid_steps=1.72
[2025-11-18 21:01:26,533][INFO] ---- Evaluation at iter 19000 ----
[2025-11-18 21:01:26,534][INFO]   S1->S2: 16.85% (15 / 89)
[2025-11-18 21:01:26,534][INFO]   S2->S3: 2.20% (2 / 91)
[2025-11-18 21:01:26,534][INFO]   S1->S3: 3.70% (5 / 135)
[2025-11-18 21:01:26,534][INFO]   overall: 6.98% (22 / 315)
[2025-11-18 21:01:31,074][INFO] Iter  19050 | loss=0.0004 | td_err=0.0148 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.750 | hit=0.750 | stage2=0.625 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.750 | avg_path=2.88 | valid_steps=1.88
[2025-11-18 21:01:35,595][INFO] Iter  19100 | loss=0.0003 | td_err=0.0114 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.281 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.56 | valid_steps=1.56
[2025-11-18 21:01:40,193][INFO] Iter  19150 | loss=0.0007 | td_err=0.0166 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.375 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=3.31 | valid_steps=2.31
[2025-11-18 21:01:44,672][INFO] Iter  19200 | loss=0.0006 | td_err=0.0155 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.312 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.81 | valid_steps=1.81
[2025-11-18 21:01:49,234][INFO] Iter  19250 | loss=0.0007 | td_err=0.0164 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.531 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=3.06 | valid_steps=2.06
[2025-11-18 21:01:53,770][INFO] Iter  19300 | loss=0.0006 | td_err=0.0167 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.469 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=3.34 | valid_steps=2.31
[2025-11-18 21:01:58,166][INFO] Iter  19350 | loss=0.0008 | td_err=0.0179 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.781 | hit=0.781 | stage2=0.531 | first_src=0.000 | first_valid=0.812 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.781 | avg_path=2.69 | valid_steps=1.69
[2025-11-18 21:02:02,662][INFO] Iter  19400 | loss=0.0003 | td_err=0.0126 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.531 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.28 | valid_steps=2.25
[2025-11-18 21:02:07,165][INFO] Iter  19450 | loss=0.0017 | td_err=0.0163 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.312 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.88 | valid_steps=1.88
[2025-11-18 21:02:11,914][INFO] Iter  19500 | loss=0.0005 | td_err=0.0136 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.375 | first_src=0.000 | first_valid=0.594 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.72 | valid_steps=1.72
[2025-11-18 21:02:16,742][INFO] Iter  19550 | loss=0.0007 | td_err=0.0183 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.781 | hit=0.781 | stage2=0.594 | first_src=0.000 | first_valid=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.781 | avg_path=3.59 | valid_steps=2.59
[2025-11-18 21:02:21,346][INFO] Iter  19600 | loss=0.0008 | td_err=0.0188 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.719 | hit=0.719 | stage2=0.656 | first_src=0.000 | first_valid=0.844 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.719 | avg_path=3.75 | valid_steps=2.75
[2025-11-18 21:02:25,925][INFO] Iter  19650 | loss=0.0014 | td_err=0.0213 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.594 | hit=0.594 | stage2=0.500 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.594 | avg_path=2.56 | valid_steps=1.56
[2025-11-18 21:02:30,528][INFO] Iter  19700 | loss=0.0006 | td_err=0.0152 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.531 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=3.03 | valid_steps=2.03
[2025-11-18 21:02:35,106][INFO] Iter  19750 | loss=0.0005 | td_err=0.0147 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.688 | hit=0.688 | stage2=0.531 | first_src=0.000 | first_valid=0.719 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=0.688 | avg_path=2.94 | valid_steps=1.91
[2025-11-18 21:02:39,640][INFO] Iter  19800 | loss=0.0009 | td_err=0.0174 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.625 | hit=0.625 | stage2=0.469 | first_src=0.000 | first_valid=0.688 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.625 | avg_path=2.78 | valid_steps=1.78
[2025-11-18 21:02:44,134][INFO] Iter  19850 | loss=0.0007 | td_err=0.0189 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.750 | hit=0.750 | stage2=0.625 | first_src=0.000 | first_valid=0.750 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.750 | avg_path=3.19 | valid_steps=2.19
[2025-11-18 21:02:48,747][INFO] Iter  19900 | loss=0.0008 | td_err=0.0176 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.531 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.75 | valid_steps=1.75
[2025-11-18 21:02:53,427][INFO] Iter  19950 | loss=0.0012 | td_err=0.0220 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.844 | hit=0.844 | stage2=0.656 | first_src=0.000 | first_valid=0.844 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.844 | avg_path=3.50 | valid_steps=2.50
[2025-11-18 21:02:58,017][INFO] Iter  20000 | loss=0.0007 | td_err=0.0186 | kl=0.0000 | temp=1.000 | eps=0.100 | success=0.656 | hit=0.656 | stage2=0.469 | first_src=0.000 | first_valid=0.656 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=0.656 | avg_path=2.81 | valid_steps=1.81
[2025-11-18 21:03:00,506][INFO] ---- Evaluation at iter 20000 ----
[2025-11-18 21:03:00,506][INFO]   S1->S2: 11.24% (10 / 89)
[2025-11-18 21:03:00,507][INFO]   S2->S3: 2.20% (2 / 91)
[2025-11-18 21:03:00,507][INFO]   S1->S3: 2.96% (4 / 135)
[2025-11-18 21:03:00,507][INFO]   overall: 5.08% (16 / 315)
[2025-11-18 21:03:00,510][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251118_203030/ckpt_ql_20000.pt
[2025-11-18 21:03:00,511][INFO] Q-learning training finished.
