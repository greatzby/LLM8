[2025-11-17 17:06:53,202][INFO] Q-learning training started.
[2025-11-17 17:06:53,202][INFO] Output directory: out_qlearning/ql_20251117_170653
[2025-11-17 17:06:53,202][INFO] Reward type: process
[2025-11-17 17:06:53,204][INFO] Resolved model configuration: {"vocab_size": 92, "block_size": 32, "n_layer": 1, "n_head": 1, "n_embd": 92, "dropout": 0.0, "bias": false}
[2025-11-17 17:06:54,063][INFO] 启用目标网络：EMA=0.9950, sync_interval=0
[2025-11-17 17:06:54,066][INFO] KL 正则启用：coef=0.0500, warmup=0, anneal=12000
[2025-11-17 17:06:54,077][INFO] Loaded 1127 unique (source, target) pairs for Q-learning training.
[2025-11-17 17:07:01,876][INFO] Iter     50 | loss=29.3053 | td_err=4.1177 | kl=2.3768 | temp=0.006 | eps=0.199 | success=1.000 | hit=1.000 | stage2=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.897 | avg_path=4.53 | valid_steps=3.53
[2025-11-17 17:07:09,355][INFO] Iter    100 | loss=20.8876 | td_err=3.6678 | kl=1.7736 | temp=0.013 | eps=0.199 | success=0.500 | hit=0.500 | stage2=0.781 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.055 | avg_path=5.03 | valid_steps=3.19
[2025-11-17 17:07:17,336][INFO] Iter    150 | loss=18.5602 | td_err=3.4463 | kl=1.8719 | temp=0.019 | eps=0.198 | success=0.250 | hit=0.250 | stage2=0.562 | invalid_edge=0.750 | invalid_tok=0.000 | avg_ep_reward=0.505 | avg_path=5.69 | valid_steps=3.28
[2025-11-17 17:07:25,601][INFO] Iter    200 | loss=13.6953 | td_err=2.9419 | kl=2.3529 | temp=0.025 | eps=0.198 | success=0.125 | hit=0.125 | stage2=0.562 | invalid_edge=0.875 | invalid_tok=0.000 | avg_ep_reward=0.120 | avg_path=6.22 | valid_steps=3.50
[2025-11-17 17:07:34,475][INFO] Iter    250 | loss=12.4527 | td_err=2.6278 | kl=2.4558 | temp=0.031 | eps=0.197 | success=0.031 | hit=0.031 | stage2=0.656 | invalid_edge=0.969 | invalid_tok=0.000 | avg_ep_reward=0.019 | avg_path=7.19 | valid_steps=4.25
[2025-11-17 17:07:43,255][INFO] Iter    300 | loss=10.1433 | td_err=2.2672 | kl=2.6742 | temp=0.037 | eps=0.196 | success=0.000 | hit=0.000 | stage2=0.469 | invalid_edge=1.000 | invalid_tok=0.000 | avg_ep_reward=-0.109 | avg_path=6.97 | valid_steps=3.97
[2025-11-17 17:07:52,249][INFO] Iter    350 | loss=8.1168 | td_err=2.0196 | kl=2.9559 | temp=0.044 | eps=0.196 | success=0.000 | hit=0.000 | stage2=0.594 | invalid_edge=1.000 | invalid_tok=0.000 | avg_ep_reward=-0.116 | avg_path=6.66 | valid_steps=3.66
[2025-11-17 17:08:01,155][INFO] Iter    400 | loss=9.7495 | td_err=2.2276 | kl=2.6236 | temp=0.050 | eps=0.195 | success=0.031 | hit=0.031 | stage2=0.625 | invalid_edge=0.969 | invalid_tok=0.000 | avg_ep_reward=-0.094 | avg_path=6.12 | valid_steps=3.19
[2025-11-17 17:08:10,344][INFO] Iter    450 | loss=7.6750 | td_err=1.9626 | kl=2.6890 | temp=0.056 | eps=0.194 | success=0.000 | hit=0.000 | stage2=0.438 | invalid_edge=1.000 | invalid_tok=0.000 | avg_ep_reward=-0.184 | avg_path=6.06 | valid_steps=3.12
[2025-11-17 17:08:19,296][INFO] Iter    500 | loss=6.9507 | td_err=1.8735 | kl=3.0154 | temp=0.062 | eps=0.194 | success=0.000 | hit=0.000 | stage2=0.531 | invalid_edge=1.000 | invalid_tok=0.000 | avg_ep_reward=-0.106 | avg_path=5.72 | valid_steps=2.78
[2025-11-17 17:08:28,431][INFO] Iter    550 | loss=7.4854 | td_err=1.9015 | kl=2.6893 | temp=0.069 | eps=0.193 | success=0.000 | hit=0.000 | stage2=0.594 | invalid_edge=1.000 | invalid_tok=0.000 | avg_ep_reward=-0.061 | avg_path=6.62 | valid_steps=3.66
[2025-11-17 17:08:37,895][INFO] Iter    600 | loss=6.3576 | td_err=1.7602 | kl=2.7649 | temp=0.075 | eps=0.193 | success=0.000 | hit=0.000 | stage2=0.562 | invalid_edge=1.000 | invalid_tok=0.000 | avg_ep_reward=-0.166 | avg_path=6.22 | valid_steps=3.22
[2025-11-17 17:08:47,297][INFO] Iter    650 | loss=6.6944 | td_err=1.8279 | kl=2.8495 | temp=0.081 | eps=0.192 | success=0.000 | hit=0.000 | stage2=0.562 | invalid_edge=1.000 | invalid_tok=0.000 | avg_ep_reward=-0.114 | avg_path=6.16 | valid_steps=3.19
[2025-11-17 17:08:56,301][INFO] Iter    700 | loss=5.9057 | td_err=1.7942 | kl=2.8457 | temp=0.087 | eps=0.191 | success=0.000 | hit=0.000 | stage2=0.594 | invalid_edge=1.000 | invalid_tok=0.000 | avg_ep_reward=-0.144 | avg_path=6.38 | valid_steps=3.38
[2025-11-17 17:09:05,420][INFO] Iter    750 | loss=4.1677 | td_err=1.3964 | kl=3.1129 | temp=0.094 | eps=0.191 | success=0.031 | hit=0.031 | stage2=0.719 | invalid_edge=0.969 | invalid_tok=0.000 | avg_ep_reward=0.072 | avg_path=7.59 | valid_steps=4.66
[2025-11-17 17:09:14,793][INFO] Iter    800 | loss=4.0562 | td_err=1.4287 | kl=2.6382 | temp=0.100 | eps=0.190 | success=0.094 | hit=0.094 | stage2=0.500 | invalid_edge=0.906 | invalid_tok=0.000 | avg_ep_reward=0.012 | avg_path=6.06 | valid_steps=3.25
[2025-11-17 17:09:24,046][INFO] Iter    850 | loss=3.5450 | td_err=1.2797 | kl=2.7349 | temp=0.106 | eps=0.189 | success=0.000 | hit=0.000 | stage2=0.500 | invalid_edge=1.000 | invalid_tok=0.000 | avg_ep_reward=-0.141 | avg_path=6.59 | valid_steps=3.59
[2025-11-17 17:09:33,527][INFO] Iter    900 | loss=3.1161 | td_err=1.1660 | kl=2.7688 | temp=0.113 | eps=0.189 | success=0.031 | hit=0.031 | stage2=0.750 | invalid_edge=0.969 | invalid_tok=0.000 | avg_ep_reward=0.050 | avg_path=7.31 | valid_steps=4.38
[2025-11-17 17:09:43,344][INFO] Iter    950 | loss=2.0684 | td_err=0.9933 | kl=2.6232 | temp=0.119 | eps=0.188 | success=0.094 | hit=0.094 | stage2=0.656 | invalid_edge=0.906 | invalid_tok=0.000 | avg_ep_reward=0.169 | avg_path=7.31 | valid_steps=4.50
[2025-11-17 17:09:53,336][INFO] Iter   1000 | loss=1.9817 | td_err=0.9772 | kl=2.9790 | temp=0.125 | eps=0.188 | success=0.125 | hit=0.125 | stage2=0.781 | invalid_edge=0.875 | invalid_tok=0.000 | avg_ep_reward=0.322 | avg_path=7.91 | valid_steps=5.16
