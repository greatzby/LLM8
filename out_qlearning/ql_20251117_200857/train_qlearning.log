[2025-11-17 20:08:57,917][INFO] Q-learning training started.
[2025-11-17 20:08:57,917][INFO] Output directory: out_qlearning/ql_20251117_200857
[2025-11-17 20:08:57,917][INFO] Reward type: process
[2025-11-17 20:08:57,919][INFO] Resolved model configuration: {"vocab_size": 92, "block_size": 32, "n_layer": 1, "n_head": 1, "n_embd": 92, "dropout": 0.0, "bias": false}
[2025-11-17 20:08:58,583][INFO] 启用目标网络：EMA=0.9950, sync_interval=0
[2025-11-17 20:08:58,586][INFO] KL 正则启用：coef=0.0500, warmup=0, anneal=12000
[2025-11-17 20:08:58,596][INFO] Loaded 1127 unique (source, target) pairs for Q-learning training.
[2025-11-17 20:09:06,387][INFO] Iter     50 | loss=27.3584 | td_err=4.1392 | kl=2.0890 | temp=0.003 | eps=0.099 | success=1.000 | hit=1.000 | stage2=0.781 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=2.775 | avg_path=5.06 | valid_steps=4.06
[2025-11-17 20:09:13,817][INFO] Iter    100 | loss=21.0196 | td_err=3.6459 | kl=2.1515 | temp=0.005 | eps=0.098 | success=0.750 | hit=0.750 | stage2=0.688 | invalid_edge=0.250 | invalid_tok=0.000 | avg_ep_reward=1.484 | avg_path=4.41 | valid_steps=3.16
[2025-11-17 20:09:21,045][INFO] Iter    150 | loss=14.9571 | td_err=3.1110 | kl=2.2074 | temp=0.007 | eps=0.096 | success=0.625 | hit=0.625 | stage2=0.625 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=1.228 | avg_path=5.09 | valid_steps=3.75
[2025-11-17 20:09:29,353][INFO] Iter    200 | loss=13.1214 | td_err=2.8267 | kl=2.5795 | temp=0.010 | eps=0.095 | success=0.500 | hit=0.500 | stage2=0.594 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=0.956 | avg_path=6.00 | valid_steps=4.53
[2025-11-17 20:09:38,270][INFO] Iter    250 | loss=10.5801 | td_err=2.3291 | kl=3.4408 | temp=0.013 | eps=0.094 | success=0.125 | hit=0.125 | stage2=0.719 | invalid_edge=0.781 | invalid_tok=0.000 | avg_ep_reward=-0.175 | avg_path=6.94 | valid_steps=5.16
[2025-11-17 20:09:47,320][INFO] Iter    300 | loss=8.4320 | td_err=2.0469 | kl=3.3656 | temp=0.015 | eps=0.092 | success=0.156 | hit=0.156 | stage2=0.594 | invalid_edge=0.656 | invalid_tok=0.000 | avg_ep_reward=0.122 | avg_path=6.69 | valid_steps=5.03
[2025-11-17 20:09:56,415][INFO] Iter    350 | loss=7.0649 | td_err=1.8896 | kl=3.3838 | temp=0.017 | eps=0.091 | success=0.125 | hit=0.125 | stage2=0.750 | invalid_edge=0.812 | invalid_tok=0.000 | avg_ep_reward=-0.228 | avg_path=7.03 | valid_steps=5.22
[2025-11-17 20:10:05,902][INFO] Iter    400 | loss=4.5544 | td_err=1.5407 | kl=3.3057 | temp=0.020 | eps=0.090 | success=0.188 | hit=0.188 | stage2=0.625 | invalid_edge=0.750 | invalid_tok=0.000 | avg_ep_reward=0.081 | avg_path=7.25 | valid_steps=5.50
[2025-11-17 20:10:15,376][INFO] Iter    450 | loss=5.6754 | td_err=1.4642 | kl=3.2515 | temp=0.023 | eps=0.089 | success=0.219 | hit=0.219 | stage2=0.594 | invalid_edge=0.656 | invalid_tok=0.094 | avg_ep_reward=0.169 | avg_path=6.84 | valid_steps=5.19
[2025-11-17 20:10:24,765][INFO] Iter    500 | loss=2.7110 | td_err=1.1416 | kl=3.2262 | temp=0.025 | eps=0.088 | success=0.125 | hit=0.125 | stage2=0.688 | invalid_edge=0.562 | invalid_tok=0.031 | avg_ep_reward=0.681 | avg_path=7.88 | valid_steps=6.31
[2025-11-17 20:10:34,505][INFO] Iter    550 | loss=2.7668 | td_err=1.1113 | kl=2.9482 | temp=0.028 | eps=0.086 | success=0.125 | hit=0.125 | stage2=0.688 | invalid_edge=0.531 | invalid_tok=0.062 | avg_ep_reward=0.559 | avg_path=7.28 | valid_steps=5.75
[2025-11-17 20:10:44,350][INFO] Iter    600 | loss=2.1245 | td_err=1.0019 | kl=2.8798 | temp=0.030 | eps=0.085 | success=0.156 | hit=0.156 | stage2=0.562 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=0.591 | avg_path=6.81 | valid_steps=5.31
[2025-11-17 20:10:54,743][INFO] Iter    650 | loss=1.6855 | td_err=0.7387 | kl=3.0804 | temp=0.033 | eps=0.084 | success=0.062 | hit=0.062 | stage2=0.750 | invalid_edge=0.344 | invalid_tok=0.062 | avg_ep_reward=1.181 | avg_path=7.88 | valid_steps=6.53
[2025-11-17 20:11:05,170][INFO] Iter    700 | loss=1.0742 | td_err=0.5784 | kl=3.0086 | temp=0.035 | eps=0.083 | success=0.156 | hit=0.156 | stage2=0.688 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.500 | avg_path=7.72 | valid_steps=6.44
[2025-11-17 20:11:16,221][INFO] Iter    750 | loss=0.6601 | td_err=0.4876 | kl=2.7044 | temp=0.038 | eps=0.081 | success=0.219 | hit=0.219 | stage2=0.750 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=2.084 | avg_path=7.56 | valid_steps=6.47
[2025-11-17 20:11:27,553][INFO] Iter    800 | loss=0.4977 | td_err=0.3866 | kl=2.6108 | temp=0.040 | eps=0.080 | success=0.094 | hit=0.094 | stage2=0.625 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=2.150 | avg_path=7.91 | valid_steps=6.88
[2025-11-17 20:11:39,101][INFO] Iter    850 | loss=0.4827 | td_err=0.3936 | kl=2.6339 | temp=0.043 | eps=0.079 | success=0.156 | hit=0.156 | stage2=0.938 | invalid_edge=0.031 | invalid_tok=0.031 | avg_ep_reward=2.556 | avg_path=8.84 | valid_steps=7.81
[2025-11-17 20:11:51,077][INFO] Iter    900 | loss=0.6026 | td_err=0.4397 | kl=2.7037 | temp=0.045 | eps=0.077 | success=0.250 | hit=0.250 | stage2=0.844 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=2.737 | avg_path=8.94 | valid_steps=7.91
[2025-11-17 20:12:02,892][INFO] Iter    950 | loss=1.1964 | td_err=0.4801 | kl=2.1843 | temp=0.048 | eps=0.076 | success=0.219 | hit=0.219 | stage2=0.812 | invalid_edge=0.188 | invalid_tok=0.000 | avg_ep_reward=2.397 | avg_path=9.41 | valid_steps=8.25
[2025-11-17 20:12:14,314][INFO] Iter   1000 | loss=0.4720 | td_err=0.3829 | kl=2.2625 | temp=0.050 | eps=0.075 | success=0.219 | hit=0.219 | stage2=0.844 | invalid_edge=0.062 | invalid_tok=0.000 | avg_ep_reward=2.594 | avg_path=8.91 | valid_steps=7.84
[2025-11-17 20:12:21,919][INFO] ---- Evaluation at iter 1000 ----
[2025-11-17 20:12:21,919][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 20:12:21,919][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 20:12:21,919][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 20:12:21,919][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 20:12:33,786][INFO] Iter   1050 | loss=0.9753 | td_err=0.4593 | kl=2.2170 | temp=0.053 | eps=0.074 | success=0.375 | hit=0.375 | stage2=0.812 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=2.909 | avg_path=8.91 | valid_steps=7.88
[2025-11-17 20:12:45,859][INFO] Iter   1100 | loss=0.2685 | td_err=0.2763 | kl=2.4655 | temp=0.055 | eps=0.073 | success=0.188 | hit=0.188 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=2.981 | avg_path=9.69 | valid_steps=8.69
[2025-11-17 20:12:57,998][INFO] Iter   1150 | loss=0.3112 | td_err=0.2751 | kl=2.4435 | temp=0.057 | eps=0.071 | success=0.188 | hit=0.188 | stage2=0.969 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=2.987 | avg_path=10.00 | valid_steps=8.97
[2025-11-17 20:13:10,205][INFO] Iter   1200 | loss=1.2023 | td_err=0.4286 | kl=2.3299 | temp=0.060 | eps=0.070 | success=0.125 | hit=0.125 | stage2=0.875 | invalid_edge=0.062 | invalid_tok=0.000 | avg_ep_reward=2.591 | avg_path=9.34 | valid_steps=8.28
[2025-11-17 20:13:22,349][INFO] Iter   1250 | loss=0.4289 | td_err=0.2833 | kl=2.5046 | temp=0.062 | eps=0.069 | success=0.188 | hit=0.188 | stage2=0.844 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=2.737 | avg_path=9.25 | valid_steps=8.22
[2025-11-17 20:13:34,676][INFO] Iter   1300 | loss=0.4654 | td_err=0.2943 | kl=2.2157 | temp=0.065 | eps=0.068 | success=0.188 | hit=0.188 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=3.047 | avg_path=9.97 | valid_steps=8.97
[2025-11-17 20:13:47,272][INFO] Iter   1350 | loss=0.2506 | td_err=0.2268 | kl=2.4403 | temp=0.068 | eps=0.066 | success=0.219 | hit=0.219 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=3.203 | avg_path=10.31 | valid_steps=9.31
[2025-11-17 20:14:00,130][INFO] Iter   1400 | loss=0.2685 | td_err=0.2537 | kl=2.2901 | temp=0.070 | eps=0.065 | success=0.219 | hit=0.219 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=3.253 | avg_path=10.50 | valid_steps=9.50
[2025-11-17 20:14:13,180][INFO] Iter   1450 | loss=2.0481 | td_err=0.4509 | kl=2.3017 | temp=0.072 | eps=0.064 | success=0.219 | hit=0.219 | stage2=0.969 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=2.859 | avg_path=10.00 | valid_steps=8.91
[2025-11-17 20:14:26,369][INFO] Iter   1500 | loss=0.2124 | td_err=0.2010 | kl=2.3785 | temp=0.075 | eps=0.062 | success=0.156 | hit=0.156 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=3.250 | avg_path=10.78 | valid_steps=9.78
[2025-11-17 20:14:39,534][INFO] Iter   1550 | loss=0.6522 | td_err=0.3708 | kl=2.2635 | temp=0.078 | eps=0.061 | success=0.406 | hit=0.406 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=3.559 | avg_path=10.56 | valid_steps=9.56
[2025-11-17 20:14:52,795][INFO] Iter   1600 | loss=0.5218 | td_err=0.3111 | kl=2.2278 | temp=0.080 | eps=0.060 | success=0.344 | hit=0.344 | stage2=0.938 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=3.666 | avg_path=11.50 | valid_steps=10.47
[2025-11-17 20:15:06,359][INFO] Iter   1650 | loss=0.1962 | td_err=0.2040 | kl=2.2990 | temp=0.083 | eps=0.059 | success=0.188 | hit=0.188 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=3.556 | avg_path=11.62 | valid_steps=10.62
[2025-11-17 20:15:19,776][INFO] Iter   1700 | loss=0.1912 | td_err=0.2041 | kl=2.2497 | temp=0.085 | eps=0.058 | success=0.219 | hit=0.219 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=3.841 | avg_path=12.38 | valid_steps=11.38
[2025-11-17 20:15:33,596][INFO] Iter   1750 | loss=0.7946 | td_err=0.3227 | kl=2.1414 | temp=0.088 | eps=0.056 | success=0.406 | hit=0.406 | stage2=0.875 | invalid_edge=0.062 | invalid_tok=0.000 | avg_ep_reward=3.406 | avg_path=10.66 | valid_steps=9.59
[2025-11-17 20:15:47,304][INFO] Iter   1800 | loss=0.3026 | td_err=0.2262 | kl=2.2758 | temp=0.090 | eps=0.055 | success=0.250 | hit=0.250 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=3.706 | avg_path=11.81 | valid_steps=10.81
[2025-11-17 20:16:01,153][INFO] Iter   1850 | loss=0.2881 | td_err=0.2335 | kl=2.2238 | temp=0.093 | eps=0.054 | success=0.250 | hit=0.250 | stage2=0.938 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=3.497 | avg_path=11.41 | valid_steps=10.38
[2025-11-17 20:16:15,343][INFO] Iter   1900 | loss=0.2041 | td_err=0.2271 | kl=2.1368 | temp=0.095 | eps=0.053 | success=0.281 | hit=0.281 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=3.825 | avg_path=12.09 | valid_steps=11.09
[2025-11-17 20:16:29,247][INFO] Iter   1950 | loss=0.1673 | td_err=0.1717 | kl=2.0862 | temp=0.098 | eps=0.051 | success=0.281 | hit=0.281 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=3.666 | avg_path=11.56 | valid_steps=10.56
[2025-11-17 20:16:43,937][INFO] Iter   2000 | loss=0.1538 | td_err=0.1659 | kl=2.2394 | temp=0.100 | eps=0.050 | success=0.219 | hit=0.219 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=3.903 | avg_path=12.62 | valid_steps=11.62
[2025-11-17 20:16:52,152][INFO] ---- Evaluation at iter 2000 ----
[2025-11-17 20:16:52,152][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 20:16:52,152][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 20:16:52,152][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 20:16:52,152][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 20:16:52,156][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251117_200857/ckpt_ql_2000.pt
[2025-11-17 20:17:06,491][INFO] Iter   2050 | loss=0.1646 | td_err=0.1801 | kl=2.1767 | temp=0.102 | eps=0.049 | success=0.219 | hit=0.219 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=3.834 | avg_path=12.38 | valid_steps=11.38
[2025-11-17 20:17:20,919][INFO] Iter   2100 | loss=0.1607 | td_err=0.1769 | kl=2.1284 | temp=0.105 | eps=0.048 | success=0.281 | hit=0.281 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.169 | avg_path=13.22 | valid_steps=12.22
[2025-11-17 20:17:35,266][INFO] Iter   2150 | loss=0.4694 | td_err=0.2227 | kl=2.1876 | temp=0.107 | eps=0.046 | success=0.281 | hit=0.281 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=3.962 | avg_path=12.53 | valid_steps=11.53
[2025-11-17 20:17:50,275][INFO] Iter   2200 | loss=0.1660 | td_err=0.1838 | kl=2.0579 | temp=0.110 | eps=0.045 | success=0.281 | hit=0.281 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.391 | avg_path=13.94 | valid_steps=12.94
[2025-11-17 20:18:05,336][INFO] Iter   2250 | loss=0.1860 | td_err=0.1831 | kl=1.9077 | temp=0.113 | eps=0.044 | success=0.375 | hit=0.375 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.216 | avg_path=12.84 | valid_steps=11.84
[2025-11-17 20:18:19,782][INFO] Iter   2300 | loss=0.1707 | td_err=0.1600 | kl=1.8552 | temp=0.115 | eps=0.043 | success=0.344 | hit=0.344 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.184 | avg_path=12.94 | valid_steps=11.94
[2025-11-17 20:18:34,453][INFO] Iter   2350 | loss=0.1505 | td_err=0.1799 | kl=1.9623 | temp=0.118 | eps=0.041 | success=0.344 | hit=0.344 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.197 | avg_path=13.00 | valid_steps=12.00
[2025-11-17 20:18:48,733][INFO] Iter   2400 | loss=0.1237 | td_err=0.1595 | kl=1.7848 | temp=0.120 | eps=0.040 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.175 | avg_path=11.97 | valid_steps=10.97
[2025-11-17 20:19:03,279][INFO] Iter   2450 | loss=0.2563 | td_err=0.1745 | kl=2.0111 | temp=0.123 | eps=0.039 | success=0.344 | hit=0.344 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.141 | avg_path=12.81 | valid_steps=11.81
[2025-11-17 20:19:17,639][INFO] Iter   2500 | loss=0.4327 | td_err=0.2135 | kl=1.9454 | temp=0.125 | eps=0.038 | success=0.375 | hit=0.375 | stage2=0.844 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.025 | avg_path=12.31 | valid_steps=11.31
[2025-11-17 20:19:32,207][INFO] Iter   2550 | loss=0.1338 | td_err=0.1460 | kl=2.0294 | temp=0.128 | eps=0.036 | success=0.250 | hit=0.250 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.131 | avg_path=13.19 | valid_steps=12.19
[2025-11-17 20:19:46,610][INFO] Iter   2600 | loss=0.2086 | td_err=0.1713 | kl=1.7827 | temp=0.130 | eps=0.035 | success=0.531 | hit=0.531 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.575 | avg_path=13.28 | valid_steps=12.28
[2025-11-17 20:20:00,944][INFO] Iter   2650 | loss=0.1079 | td_err=0.1263 | kl=1.8378 | temp=0.133 | eps=0.034 | success=0.438 | hit=0.438 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.284 | avg_path=12.78 | valid_steps=11.78
[2025-11-17 20:20:15,369][INFO] Iter   2700 | loss=0.1564 | td_err=0.1582 | kl=1.6846 | temp=0.135 | eps=0.033 | success=0.438 | hit=0.438 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.197 | avg_path=12.53 | valid_steps=11.53
[2025-11-17 20:20:29,848][INFO] Iter   2750 | loss=0.1301 | td_err=0.1399 | kl=1.8412 | temp=0.138 | eps=0.031 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.475 | avg_path=13.44 | valid_steps=12.44
[2025-11-17 20:20:44,647][INFO] Iter   2800 | loss=0.1006 | td_err=0.1184 | kl=1.7446 | temp=0.140 | eps=0.030 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.466 | avg_path=13.41 | valid_steps=12.41
[2025-11-17 20:20:59,194][INFO] Iter   2850 | loss=0.1160 | td_err=0.1100 | kl=1.7687 | temp=0.143 | eps=0.029 | success=0.469 | hit=0.469 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=3.947 | avg_path=11.56 | valid_steps=10.56
[2025-11-17 20:21:13,595][INFO] Iter   2900 | loss=0.1800 | td_err=0.1555 | kl=1.8405 | temp=0.145 | eps=0.028 | success=0.344 | hit=0.344 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.612 | avg_path=14.34 | valid_steps=13.34
[2025-11-17 20:21:27,811][INFO] Iter   2950 | loss=0.0937 | td_err=0.1086 | kl=1.7646 | temp=0.148 | eps=0.026 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.362 | avg_path=13.22 | valid_steps=12.22
[2025-11-17 20:21:42,519][INFO] Iter   3000 | loss=0.0862 | td_err=0.1057 | kl=1.6211 | temp=0.150 | eps=0.025 | success=0.375 | hit=0.375 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.584 | avg_path=14.09 | valid_steps=13.09
[2025-11-17 20:21:50,107][INFO] ---- Evaluation at iter 3000 ----
[2025-11-17 20:21:50,107][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 20:21:50,107][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 20:21:50,107][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 20:21:50,107][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 20:22:04,810][INFO] Iter   3050 | loss=0.2013 | td_err=0.1620 | kl=1.6060 | temp=0.152 | eps=0.024 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.381 | avg_path=12.66 | valid_steps=11.66
[2025-11-17 20:22:19,310][INFO] Iter   3100 | loss=0.1381 | td_err=0.1250 | kl=1.7226 | temp=0.155 | eps=0.022 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.419 | avg_path=13.25 | valid_steps=12.25
[2025-11-17 20:22:33,911][INFO] Iter   3150 | loss=0.0928 | td_err=0.1078 | kl=1.6191 | temp=0.158 | eps=0.021 | success=0.438 | hit=0.438 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.359 | avg_path=13.03 | valid_steps=12.03
[2025-11-17 20:22:48,210][INFO] Iter   3200 | loss=0.0951 | td_err=0.1142 | kl=1.6573 | temp=0.160 | eps=0.020 | success=0.344 | hit=0.344 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.419 | avg_path=13.72 | valid_steps=12.72
[2025-11-17 20:23:02,771][INFO] Iter   3250 | loss=0.0933 | td_err=0.1031 | kl=1.6046 | temp=0.163 | eps=0.019 | success=0.344 | hit=0.344 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.209 | avg_path=13.06 | valid_steps=12.06
[2025-11-17 20:23:17,427][INFO] Iter   3300 | loss=0.0704 | td_err=0.0847 | kl=1.5154 | temp=0.165 | eps=0.018 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.428 | avg_path=12.81 | valid_steps=11.81
[2025-11-17 20:23:32,119][INFO] Iter   3350 | loss=0.0845 | td_err=0.0975 | kl=1.7031 | temp=0.168 | eps=0.016 | success=0.312 | hit=0.312 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.328 | avg_path=13.59 | valid_steps=12.59
[2025-11-17 20:23:46,921][INFO] Iter   3400 | loss=0.0730 | td_err=0.0850 | kl=1.6059 | temp=0.170 | eps=0.015 | success=0.344 | hit=0.344 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.512 | avg_path=14.03 | valid_steps=13.03
[2025-11-17 20:24:01,640][INFO] Iter   3450 | loss=0.0645 | td_err=0.0755 | kl=1.4816 | temp=0.173 | eps=0.014 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.231 | avg_path=12.47 | valid_steps=11.47
[2025-11-17 20:24:16,646][INFO] Iter   3500 | loss=0.0970 | td_err=0.1066 | kl=1.4919 | temp=0.175 | eps=0.012 | success=0.531 | hit=0.531 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.431 | avg_path=12.84 | valid_steps=11.84
[2025-11-17 20:24:31,302][INFO] Iter   3550 | loss=0.0609 | td_err=0.0792 | kl=1.3786 | temp=0.177 | eps=0.011 | success=0.562 | hit=0.562 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.341 | avg_path=12.34 | valid_steps=11.34
[2025-11-17 20:24:46,282][INFO] Iter   3600 | loss=0.0698 | td_err=0.0915 | kl=1.4594 | temp=0.180 | eps=0.010 | success=0.375 | hit=0.375 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.466 | avg_path=13.72 | valid_steps=12.72
[2025-11-17 20:25:00,869][INFO] Iter   3650 | loss=0.0684 | td_err=0.0756 | kl=1.5153 | temp=0.182 | eps=0.009 | success=0.375 | hit=0.375 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.309 | avg_path=13.22 | valid_steps=12.22
[2025-11-17 20:25:15,622][INFO] Iter   3700 | loss=0.0598 | td_err=0.0639 | kl=1.4612 | temp=0.185 | eps=0.007 | success=0.406 | hit=0.406 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.281 | avg_path=12.97 | valid_steps=11.97
[2025-11-17 20:25:30,573][INFO] Iter   3750 | loss=0.1479 | td_err=0.1291 | kl=1.3805 | temp=0.188 | eps=0.006 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.353 | avg_path=13.03 | valid_steps=12.03
[2025-11-17 20:25:45,398][INFO] Iter   3800 | loss=0.0668 | td_err=0.0679 | kl=1.6349 | temp=0.190 | eps=0.005 | success=0.219 | hit=0.219 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.228 | avg_path=13.75 | valid_steps=12.75
[2025-11-17 20:26:00,257][INFO] Iter   3850 | loss=0.0674 | td_err=0.0790 | kl=1.3876 | temp=0.193 | eps=0.004 | success=0.406 | hit=0.406 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.397 | avg_path=13.38 | valid_steps=12.38
[2025-11-17 20:26:15,056][INFO] Iter   3900 | loss=0.0757 | td_err=0.0817 | kl=1.4416 | temp=0.195 | eps=0.003 | success=0.281 | hit=0.281 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.506 | avg_path=14.28 | valid_steps=13.28
[2025-11-17 20:26:29,949][INFO] Iter   3950 | loss=0.0517 | td_err=0.0637 | kl=1.2664 | temp=0.198 | eps=0.001 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.344 | avg_path=12.53 | valid_steps=11.53
[2025-11-17 20:26:44,599][INFO] Iter   4000 | loss=0.0634 | td_err=0.0728 | kl=1.3483 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.322 | avg_path=13.12 | valid_steps=12.12
[2025-11-17 20:26:52,488][INFO] ---- Evaluation at iter 4000 ----
[2025-11-17 20:26:52,488][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 20:26:52,488][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 20:26:52,488][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 20:26:52,488][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 20:26:52,492][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251117_200857/ckpt_ql_4000.pt
[2025-11-17 20:27:07,220][INFO] Iter   4050 | loss=0.0639 | td_err=0.0704 | kl=1.4140 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.844 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.194 | avg_path=12.56 | valid_steps=11.56
[2025-11-17 20:27:22,066][INFO] Iter   4100 | loss=0.0556 | td_err=0.0739 | kl=1.3749 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.781 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.228 | avg_path=12.72 | valid_steps=11.72
[2025-11-17 20:27:36,803][INFO] Iter   4150 | loss=0.0637 | td_err=0.0720 | kl=1.2385 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.844 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.325 | avg_path=13.00 | valid_steps=12.00
[2025-11-17 20:27:51,558][INFO] Iter   4200 | loss=0.0516 | td_err=0.0682 | kl=1.2070 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.469 | avg_path=13.06 | valid_steps=12.06
[2025-11-17 20:28:06,212][INFO] Iter   4250 | loss=0.0479 | td_err=0.0677 | kl=1.2117 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.284 | avg_path=12.84 | valid_steps=11.84
[2025-11-17 20:28:20,901][INFO] Iter   4300 | loss=0.0493 | td_err=0.0577 | kl=1.2959 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.219 | avg_path=12.41 | valid_steps=11.41
[2025-11-17 20:28:36,127][INFO] Iter   4350 | loss=0.0444 | td_err=0.0587 | kl=1.1693 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.459 | avg_path=13.09 | valid_steps=12.09
[2025-11-17 20:28:50,742][INFO] Iter   4400 | loss=0.0605 | td_err=0.0685 | kl=1.3384 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.844 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.559 | avg_path=14.09 | valid_steps=13.09
[2025-11-17 20:29:05,692][INFO] Iter   4450 | loss=0.0428 | td_err=0.0524 | kl=1.1705 | temp=0.200 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.303 | avg_path=12.28 | valid_steps=11.28
[2025-11-17 20:29:20,513][INFO] Iter   4500 | loss=0.0543 | td_err=0.0700 | kl=1.1995 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.219 | avg_path=12.62 | valid_steps=11.62
[2025-11-17 20:29:35,049][INFO] Iter   4550 | loss=0.0439 | td_err=0.0535 | kl=1.2293 | temp=0.200 | eps=0.000 | success=0.312 | hit=0.312 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.534 | avg_path=14.22 | valid_steps=13.22
[2025-11-17 20:29:49,869][INFO] Iter   4600 | loss=0.0488 | td_err=0.0585 | kl=1.1771 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.394 | avg_path=12.97 | valid_steps=11.97
[2025-11-17 20:30:04,820][INFO] Iter   4650 | loss=0.0671 | td_err=0.0697 | kl=1.1900 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.272 | avg_path=12.94 | valid_steps=11.94
[2025-11-17 20:30:19,959][INFO] Iter   4700 | loss=0.0407 | td_err=0.0556 | kl=1.1286 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.397 | avg_path=12.84 | valid_steps=11.84
[2025-11-17 20:30:34,898][INFO] Iter   4750 | loss=0.0535 | td_err=0.0672 | kl=1.1888 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.403 | avg_path=13.38 | valid_steps=12.38
[2025-11-17 20:30:49,708][INFO] Iter   4800 | loss=0.0414 | td_err=0.0507 | kl=1.1790 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.456 | avg_path=13.38 | valid_steps=12.38
[2025-11-17 20:31:04,451][INFO] Iter   4850 | loss=0.0413 | td_err=0.0562 | kl=1.1506 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.284 | avg_path=13.00 | valid_steps=12.00
[2025-11-17 20:31:19,228][INFO] Iter   4900 | loss=0.0417 | td_err=0.0495 | kl=1.2472 | temp=0.200 | eps=0.000 | success=0.312 | hit=0.312 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.291 | avg_path=13.47 | valid_steps=12.47
[2025-11-17 20:31:33,671][INFO] Iter   4950 | loss=0.0668 | td_err=0.0806 | kl=1.1733 | temp=0.200 | eps=0.000 | success=0.312 | hit=0.312 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.412 | avg_path=13.88 | valid_steps=12.88
[2025-11-17 20:31:48,795][INFO] Iter   5000 | loss=0.0385 | td_err=0.0501 | kl=1.0505 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.522 | avg_path=13.12 | valid_steps=12.12
[2025-11-17 20:31:56,587][INFO] ---- Evaluation at iter 5000 ----
[2025-11-17 20:31:56,587][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 20:31:56,588][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 20:31:56,588][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 20:31:56,588][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 20:32:11,623][INFO] Iter   5050 | loss=0.0351 | td_err=0.0521 | kl=1.0363 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.600 | avg_path=13.88 | valid_steps=12.88
[2025-11-17 20:32:26,655][INFO] Iter   5100 | loss=0.0392 | td_err=0.0510 | kl=1.0975 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.612 | avg_path=14.19 | valid_steps=13.19
[2025-11-17 20:32:41,431][INFO] Iter   5150 | loss=0.0383 | td_err=0.0558 | kl=1.1348 | temp=0.200 | eps=0.000 | success=0.312 | hit=0.312 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.650 | avg_path=14.62 | valid_steps=13.62
[2025-11-17 20:32:56,564][INFO] Iter   5200 | loss=0.0501 | td_err=0.0531 | kl=1.1446 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.444 | avg_path=13.62 | valid_steps=12.62
[2025-11-17 20:33:11,504][INFO] Iter   5250 | loss=0.0347 | td_err=0.0455 | kl=1.0871 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.606 | avg_path=14.03 | valid_steps=13.03
[2025-11-17 20:33:26,663][INFO] Iter   5300 | loss=0.0356 | td_err=0.0460 | kl=1.1169 | temp=0.200 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.344 | avg_path=13.47 | valid_steps=12.47
[2025-11-17 20:33:41,761][INFO] Iter   5350 | loss=0.0314 | td_err=0.0445 | kl=0.9908 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.472 | avg_path=12.94 | valid_steps=11.94
[2025-11-17 20:33:56,896][INFO] Iter   5400 | loss=0.0350 | td_err=0.0470 | kl=1.1081 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.500 | avg_path=13.81 | valid_steps=12.81
[2025-11-17 20:34:11,643][INFO] Iter   5450 | loss=0.0389 | td_err=0.0498 | kl=1.0631 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.087 | avg_path=12.50 | valid_steps=11.50
[2025-11-17 20:34:26,698][INFO] Iter   5500 | loss=0.0387 | td_err=0.0505 | kl=1.1120 | temp=0.200 | eps=0.000 | success=0.312 | hit=0.312 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.259 | avg_path=13.34 | valid_steps=12.34
[2025-11-17 20:34:41,536][INFO] Iter   5550 | loss=0.0325 | td_err=0.0495 | kl=1.0351 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.269 | avg_path=12.75 | valid_steps=11.75
[2025-11-17 20:34:56,637][INFO] Iter   5600 | loss=0.0305 | td_err=0.0402 | kl=1.0114 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.300 | avg_path=13.03 | valid_steps=12.03
[2025-11-17 20:35:11,524][INFO] Iter   5650 | loss=0.0291 | td_err=0.0453 | kl=0.9618 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.431 | avg_path=12.84 | valid_steps=11.84
[2025-11-17 20:35:26,043][INFO] Iter   5700 | loss=0.0548 | td_err=0.0568 | kl=1.0688 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.844 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.081 | avg_path=12.03 | valid_steps=11.03
[2025-11-17 20:35:40,663][INFO] Iter   5750 | loss=0.0347 | td_err=0.0488 | kl=1.0216 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.575 | avg_path=14.06 | valid_steps=13.06
[2025-11-17 20:35:55,699][INFO] Iter   5800 | loss=0.0318 | td_err=0.0475 | kl=1.0288 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.278 | avg_path=13.09 | valid_steps=12.09
[2025-11-17 20:36:10,384][INFO] Iter   5850 | loss=0.0320 | td_err=0.0438 | kl=1.0699 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.431 | avg_path=13.62 | valid_steps=12.62
[2025-11-17 20:36:25,650][INFO] Iter   5900 | loss=0.0321 | td_err=0.0497 | kl=0.9486 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.569 | avg_path=14.06 | valid_steps=13.06
[2025-11-17 20:36:40,592][INFO] Iter   5950 | loss=0.0295 | td_err=0.0396 | kl=1.0573 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.447 | avg_path=13.66 | valid_steps=12.66
[2025-11-17 20:36:55,248][INFO] Iter   6000 | loss=0.0345 | td_err=0.0496 | kl=0.9558 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.812 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.103 | avg_path=11.81 | valid_steps=10.81
[2025-11-17 20:37:03,049][INFO] ---- Evaluation at iter 6000 ----
[2025-11-17 20:37:03,050][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 20:37:03,050][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 20:37:03,050][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 20:37:03,050][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 20:37:03,054][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251117_200857/ckpt_ql_6000.pt
[2025-11-17 20:37:17,862][INFO] Iter   6050 | loss=0.0258 | td_err=0.0436 | kl=0.8986 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.556 | avg_path=13.38 | valid_steps=12.38
[2025-11-17 20:37:32,752][INFO] Iter   6100 | loss=0.0297 | td_err=0.0462 | kl=1.0097 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.428 | avg_path=13.44 | valid_steps=12.44
[2025-11-17 20:37:47,540][INFO] Iter   6150 | loss=0.0316 | td_err=0.0473 | kl=0.9307 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.341 | avg_path=12.72 | valid_steps=11.72
[2025-11-17 20:38:03,007][INFO] Iter   6200 | loss=0.0292 | td_err=0.0464 | kl=0.9973 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.466 | avg_path=13.72 | valid_steps=12.72
[2025-11-17 20:38:18,420][INFO] Iter   6250 | loss=0.0260 | td_err=0.0434 | kl=0.9446 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.491 | avg_path=13.38 | valid_steps=12.38
[2025-11-17 20:38:33,973][INFO] Iter   6300 | loss=0.0291 | td_err=0.0430 | kl=0.9824 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.506 | avg_path=13.81 | valid_steps=12.81
[2025-11-17 20:38:49,501][INFO] Iter   6350 | loss=0.0984 | td_err=0.0726 | kl=1.0286 | temp=0.200 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.462 | avg_path=13.84 | valid_steps=12.84
[2025-11-17 20:39:04,988][INFO] Iter   6400 | loss=0.0258 | td_err=0.0406 | kl=0.9716 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.812 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.356 | avg_path=13.12 | valid_steps=12.12
[2025-11-17 20:39:20,062][INFO] Iter   6450 | loss=0.0268 | td_err=0.0363 | kl=1.0547 | temp=0.200 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.178 | avg_path=12.94 | valid_steps=11.94
[2025-11-17 20:39:34,739][INFO] Iter   6500 | loss=0.0247 | td_err=0.0396 | kl=0.9061 | temp=0.200 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.844 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.287 | avg_path=12.25 | valid_steps=11.25
[2025-11-17 20:39:49,473][INFO] Iter   6550 | loss=0.0262 | td_err=0.0406 | kl=0.9971 | temp=0.200 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.428 | avg_path=13.75 | valid_steps=12.75
[2025-11-17 20:40:04,328][INFO] Iter   6600 | loss=0.0289 | td_err=0.0436 | kl=1.0715 | temp=0.200 | eps=0.000 | success=0.344 | hit=0.344 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.356 | avg_path=13.47 | valid_steps=12.47
[2025-11-17 20:40:19,369][INFO] Iter   6650 | loss=0.0336 | td_err=0.0518 | kl=0.8831 | temp=0.200 | eps=0.000 | success=0.562 | hit=0.562 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.469 | avg_path=12.75 | valid_steps=11.75
[2025-11-17 20:40:34,056][INFO] Iter   6700 | loss=0.0277 | td_err=0.0434 | kl=0.9813 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.637 | avg_path=14.09 | valid_steps=13.09
[2025-11-17 20:40:48,377][INFO] Iter   6750 | loss=0.0233 | td_err=0.0361 | kl=0.9507 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.469 | avg_path=13.59 | valid_steps=12.59
[2025-11-17 20:41:03,087][INFO] Iter   6800 | loss=0.0348 | td_err=0.0564 | kl=1.0125 | temp=0.200 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.559 | avg_path=14.19 | valid_steps=13.19
[2025-11-17 20:41:18,036][INFO] Iter   6850 | loss=0.0295 | td_err=0.0475 | kl=0.9629 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.387 | avg_path=13.12 | valid_steps=12.12
[2025-11-17 20:41:32,851][INFO] Iter   6900 | loss=0.0583 | td_err=0.0543 | kl=0.9085 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.406 | avg_path=12.88 | valid_steps=11.88
[2025-11-17 20:41:47,719][INFO] Iter   6950 | loss=0.0267 | td_err=0.0471 | kl=0.8649 | temp=0.200 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.316 | avg_path=12.28 | valid_steps=11.28
[2025-11-17 20:42:02,343][INFO] Iter   7000 | loss=0.0212 | td_err=0.0449 | kl=0.8239 | temp=0.200 | eps=0.000 | success=0.594 | hit=0.594 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.553 | avg_path=12.94 | valid_steps=11.94
[2025-11-17 20:42:09,942][INFO] ---- Evaluation at iter 7000 ----
[2025-11-17 20:42:09,943][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 20:42:09,943][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 20:42:09,943][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 20:42:09,943][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 20:42:25,162][INFO] Iter   7050 | loss=0.0287 | td_err=0.0552 | kl=0.9878 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.512 | avg_path=13.72 | valid_steps=12.72
[2025-11-17 20:42:40,087][INFO] Iter   7100 | loss=0.0195 | td_err=0.0374 | kl=0.8303 | temp=0.200 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.406 | avg_path=12.56 | valid_steps=11.56
[2025-11-17 20:42:54,883][INFO] Iter   7150 | loss=0.0233 | td_err=0.0379 | kl=0.9711 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.428 | avg_path=13.59 | valid_steps=12.59
[2025-11-17 20:43:09,458][INFO] Iter   7200 | loss=0.0226 | td_err=0.0415 | kl=0.9513 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.812 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.206 | avg_path=12.47 | valid_steps=11.47
[2025-11-17 20:43:24,093][INFO] Iter   7250 | loss=0.0322 | td_err=0.0501 | kl=0.8274 | temp=0.200 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.384 | avg_path=12.53 | valid_steps=11.53
[2025-11-17 20:43:38,875][INFO] Iter   7300 | loss=0.0228 | td_err=0.0400 | kl=0.9774 | temp=0.200 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.381 | avg_path=13.59 | valid_steps=12.59
[2025-11-17 20:43:53,705][INFO] Iter   7350 | loss=0.0237 | td_err=0.0448 | kl=0.9186 | temp=0.200 | eps=0.000 | success=0.312 | hit=0.312 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.562 | avg_path=14.31 | valid_steps=13.31
[2025-11-17 20:44:09,045][INFO] Iter   7400 | loss=0.0204 | td_err=0.0398 | kl=0.9032 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.844 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.325 | avg_path=12.69 | valid_steps=11.69
[2025-11-17 20:44:24,557][INFO] Iter   7450 | loss=0.0211 | td_err=0.0388 | kl=0.9599 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.537 | avg_path=13.78 | valid_steps=12.78
[2025-11-17 20:44:40,339][INFO] Iter   7500 | loss=0.0268 | td_err=0.0451 | kl=0.8671 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.303 | avg_path=12.91 | valid_steps=11.91
[2025-11-17 20:44:55,455][INFO] Iter   7550 | loss=0.0186 | td_err=0.0372 | kl=0.8622 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.428 | avg_path=13.12 | valid_steps=12.12
[2025-11-17 20:45:11,059][INFO] Iter   7600 | loss=0.0191 | td_err=0.0386 | kl=0.8994 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.241 | avg_path=12.34 | valid_steps=11.34
[2025-11-17 20:45:26,390][INFO] Iter   7650 | loss=0.0183 | td_err=0.0342 | kl=0.8818 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.191 | avg_path=12.69 | valid_steps=11.69
[2025-11-17 20:45:41,688][INFO] Iter   7700 | loss=0.0179 | td_err=0.0384 | kl=0.8390 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.400 | avg_path=13.34 | valid_steps=12.34
[2025-11-17 20:45:57,019][INFO] Iter   7750 | loss=0.0187 | td_err=0.0391 | kl=0.8582 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.341 | avg_path=12.50 | valid_steps=11.50
[2025-11-17 20:46:12,149][INFO] Iter   7800 | loss=0.0194 | td_err=0.0375 | kl=0.9308 | temp=0.200 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.509 | avg_path=14.00 | valid_steps=13.00
[2025-11-17 20:46:27,503][INFO] Iter   7850 | loss=0.0237 | td_err=0.0465 | kl=0.8600 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.422 | avg_path=12.97 | valid_steps=11.97
[2025-11-17 20:46:42,825][INFO] Iter   7900 | loss=0.0201 | td_err=0.0378 | kl=0.9783 | temp=0.200 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.253 | avg_path=13.19 | valid_steps=12.19
[2025-11-17 20:46:58,055][INFO] Iter   7950 | loss=0.0227 | td_err=0.0461 | kl=0.8750 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.259 | avg_path=12.25 | valid_steps=11.25
[2025-11-17 20:47:12,815][INFO] Iter   8000 | loss=0.0338 | td_err=0.0440 | kl=0.8104 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.156 | avg_path=12.22 | valid_steps=11.22
[2025-11-17 20:47:20,734][INFO] ---- Evaluation at iter 8000 ----
[2025-11-17 20:47:20,734][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 20:47:20,734][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 20:47:20,734][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 20:47:20,734][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 20:47:20,738][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251117_200857/ckpt_ql_8000.pt
[2025-11-17 20:47:35,226][INFO] Iter   8050 | loss=0.0184 | td_err=0.0370 | kl=0.9454 | temp=0.200 | eps=0.000 | success=0.312 | hit=0.312 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.347 | avg_path=13.66 | valid_steps=12.66
[2025-11-17 20:47:49,792][INFO] Iter   8100 | loss=0.0243 | td_err=0.0415 | kl=0.9152 | temp=0.200 | eps=0.000 | success=0.312 | hit=0.312 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.566 | avg_path=14.34 | valid_steps=13.34
[2025-11-17 20:48:04,412][INFO] Iter   8150 | loss=0.0180 | td_err=0.0354 | kl=0.9302 | temp=0.200 | eps=0.000 | success=0.312 | hit=0.312 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.550 | avg_path=14.31 | valid_steps=13.31
[2025-11-17 20:48:19,120][INFO] Iter   8200 | loss=0.0171 | td_err=0.0358 | kl=0.9248 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.319 | avg_path=12.94 | valid_steps=11.94
[2025-11-17 20:48:34,461][INFO] Iter   8250 | loss=0.0176 | td_err=0.0385 | kl=0.9093 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.200 | avg_path=12.50 | valid_steps=11.50
[2025-11-17 20:48:49,400][INFO] Iter   8300 | loss=0.0157 | td_err=0.0388 | kl=0.8553 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.606 | avg_path=13.88 | valid_steps=12.88
[2025-11-17 20:49:04,903][INFO] Iter   8350 | loss=0.0207 | td_err=0.0435 | kl=0.9586 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.481 | avg_path=13.75 | valid_steps=12.75
[2025-11-17 20:49:19,669][INFO] Iter   8400 | loss=0.0165 | td_err=0.0386 | kl=0.8644 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.812 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.169 | avg_path=12.34 | valid_steps=11.34
[2025-11-17 20:49:35,100][INFO] Iter   8450 | loss=0.0147 | td_err=0.0341 | kl=0.8419 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.356 | avg_path=12.75 | valid_steps=11.75
[2025-11-17 20:49:49,810][INFO] Iter   8500 | loss=0.0143 | td_err=0.0335 | kl=0.8112 | temp=0.200 | eps=0.000 | success=0.594 | hit=0.594 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.384 | avg_path=12.38 | valid_steps=11.38
[2025-11-17 20:50:05,029][INFO] Iter   8550 | loss=0.0164 | td_err=0.0431 | kl=0.7950 | temp=0.200 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.253 | avg_path=12.09 | valid_steps=11.09
[2025-11-17 20:50:20,678][INFO] Iter   8600 | loss=0.0132 | td_err=0.0340 | kl=0.7664 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.559 | avg_path=13.25 | valid_steps=12.25
[2025-11-17 20:50:36,031][INFO] Iter   8650 | loss=0.0142 | td_err=0.0339 | kl=0.8594 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.319 | avg_path=13.25 | valid_steps=12.25
[2025-11-17 20:50:51,348][INFO] Iter   8700 | loss=0.0166 | td_err=0.0411 | kl=0.9213 | temp=0.200 | eps=0.000 | success=0.281 | hit=0.281 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.616 | avg_path=14.69 | valid_steps=13.69
[2025-11-17 20:51:06,114][INFO] Iter   8750 | loss=0.0135 | td_err=0.0374 | kl=0.7589 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.341 | avg_path=12.72 | valid_steps=11.72
[2025-11-17 20:51:20,998][INFO] Iter   8800 | loss=0.0152 | td_err=0.0384 | kl=0.8922 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.531 | avg_path=13.78 | valid_steps=12.78
[2025-11-17 20:51:35,546][INFO] Iter   8850 | loss=0.0145 | td_err=0.0370 | kl=0.8360 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.406 | avg_path=13.34 | valid_steps=12.34
[2025-11-17 20:51:50,267][INFO] Iter   8900 | loss=0.0273 | td_err=0.0497 | kl=0.7347 | temp=0.200 | eps=0.000 | success=0.594 | hit=0.594 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.150 | avg_path=11.59 | valid_steps=10.59
[2025-11-17 20:52:05,114][INFO] Iter   8950 | loss=0.0132 | td_err=0.0324 | kl=0.8697 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.484 | avg_path=13.62 | valid_steps=12.62
[2025-11-17 20:52:19,852][INFO] Iter   9000 | loss=0.0129 | td_err=0.0328 | kl=0.8444 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.312 | avg_path=12.78 | valid_steps=11.78
[2025-11-17 20:52:27,857][INFO] ---- Evaluation at iter 9000 ----
[2025-11-17 20:52:27,858][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 20:52:27,858][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 20:52:27,858][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 20:52:27,858][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 20:52:42,367][INFO] Iter   9050 | loss=0.0206 | td_err=0.0432 | kl=0.8966 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.300 | avg_path=13.12 | valid_steps=12.12
[2025-11-17 20:52:57,097][INFO] Iter   9100 | loss=0.0114 | td_err=0.0316 | kl=0.7836 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.444 | avg_path=13.47 | valid_steps=12.47
[2025-11-17 20:53:11,904][INFO] Iter   9150 | loss=0.0125 | td_err=0.0390 | kl=0.7608 | temp=0.200 | eps=0.000 | success=0.594 | hit=0.594 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.647 | avg_path=13.19 | valid_steps=12.19
[2025-11-17 20:53:26,567][INFO] Iter   9200 | loss=0.0139 | td_err=0.0389 | kl=0.8887 | temp=0.200 | eps=0.000 | success=0.312 | hit=0.312 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.306 | avg_path=13.50 | valid_steps=12.50
[2025-11-17 20:53:41,419][INFO] Iter   9250 | loss=0.0125 | td_err=0.0349 | kl=0.8124 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.234 | avg_path=12.50 | valid_steps=11.50
[2025-11-17 20:53:56,055][INFO] Iter   9300 | loss=0.0127 | td_err=0.0366 | kl=0.8834 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.212 | avg_path=12.72 | valid_steps=11.72
[2025-11-17 20:54:10,598][INFO] Iter   9350 | loss=0.0115 | td_err=0.0331 | kl=0.8248 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.316 | avg_path=13.06 | valid_steps=12.06
[2025-11-17 20:54:25,751][INFO] Iter   9400 | loss=0.0105 | td_err=0.0307 | kl=0.8065 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.322 | avg_path=12.66 | valid_steps=11.66
[2025-11-17 20:54:40,608][INFO] Iter   9450 | loss=0.0103 | td_err=0.0314 | kl=0.7945 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.562 | avg_path=13.53 | valid_steps=12.53
[2025-11-17 20:54:55,174][INFO] Iter   9500 | loss=0.0114 | td_err=0.0332 | kl=0.8636 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.534 | avg_path=13.91 | valid_steps=12.91
[2025-11-17 20:55:10,108][INFO] Iter   9550 | loss=0.0099 | td_err=0.0305 | kl=0.7973 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.600 | avg_path=13.97 | valid_steps=12.97
[2025-11-17 20:55:24,738][INFO] Iter   9600 | loss=0.0103 | td_err=0.0322 | kl=0.8056 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.278 | avg_path=12.31 | valid_steps=11.31
[2025-11-17 20:55:39,454][INFO] Iter   9650 | loss=0.0086 | td_err=0.0290 | kl=0.7115 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.547 | avg_path=13.19 | valid_steps=12.19
[2025-11-17 20:55:54,129][INFO] Iter   9700 | loss=0.0103 | td_err=0.0318 | kl=0.8544 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.728 | avg_path=14.28 | valid_steps=13.28
[2025-11-17 20:56:08,958][INFO] Iter   9750 | loss=0.0094 | td_err=0.0338 | kl=0.7758 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.266 | avg_path=12.31 | valid_steps=11.31
[2025-11-17 20:56:23,625][INFO] Iter   9800 | loss=0.0092 | td_err=0.0298 | kl=0.7960 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.416 | avg_path=12.91 | valid_steps=11.91
[2025-11-17 20:56:38,374][INFO] Iter   9850 | loss=0.0507 | td_err=0.0482 | kl=0.8415 | temp=0.200 | eps=0.000 | success=0.281 | hit=0.281 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.637 | avg_path=14.72 | valid_steps=13.72
[2025-11-17 20:56:52,928][INFO] Iter   9900 | loss=0.0109 | td_err=0.0363 | kl=0.8081 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.844 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.194 | avg_path=12.41 | valid_steps=11.41
[2025-11-17 20:57:07,601][INFO] Iter   9950 | loss=0.0080 | td_err=0.0264 | kl=0.7798 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.541 | avg_path=13.81 | valid_steps=12.81
[2025-11-17 20:57:22,468][INFO] Iter  10000 | loss=0.0096 | td_err=0.0322 | kl=0.6738 | temp=0.200 | eps=0.000 | success=0.656 | hit=0.656 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.122 | avg_path=11.19 | valid_steps=10.19
[2025-11-17 20:57:30,406][INFO] ---- Evaluation at iter 10000 ----
[2025-11-17 20:57:30,406][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 20:57:30,406][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 20:57:30,406][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 20:57:30,406][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 20:57:30,410][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251117_200857/ckpt_ql_10000.pt
[2025-11-17 20:57:45,084][INFO] Iter  10050 | loss=0.0177 | td_err=0.0337 | kl=0.8036 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.384 | avg_path=13.25 | valid_steps=12.25
[2025-11-17 20:57:59,706][INFO] Iter  10100 | loss=0.0077 | td_err=0.0282 | kl=0.7991 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.431 | avg_path=13.00 | valid_steps=12.00
[2025-11-17 20:58:14,480][INFO] Iter  10150 | loss=0.0077 | td_err=0.0308 | kl=0.7665 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.197 | avg_path=12.53 | valid_steps=11.53
[2025-11-17 20:58:29,140][INFO] Iter  10200 | loss=0.0081 | td_err=0.0294 | kl=0.8472 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.297 | avg_path=13.00 | valid_steps=12.00
[2025-11-17 20:58:43,921][INFO] Iter  10250 | loss=0.0073 | td_err=0.0308 | kl=0.7553 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.416 | avg_path=13.12 | valid_steps=12.12
[2025-11-17 20:58:58,415][INFO] Iter  10300 | loss=0.0077 | td_err=0.0298 | kl=0.8555 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.528 | avg_path=13.44 | valid_steps=12.44
[2025-11-17 20:59:13,169][INFO] Iter  10350 | loss=0.0069 | td_err=0.0270 | kl=0.8099 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.359 | avg_path=13.03 | valid_steps=12.03
[2025-11-17 20:59:27,696][INFO] Iter  10400 | loss=0.0067 | td_err=0.0305 | kl=0.7539 | temp=0.200 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.334 | avg_path=12.34 | valid_steps=11.34
[2025-11-17 20:59:42,253][INFO] Iter  10450 | loss=0.0070 | td_err=0.0293 | kl=0.8099 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.559 | avg_path=13.88 | valid_steps=12.88
[2025-11-17 20:59:56,984][INFO] Iter  10500 | loss=0.0069 | td_err=0.0312 | kl=0.8161 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.622 | avg_path=14.06 | valid_steps=13.06
[2025-11-17 21:00:11,613][INFO] Iter  10550 | loss=0.0059 | td_err=0.0262 | kl=0.7297 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.144 | avg_path=11.91 | valid_steps=10.91
[2025-11-17 21:00:26,499][INFO] Iter  10600 | loss=0.0059 | td_err=0.0303 | kl=0.7006 | temp=0.200 | eps=0.000 | success=0.656 | hit=0.656 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.531 | avg_path=12.53 | valid_steps=11.53
[2025-11-17 21:00:41,347][INFO] Iter  10650 | loss=0.0056 | td_err=0.0263 | kl=0.7701 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.581 | avg_path=13.75 | valid_steps=12.75
[2025-11-17 21:00:56,111][INFO] Iter  10700 | loss=0.0059 | td_err=0.0289 | kl=0.8126 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.394 | avg_path=13.03 | valid_steps=12.03
[2025-11-17 21:01:10,515][INFO] Iter  10750 | loss=0.0052 | td_err=0.0252 | kl=0.7693 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.256 | avg_path=12.44 | valid_steps=11.44
[2025-11-17 21:01:25,141][INFO] Iter  10800 | loss=0.0056 | td_err=0.0282 | kl=0.7438 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.378 | avg_path=12.84 | valid_steps=11.84
[2025-11-17 21:01:40,091][INFO] Iter  10850 | loss=0.0054 | td_err=0.0290 | kl=0.8024 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.169 | avg_path=12.12 | valid_steps=11.12
[2025-11-17 21:01:55,135][INFO] Iter  10900 | loss=0.0059 | td_err=0.0287 | kl=0.8919 | temp=0.200 | eps=0.000 | success=0.312 | hit=0.312 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.400 | avg_path=13.81 | valid_steps=12.81
[2025-11-17 21:02:10,383][INFO] Iter  10950 | loss=0.0042 | td_err=0.0234 | kl=0.7432 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.256 | avg_path=12.28 | valid_steps=11.28
[2025-11-17 21:02:25,268][INFO] Iter  11000 | loss=0.0048 | td_err=0.0284 | kl=0.7958 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.547 | avg_path=13.66 | valid_steps=12.66
[2025-11-17 21:02:33,242][INFO] ---- Evaluation at iter 11000 ----
[2025-11-17 21:02:33,242][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 21:02:33,242][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 21:02:33,242][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 21:02:33,242][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 21:02:47,961][INFO] Iter  11050 | loss=0.0054 | td_err=0.0306 | kl=0.8416 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.519 | avg_path=13.56 | valid_steps=12.56
[2025-11-17 21:03:02,681][INFO] Iter  11100 | loss=0.0054 | td_err=0.0325 | kl=0.7562 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.547 | avg_path=13.19 | valid_steps=12.19
[2025-11-17 21:03:17,310][INFO] Iter  11150 | loss=0.0047 | td_err=0.0293 | kl=0.8625 | temp=0.200 | eps=0.000 | success=0.344 | hit=0.344 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.647 | avg_path=14.44 | valid_steps=13.44
[2025-11-17 21:03:32,276][INFO] Iter  11200 | loss=0.0041 | td_err=0.0261 | kl=0.8704 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.391 | avg_path=13.47 | valid_steps=12.47
[2025-11-17 21:03:46,932][INFO] Iter  11250 | loss=0.0030 | td_err=0.0228 | kl=0.6595 | temp=0.200 | eps=0.000 | success=0.625 | hit=0.625 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.106 | avg_path=11.25 | valid_steps=10.25
[2025-11-17 21:04:01,792][INFO] Iter  11300 | loss=0.0038 | td_err=0.0264 | kl=0.8300 | temp=0.200 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.369 | avg_path=13.53 | valid_steps=12.53
[2025-11-17 21:04:16,544][INFO] Iter  11350 | loss=0.0039 | td_err=0.0289 | kl=0.8092 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.606 | avg_path=13.88 | valid_steps=12.88
[2025-11-17 21:04:31,149][INFO] Iter  11400 | loss=0.0033 | td_err=0.0276 | kl=0.7331 | temp=0.200 | eps=0.000 | success=0.625 | hit=0.625 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.341 | avg_path=12.03 | valid_steps=11.03
[2025-11-17 21:04:46,128][INFO] Iter  11450 | loss=0.0031 | td_err=0.0276 | kl=0.7639 | temp=0.200 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.341 | avg_path=12.41 | valid_steps=11.41
[2025-11-17 21:05:00,763][INFO] Iter  11500 | loss=0.0051 | td_err=0.0313 | kl=0.8508 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.509 | avg_path=13.53 | valid_steps=12.53
[2025-11-17 21:05:15,309][INFO] Iter  11550 | loss=0.0027 | td_err=0.0262 | kl=0.7842 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.362 | avg_path=12.75 | valid_steps=11.75
[2025-11-17 21:05:29,889][INFO] Iter  11600 | loss=0.0034 | td_err=0.0301 | kl=0.9070 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.591 | avg_path=14.09 | valid_steps=13.09
[2025-11-17 21:05:44,475][INFO] Iter  11650 | loss=0.0024 | td_err=0.0252 | kl=0.7883 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.506 | avg_path=13.56 | valid_steps=12.56
[2025-11-17 21:05:59,100][INFO] Iter  11700 | loss=0.0021 | td_err=0.0248 | kl=0.8411 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.403 | avg_path=13.47 | valid_steps=12.47
[2025-11-17 21:06:13,923][INFO] Iter  11750 | loss=0.0021 | td_err=0.0259 | kl=0.7824 | temp=0.200 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.359 | avg_path=12.41 | valid_steps=11.41
[2025-11-17 21:06:28,954][INFO] Iter  11800 | loss=0.0021 | td_err=0.0274 | kl=0.8033 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.631 | avg_path=13.62 | valid_steps=12.62
[2025-11-17 21:06:43,897][INFO] Iter  11850 | loss=0.0018 | td_err=0.0240 | kl=0.8870 | temp=0.200 | eps=0.000 | success=0.344 | hit=0.344 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.619 | avg_path=14.34 | valid_steps=13.34
[2025-11-17 21:06:58,937][INFO] Iter  11900 | loss=0.0016 | td_err=0.0243 | kl=0.8945 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.416 | avg_path=13.53 | valid_steps=12.53
[2025-11-17 21:07:13,708][INFO] Iter  11950 | loss=0.0014 | td_err=0.0229 | kl=0.8952 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.428 | avg_path=13.44 | valid_steps=12.44
[2025-11-17 21:07:28,521][INFO] Iter  12000 | loss=0.0013 | td_err=0.0254 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.403 | avg_path=13.22 | valid_steps=12.22
[2025-11-17 21:07:36,773][INFO] ---- Evaluation at iter 12000 ----
[2025-11-17 21:07:36,777][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 21:07:36,777][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 21:07:36,777][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 21:07:36,777][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 21:07:36,781][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251117_200857/ckpt_ql_12000.pt
[2025-11-17 21:07:50,498][INFO] Iter  12050 | loss=0.0012 | td_err=0.0253 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.491 | avg_path=13.16 | valid_steps=12.16
[2025-11-17 21:08:04,738][INFO] Iter  12100 | loss=0.0020 | td_err=0.0283 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.531 | avg_path=13.31 | valid_steps=12.31
[2025-11-17 21:08:19,374][INFO] Iter  12150 | loss=0.0016 | td_err=0.0271 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.556 | avg_path=13.44 | valid_steps=12.44
[2025-11-17 21:08:33,219][INFO] Iter  12200 | loss=0.0012 | td_err=0.0242 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.344 | avg_path=13.16 | valid_steps=12.16
[2025-11-17 21:08:47,105][INFO] Iter  12250 | loss=0.0013 | td_err=0.0248 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.650 | avg_path=14.31 | valid_steps=13.31
[2025-11-17 21:09:00,937][INFO] Iter  12300 | loss=0.0020 | td_err=0.0263 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.266 | avg_path=12.78 | valid_steps=11.78
[2025-11-17 21:09:14,863][INFO] Iter  12350 | loss=0.0013 | td_err=0.0253 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.653 | avg_path=14.34 | valid_steps=13.34
[2025-11-17 21:09:28,533][INFO] Iter  12400 | loss=0.0010 | td_err=0.0236 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.319 | avg_path=12.62 | valid_steps=11.62
[2025-11-17 21:09:42,223][INFO] Iter  12450 | loss=0.0008 | td_err=0.0202 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.656 | hit=0.656 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.438 | avg_path=12.22 | valid_steps=11.22
[2025-11-17 21:09:55,842][INFO] Iter  12500 | loss=0.0011 | td_err=0.0235 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.487 | avg_path=13.19 | valid_steps=12.19
[2025-11-17 21:10:09,998][INFO] Iter  12550 | loss=0.0008 | td_err=0.0221 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.581 | avg_path=13.44 | valid_steps=12.44
[2025-11-17 21:10:23,794][INFO] Iter  12600 | loss=0.0011 | td_err=0.0218 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.594 | hit=0.594 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.344 | avg_path=12.22 | valid_steps=11.22
[2025-11-17 21:10:37,600][INFO] Iter  12650 | loss=0.0009 | td_err=0.0215 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.625 | hit=0.625 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.344 | avg_path=12.06 | valid_steps=11.06
[2025-11-17 21:10:51,620][INFO] Iter  12700 | loss=0.0010 | td_err=0.0230 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.603 | avg_path=14.31 | valid_steps=13.31
[2025-11-17 21:11:05,566][INFO] Iter  12750 | loss=0.0011 | td_err=0.0238 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.356 | avg_path=13.38 | valid_steps=12.38
[2025-11-17 21:11:19,405][INFO] Iter  12800 | loss=0.0010 | td_err=0.0231 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.569 | avg_path=14.06 | valid_steps=13.06
[2025-11-17 21:11:33,366][INFO] Iter  12850 | loss=0.0009 | td_err=0.0236 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.456 | avg_path=12.75 | valid_steps=11.75
[2025-11-17 21:11:47,017][INFO] Iter  12900 | loss=0.0008 | td_err=0.0206 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.172 | avg_path=12.78 | valid_steps=11.78
[2025-11-17 21:12:00,605][INFO] Iter  12950 | loss=0.0011 | td_err=0.0241 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.312 | hit=0.312 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.631 | avg_path=14.56 | valid_steps=13.56
[2025-11-17 21:12:14,225][INFO] Iter  13000 | loss=0.0009 | td_err=0.0213 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.553 | avg_path=13.56 | valid_steps=12.56
[2025-11-17 21:12:22,132][INFO] ---- Evaluation at iter 13000 ----
[2025-11-17 21:12:22,134][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 21:12:22,134][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 21:12:22,134][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 21:12:22,134][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 21:12:36,074][INFO] Iter  13050 | loss=0.0008 | td_err=0.0212 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.434 | avg_path=13.44 | valid_steps=12.44
[2025-11-17 21:12:49,947][INFO] Iter  13100 | loss=0.0014 | td_err=0.0252 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.656 | hit=0.656 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.625 | avg_path=12.84 | valid_steps=11.84
[2025-11-17 21:13:04,097][INFO] Iter  13150 | loss=0.0008 | td_err=0.0206 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.281 | hit=0.281 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.547 | avg_path=14.44 | valid_steps=13.44
[2025-11-17 21:13:17,793][INFO] Iter  13200 | loss=0.0009 | td_err=0.0190 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.575 | avg_path=14.06 | valid_steps=13.06
[2025-11-17 21:13:31,658][INFO] Iter  13250 | loss=0.0010 | td_err=0.0228 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.412 | avg_path=12.94 | valid_steps=11.94
[2025-11-17 21:13:45,533][INFO] Iter  13300 | loss=0.0020 | td_err=0.0230 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.259 | avg_path=12.72 | valid_steps=11.72
[2025-11-17 21:13:59,380][INFO] Iter  13350 | loss=0.0008 | td_err=0.0202 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.394 | avg_path=13.50 | valid_steps=12.50
[2025-11-17 21:14:13,210][INFO] Iter  13400 | loss=0.0008 | td_err=0.0205 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.312 | hit=0.312 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.522 | avg_path=14.22 | valid_steps=13.22
[2025-11-17 21:14:27,260][INFO] Iter  13450 | loss=0.0008 | td_err=0.0215 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.725 | avg_path=14.09 | valid_steps=13.09
[2025-11-17 21:14:40,927][INFO] Iter  13500 | loss=0.0009 | td_err=0.0205 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.594 | hit=0.594 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.344 | avg_path=12.22 | valid_steps=11.22
[2025-11-17 21:14:55,555][INFO] Iter  13550 | loss=0.0009 | td_err=0.0210 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.456 | avg_path=13.69 | valid_steps=12.69
[2025-11-17 21:15:09,645][INFO] Iter  13600 | loss=0.0007 | td_err=0.0193 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.625 | hit=0.625 | stage2=0.844 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.409 | avg_path=12.34 | valid_steps=11.34
[2025-11-17 21:15:23,514][INFO] Iter  13650 | loss=0.0014 | td_err=0.0230 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.687 | avg_path=14.12 | valid_steps=13.12
[2025-11-17 21:15:37,498][INFO] Iter  13700 | loss=0.0009 | td_err=0.0213 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.475 | avg_path=12.81 | valid_steps=11.81
[2025-11-17 21:15:51,463][INFO] Iter  13750 | loss=0.0008 | td_err=0.0194 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.312 | hit=0.312 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.381 | avg_path=13.75 | valid_steps=12.75
[2025-11-17 21:16:05,159][INFO] Iter  13800 | loss=0.0008 | td_err=0.0201 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.425 | avg_path=13.56 | valid_steps=12.56
[2025-11-17 21:16:18,993][INFO] Iter  13850 | loss=0.0009 | td_err=0.0207 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.594 | hit=0.594 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.478 | avg_path=12.69 | valid_steps=11.69
[2025-11-17 21:16:33,207][INFO] Iter  13900 | loss=0.0005 | td_err=0.0168 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.259 | avg_path=12.25 | valid_steps=11.25
[2025-11-17 21:16:47,218][INFO] Iter  13950 | loss=0.0008 | td_err=0.0204 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.409 | avg_path=13.06 | valid_steps=12.06
[2025-11-17 21:17:00,990][INFO] Iter  14000 | loss=0.0009 | td_err=0.0211 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.556 | avg_path=14.00 | valid_steps=13.00
[2025-11-17 21:17:08,854][INFO] ---- Evaluation at iter 14000 ----
[2025-11-17 21:17:08,856][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 21:17:08,856][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 21:17:08,856][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 21:17:08,856][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 21:17:08,860][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251117_200857/ckpt_ql_14000.pt
[2025-11-17 21:17:22,806][INFO] Iter  14050 | loss=0.0008 | td_err=0.0200 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.266 | avg_path=12.09 | valid_steps=11.09
[2025-11-17 21:17:36,864][INFO] Iter  14100 | loss=0.0007 | td_err=0.0196 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.372 | avg_path=13.09 | valid_steps=12.09
[2025-11-17 21:17:50,411][INFO] Iter  14150 | loss=0.0007 | td_err=0.0187 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.444 | avg_path=13.22 | valid_steps=12.22
[2025-11-17 21:18:04,403][INFO] Iter  14200 | loss=0.0010 | td_err=0.0231 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.844 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.212 | avg_path=12.47 | valid_steps=11.47
[2025-11-17 21:18:18,373][INFO] Iter  14250 | loss=0.0008 | td_err=0.0204 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.294 | avg_path=12.41 | valid_steps=11.41
[2025-11-17 21:18:32,345][INFO] Iter  14300 | loss=0.0006 | td_err=0.0190 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.562 | hit=0.562 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.281 | avg_path=12.12 | valid_steps=11.12
[2025-11-17 21:18:46,256][INFO] Iter  14350 | loss=0.0007 | td_err=0.0180 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.441 | avg_path=12.81 | valid_steps=11.81
[2025-11-17 21:19:00,123][INFO] Iter  14400 | loss=0.0007 | td_err=0.0188 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.409 | avg_path=13.06 | valid_steps=12.06
[2025-11-17 21:19:13,745][INFO] Iter  14450 | loss=0.0006 | td_err=0.0187 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.594 | hit=0.594 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.559 | avg_path=12.94 | valid_steps=11.94
[2025-11-17 21:19:27,595][INFO] Iter  14500 | loss=0.0014 | td_err=0.0204 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.312 | hit=0.312 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.403 | avg_path=13.84 | valid_steps=12.84
[2025-11-17 21:19:41,324][INFO] Iter  14550 | loss=0.0008 | td_err=0.0193 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.312 | hit=0.312 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.322 | avg_path=13.59 | valid_steps=12.59
[2025-11-17 21:19:55,140][INFO] Iter  14600 | loss=0.0007 | td_err=0.0192 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.312 | avg_path=12.72 | valid_steps=11.72
[2025-11-17 21:20:09,097][INFO] Iter  14650 | loss=0.0008 | td_err=0.0184 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.566 | avg_path=13.88 | valid_steps=12.88
[2025-11-17 21:20:22,852][INFO] Iter  14700 | loss=0.0006 | td_err=0.0171 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.397 | avg_path=13.16 | valid_steps=12.16
[2025-11-17 21:20:36,674][INFO] Iter  14750 | loss=0.0006 | td_err=0.0177 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.281 | hit=0.281 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.481 | avg_path=14.22 | valid_steps=13.22
[2025-11-17 21:20:51,014][INFO] Iter  14800 | loss=0.0008 | td_err=0.0203 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.734 | avg_path=14.12 | valid_steps=13.12
[2025-11-17 21:21:05,191][INFO] Iter  14850 | loss=0.0006 | td_err=0.0178 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.181 | avg_path=12.19 | valid_steps=11.19
[2025-11-17 21:21:19,291][INFO] Iter  14900 | loss=0.0006 | td_err=0.0170 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.587 | avg_path=14.12 | valid_steps=13.12
[2025-11-17 21:21:33,418][INFO] Iter  14950 | loss=0.0005 | td_err=0.0159 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.625 | hit=0.625 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.069 | avg_path=11.19 | valid_steps=10.19
[2025-11-17 21:21:47,758][INFO] Iter  15000 | loss=0.0007 | td_err=0.0187 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.450 | avg_path=13.16 | valid_steps=12.16
[2025-11-17 21:21:56,071][INFO] ---- Evaluation at iter 15000 ----
[2025-11-17 21:21:56,074][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 21:21:56,074][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 21:21:56,074][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 21:21:56,074][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 21:22:10,099][INFO] Iter  15050 | loss=0.0006 | td_err=0.0195 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.594 | hit=0.594 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.444 | avg_path=12.53 | valid_steps=11.53
[2025-11-17 21:22:24,586][INFO] Iter  15100 | loss=0.0006 | td_err=0.0182 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.444 | avg_path=13.47 | valid_steps=12.47
[2025-11-17 21:22:38,901][INFO] Iter  15150 | loss=0.0007 | td_err=0.0180 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.391 | avg_path=12.84 | valid_steps=11.84
[2025-11-17 21:22:53,391][INFO] Iter  15200 | loss=0.0007 | td_err=0.0175 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.550 | avg_path=13.53 | valid_steps=12.53
[2025-11-17 21:23:07,680][INFO] Iter  15250 | loss=0.0007 | td_err=0.0185 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.216 | avg_path=11.97 | valid_steps=10.97
[2025-11-17 21:23:21,856][INFO] Iter  15300 | loss=0.0006 | td_err=0.0184 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.844 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.259 | avg_path=12.62 | valid_steps=11.62
[2025-11-17 21:23:36,198][INFO] Iter  15350 | loss=0.0005 | td_err=0.0157 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.378 | avg_path=13.25 | valid_steps=12.25
[2025-11-17 21:23:50,477][INFO] Iter  15400 | loss=0.0006 | td_err=0.0177 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.456 | avg_path=13.84 | valid_steps=12.84
[2025-11-17 21:24:04,621][INFO] Iter  15450 | loss=0.0007 | td_err=0.0195 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.391 | avg_path=13.16 | valid_steps=12.16
[2025-11-17 21:24:19,097][INFO] Iter  15500 | loss=0.0007 | td_err=0.0171 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.456 | avg_path=12.75 | valid_steps=11.75
[2025-11-17 21:24:33,543][INFO] Iter  15550 | loss=0.0006 | td_err=0.0173 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.497 | avg_path=13.22 | valid_steps=12.22
[2025-11-17 21:24:47,797][INFO] Iter  15600 | loss=0.0005 | td_err=0.0158 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.416 | avg_path=13.28 | valid_steps=12.28
[2025-11-17 21:25:02,231][INFO] Iter  15650 | loss=0.0005 | td_err=0.0164 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.456 | avg_path=13.53 | valid_steps=12.53
[2025-11-17 21:25:16,420][INFO] Iter  15700 | loss=0.0007 | td_err=0.0189 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.394 | avg_path=13.19 | valid_steps=12.19
[2025-11-17 21:25:30,043][INFO] Iter  15750 | loss=0.0007 | td_err=0.0186 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.541 | avg_path=13.66 | valid_steps=12.66
[2025-11-17 21:25:43,819][INFO] Iter  15800 | loss=0.0005 | td_err=0.0158 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.634 | avg_path=13.97 | valid_steps=12.97
[2025-11-17 21:25:57,586][INFO] Iter  15850 | loss=0.0005 | td_err=0.0171 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.616 | avg_path=14.22 | valid_steps=13.22
[2025-11-17 21:26:11,288][INFO] Iter  15900 | loss=0.0006 | td_err=0.0164 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.716 | avg_path=13.75 | valid_steps=12.75
[2025-11-17 21:26:25,052][INFO] Iter  15950 | loss=0.0004 | td_err=0.0146 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.262 | avg_path=12.59 | valid_steps=11.59
[2025-11-17 21:26:38,918][INFO] Iter  16000 | loss=0.0006 | td_err=0.0173 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.553 | avg_path=13.88 | valid_steps=12.88
[2025-11-17 21:26:46,691][INFO] ---- Evaluation at iter 16000 ----
[2025-11-17 21:26:46,692][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 21:26:46,692][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 21:26:46,692][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 21:26:46,692][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 21:26:46,697][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251117_200857/ckpt_ql_16000.pt
[2025-11-17 21:27:00,579][INFO] Iter  16050 | loss=0.0006 | td_err=0.0160 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.453 | avg_path=12.88 | valid_steps=11.88
[2025-11-17 21:27:14,324][INFO] Iter  16100 | loss=0.0006 | td_err=0.0168 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.400 | avg_path=13.03 | valid_steps=12.03
[2025-11-17 21:27:28,339][INFO] Iter  16150 | loss=0.0006 | td_err=0.0166 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.844 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.287 | avg_path=12.72 | valid_steps=11.72
[2025-11-17 21:27:42,305][INFO] Iter  16200 | loss=0.0008 | td_err=0.0194 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.631 | avg_path=13.31 | valid_steps=12.31
[2025-11-17 21:27:55,978][INFO] Iter  16250 | loss=0.0007 | td_err=0.0167 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.506 | avg_path=13.66 | valid_steps=12.66
[2025-11-17 21:28:10,035][INFO] Iter  16300 | loss=0.0006 | td_err=0.0163 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.844 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.466 | avg_path=12.84 | valid_steps=11.84
[2025-11-17 21:28:24,123][INFO] Iter  16350 | loss=0.0005 | td_err=0.0160 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.594 | hit=0.594 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.412 | avg_path=12.47 | valid_steps=11.47
[2025-11-17 21:28:37,762][INFO] Iter  16400 | loss=0.0004 | td_err=0.0144 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.500 | avg_path=13.34 | valid_steps=12.34
[2025-11-17 21:28:51,909][INFO] Iter  16450 | loss=0.0006 | td_err=0.0169 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.441 | avg_path=13.81 | valid_steps=12.81
[2025-11-17 21:29:05,940][INFO] Iter  16500 | loss=0.0007 | td_err=0.0200 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.625 | hit=0.625 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.453 | avg_path=12.41 | valid_steps=11.41
[2025-11-17 21:29:19,698][INFO] Iter  16550 | loss=0.0005 | td_err=0.0151 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.441 | avg_path=13.59 | valid_steps=12.59
[2025-11-17 21:29:33,418][INFO] Iter  16600 | loss=0.0004 | td_err=0.0146 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.594 | hit=0.594 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.275 | avg_path=12.03 | valid_steps=11.03
[2025-11-17 21:29:47,186][INFO] Iter  16650 | loss=0.0006 | td_err=0.0165 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.619 | avg_path=14.41 | valid_steps=13.41
[2025-11-17 21:30:01,135][INFO] Iter  16700 | loss=0.0005 | td_err=0.0162 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.609 | avg_path=14.06 | valid_steps=13.06
[2025-11-17 21:30:14,909][INFO] Iter  16750 | loss=0.0005 | td_err=0.0167 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.622 | avg_path=14.38 | valid_steps=13.38
[2025-11-17 21:30:28,647][INFO] Iter  16800 | loss=0.0004 | td_err=0.0143 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.397 | avg_path=13.16 | valid_steps=12.16
[2025-11-17 21:30:42,562][INFO] Iter  16850 | loss=0.0007 | td_err=0.0181 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.722 | avg_path=14.12 | valid_steps=13.12
[2025-11-17 21:30:56,360][INFO] Iter  16900 | loss=0.0005 | td_err=0.0160 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.469 | avg_path=12.97 | valid_steps=11.97
[2025-11-17 21:31:10,122][INFO] Iter  16950 | loss=0.0006 | td_err=0.0167 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.562 | hit=0.562 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.525 | avg_path=12.94 | valid_steps=11.94
[2025-11-17 21:31:24,048][INFO] Iter  17000 | loss=0.0006 | td_err=0.0181 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.656 | hit=0.656 | stage2=0.844 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.241 | avg_path=11.62 | valid_steps=10.62
[2025-11-17 21:31:31,723][INFO] ---- Evaluation at iter 17000 ----
[2025-11-17 21:31:31,726][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 21:31:31,726][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 21:31:31,726][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 21:31:31,726][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 21:31:45,778][INFO] Iter  17050 | loss=0.0005 | td_err=0.0161 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.522 | avg_path=13.12 | valid_steps=12.12
[2025-11-17 21:32:00,001][INFO] Iter  17100 | loss=0.0005 | td_err=0.0167 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.750 | hit=0.750 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.384 | avg_path=11.59 | valid_steps=10.59
[2025-11-17 21:32:14,035][INFO] Iter  17150 | loss=0.0004 | td_err=0.0156 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.250 | avg_path=12.84 | valid_steps=11.84
[2025-11-17 21:32:28,242][INFO] Iter  17200 | loss=0.0004 | td_err=0.0136 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.231 | avg_path=12.62 | valid_steps=11.62
[2025-11-17 21:32:42,138][INFO] Iter  17250 | loss=0.0006 | td_err=0.0178 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.787 | avg_path=14.28 | valid_steps=13.28
[2025-11-17 21:32:55,940][INFO] Iter  17300 | loss=0.0006 | td_err=0.0162 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.428 | avg_path=13.12 | valid_steps=12.12
[2025-11-17 21:33:10,490][INFO] Iter  17350 | loss=0.0004 | td_err=0.0151 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.594 | hit=0.594 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.400 | avg_path=12.41 | valid_steps=11.41
[2025-11-17 21:33:24,438][INFO] Iter  17400 | loss=0.0004 | td_err=0.0145 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.478 | avg_path=13.72 | valid_steps=12.72
[2025-11-17 21:33:38,580][INFO] Iter  17450 | loss=0.0004 | td_err=0.0146 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.594 | hit=0.594 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.475 | avg_path=12.66 | valid_steps=11.66
[2025-11-17 21:33:52,211][INFO] Iter  17500 | loss=0.0005 | td_err=0.0173 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.319 | avg_path=12.31 | valid_steps=11.31
[2025-11-17 21:34:05,920][INFO] Iter  17550 | loss=0.0005 | td_err=0.0158 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.509 | avg_path=13.91 | valid_steps=12.91
[2025-11-17 21:34:19,843][INFO] Iter  17600 | loss=0.0006 | td_err=0.0165 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.312 | hit=0.312 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.566 | avg_path=14.34 | valid_steps=13.34
[2025-11-17 21:34:33,781][INFO] Iter  17650 | loss=0.0005 | td_err=0.0152 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.503 | avg_path=13.22 | valid_steps=12.22
[2025-11-17 21:34:47,622][INFO] Iter  17700 | loss=0.0007 | td_err=0.0171 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.625 | hit=0.625 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.500 | avg_path=12.56 | valid_steps=11.56
[2025-11-17 21:35:01,459][INFO] Iter  17750 | loss=0.0004 | td_err=0.0142 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.237 | avg_path=12.53 | valid_steps=11.53
[2025-11-17 21:35:15,274][INFO] Iter  17800 | loss=0.0004 | td_err=0.0146 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.572 | avg_path=13.72 | valid_steps=12.72
[2025-11-17 21:35:29,014][INFO] Iter  17850 | loss=0.0006 | td_err=0.0162 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.441 | avg_path=13.19 | valid_steps=12.19
[2025-11-17 21:35:43,007][INFO] Iter  17900 | loss=0.0006 | td_err=0.0168 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.438 | hit=0.438 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.584 | avg_path=13.78 | valid_steps=12.78
[2025-11-17 21:35:56,758][INFO] Iter  17950 | loss=0.0003 | td_err=0.0144 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.403 | avg_path=12.75 | valid_steps=11.75
[2025-11-17 21:36:10,680][INFO] Iter  18000 | loss=0.0004 | td_err=0.0143 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.312 | hit=0.312 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.275 | avg_path=13.38 | valid_steps=12.38
[2025-11-17 21:36:18,586][INFO] ---- Evaluation at iter 18000 ----
[2025-11-17 21:36:18,587][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 21:36:18,588][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 21:36:18,588][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 21:36:18,588][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 21:36:18,592][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251117_200857/ckpt_ql_18000.pt
[2025-11-17 21:36:32,445][INFO] Iter  18050 | loss=0.0004 | td_err=0.0151 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.625 | hit=0.625 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.347 | avg_path=12.09 | valid_steps=11.09
[2025-11-17 21:36:46,135][INFO] Iter  18100 | loss=0.0005 | td_err=0.0163 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.528 | avg_path=14.06 | valid_steps=13.06
[2025-11-17 21:36:59,950][INFO] Iter  18150 | loss=0.0003 | td_err=0.0126 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.312 | hit=0.312 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.500 | avg_path=14.12 | valid_steps=13.12
[2025-11-17 21:37:14,161][INFO] Iter  18200 | loss=0.0004 | td_err=0.0134 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.294 | avg_path=13.03 | valid_steps=12.03
[2025-11-17 21:37:28,132][INFO] Iter  18250 | loss=0.0004 | td_err=0.0143 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.750 | hit=0.750 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.309 | avg_path=11.34 | valid_steps=10.34
[2025-11-17 21:37:41,843][INFO] Iter  18300 | loss=0.0005 | td_err=0.0154 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.406 | avg_path=13.72 | valid_steps=12.72
[2025-11-17 21:37:55,137][INFO] Iter  18350 | loss=0.0005 | td_err=0.0152 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.484 | avg_path=13.78 | valid_steps=12.78
[2025-11-17 21:38:08,411][INFO] Iter  18400 | loss=0.0004 | td_err=0.0139 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.456 | avg_path=13.69 | valid_steps=12.69
[2025-11-17 21:38:21,739][INFO] Iter  18450 | loss=0.0006 | td_err=0.0156 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.359 | avg_path=12.62 | valid_steps=11.62
[2025-11-17 21:38:35,049][INFO] Iter  18500 | loss=0.0004 | td_err=0.0132 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.250 | hit=0.250 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.409 | avg_path=14.16 | valid_steps=13.16
[2025-11-17 21:38:48,174][INFO] Iter  18550 | loss=0.0006 | td_err=0.0166 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.562 | hit=0.562 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.634 | avg_path=13.34 | valid_steps=12.34
[2025-11-17 21:39:01,369][INFO] Iter  18600 | loss=0.0004 | td_err=0.0150 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.594 | hit=0.594 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.600 | avg_path=13.09 | valid_steps=12.09
[2025-11-17 21:39:14,582][INFO] Iter  18650 | loss=0.0005 | td_err=0.0153 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.594 | hit=0.594 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.228 | avg_path=11.88 | valid_steps=10.88
[2025-11-17 21:39:27,756][INFO] Iter  18700 | loss=0.0003 | td_err=0.0133 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.625 | hit=0.625 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.512 | avg_path=12.62 | valid_steps=11.62
[2025-11-17 21:39:40,801][INFO] Iter  18750 | loss=0.0005 | td_err=0.0149 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.844 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.222 | avg_path=12.50 | valid_steps=11.50
[2025-11-17 21:39:53,930][INFO] Iter  18800 | loss=0.0004 | td_err=0.0141 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.309 | avg_path=13.38 | valid_steps=12.38
[2025-11-17 21:40:07,236][INFO] Iter  18850 | loss=0.0004 | td_err=0.0139 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.844 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.362 | avg_path=13.28 | valid_steps=12.28
[2025-11-17 21:40:20,293][INFO] Iter  18900 | loss=0.0003 | td_err=0.0124 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.344 | avg_path=12.53 | valid_steps=11.53
[2025-11-17 21:40:33,495][INFO] Iter  18950 | loss=0.0004 | td_err=0.0136 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.453 | avg_path=13.03 | valid_steps=12.03
[2025-11-17 21:40:46,587][INFO] Iter  19000 | loss=0.0010 | td_err=0.0134 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.594 | hit=0.594 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.325 | avg_path=12.16 | valid_steps=11.16
[2025-11-17 21:40:54,132][INFO] ---- Evaluation at iter 19000 ----
[2025-11-17 21:40:54,133][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 21:40:54,133][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 21:40:54,133][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 21:40:54,133][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 21:41:07,414][INFO] Iter  19050 | loss=0.0005 | td_err=0.0146 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.438 | avg_path=13.16 | valid_steps=12.16
[2025-11-17 21:41:20,531][INFO] Iter  19100 | loss=0.0004 | td_err=0.0150 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.231 | avg_path=12.47 | valid_steps=11.47
[2025-11-17 21:41:33,734][INFO] Iter  19150 | loss=0.0004 | td_err=0.0136 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.188 | hit=0.188 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.544 | avg_path=14.94 | valid_steps=13.94
[2025-11-17 21:41:46,876][INFO] Iter  19200 | loss=0.0005 | td_err=0.0152 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.500 | hit=0.500 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.569 | avg_path=13.44 | valid_steps=12.44
[2025-11-17 21:42:00,177][INFO] Iter  19250 | loss=0.0004 | td_err=0.0145 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.387 | avg_path=13.28 | valid_steps=12.28
[2025-11-17 21:42:13,342][INFO] Iter  19300 | loss=0.0003 | td_err=0.0131 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.206 | avg_path=12.41 | valid_steps=11.41
[2025-11-17 21:42:26,516][INFO] Iter  19350 | loss=0.0004 | td_err=0.0146 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.403 | avg_path=13.31 | valid_steps=12.31
[2025-11-17 21:42:39,804][INFO] Iter  19400 | loss=0.0004 | td_err=0.0146 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.544 | avg_path=14.00 | valid_steps=13.00
[2025-11-17 21:42:53,115][INFO] Iter  19450 | loss=0.0005 | td_err=0.0159 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.659 | avg_path=14.50 | valid_steps=13.50
[2025-11-17 21:43:06,350][INFO] Iter  19500 | loss=0.0003 | td_err=0.0128 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.875 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.247 | avg_path=12.88 | valid_steps=11.88
[2025-11-17 21:43:19,574][INFO] Iter  19550 | loss=0.0003 | td_err=0.0127 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.344 | hit=0.344 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.516 | avg_path=14.06 | valid_steps=13.06
[2025-11-17 21:43:32,698][INFO] Iter  19600 | loss=0.0004 | td_err=0.0145 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.491 | avg_path=13.62 | valid_steps=12.62
[2025-11-17 21:43:45,872][INFO] Iter  19650 | loss=0.0004 | td_err=0.0134 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.503 | avg_path=13.06 | valid_steps=12.06
[2025-11-17 21:43:59,257][INFO] Iter  19700 | loss=0.0005 | td_err=0.0166 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.559 | avg_path=13.88 | valid_steps=12.88
[2025-11-17 21:44:12,501][INFO] Iter  19750 | loss=0.0004 | td_err=0.0133 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=1.000 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.506 | avg_path=13.66 | valid_steps=12.66
[2025-11-17 21:44:25,656][INFO] Iter  19800 | loss=0.0005 | td_err=0.0148 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.906 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.450 | avg_path=13.69 | valid_steps=12.69
[2025-11-17 21:44:39,069][INFO] Iter  19850 | loss=0.0003 | td_err=0.0127 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.688 | hit=0.688 | stage2=0.844 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.166 | avg_path=11.22 | valid_steps=10.22
[2025-11-17 21:44:52,315][INFO] Iter  19900 | loss=0.0005 | td_err=0.0151 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.375 | hit=0.375 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.419 | avg_path=13.56 | valid_steps=12.56
[2025-11-17 21:45:05,453][INFO] Iter  19950 | loss=0.0005 | td_err=0.0146 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.531 | avg_path=13.47 | valid_steps=12.47
[2025-11-17 21:45:18,726][INFO] Iter  20000 | loss=0.0004 | td_err=0.0140 | kl=0.0000 | temp=0.200 | eps=0.000 | success=0.406 | hit=0.406 | stage2=0.969 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=4.425 | avg_path=13.41 | valid_steps=12.41
[2025-11-17 21:45:26,241][INFO] ---- Evaluation at iter 20000 ----
[2025-11-17 21:45:26,242][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 21:45:26,242][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 21:45:26,242][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 21:45:26,242][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 21:45:26,247][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251117_200857/ckpt_ql_20000.pt
[2025-11-17 21:45:26,247][INFO] Q-learning training finished.
