[2025-11-17 17:39:56,667][INFO] Q-learning training started.
[2025-11-17 17:39:56,667][INFO] Output directory: out_qlearning/ql_20251117_173956
[2025-11-17 17:39:56,667][INFO] Reward type: process
[2025-11-17 17:39:56,669][INFO] Resolved model configuration: {"vocab_size": 92, "block_size": 32, "n_layer": 1, "n_head": 1, "n_embd": 92, "dropout": 0.0, "bias": false}
[2025-11-17 17:39:57,345][INFO] 启用目标网络：EMA=0.9950, sync_interval=0
[2025-11-17 17:39:57,347][INFO] KL 正则启用：coef=0.0500, warmup=0, anneal=12000
[2025-11-17 17:39:57,358][INFO] Loaded 1127 unique (source, target) pairs for Q-learning training.
[2025-11-17 17:40:05,050][INFO] Iter     50 | loss=29.3053 | td_err=4.1177 | kl=2.3768 | temp=0.006 | eps=0.199 | success=1.000 | hit=1.000 | stage2=0.719 | invalid_edge=0.000 | invalid_tok=0.000 | avg_ep_reward=1.897 | avg_path=4.53 | valid_steps=3.53
[2025-11-17 17:40:12,432][INFO] Iter    100 | loss=20.8876 | td_err=3.6678 | kl=1.7736 | temp=0.013 | eps=0.199 | success=0.500 | hit=0.500 | stage2=0.781 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.055 | avg_path=5.03 | valid_steps=3.19
[2025-11-17 17:40:20,312][INFO] Iter    150 | loss=18.5602 | td_err=3.4463 | kl=1.8719 | temp=0.019 | eps=0.198 | success=0.250 | hit=0.250 | stage2=0.562 | invalid_edge=0.750 | invalid_tok=0.000 | avg_ep_reward=0.505 | avg_path=5.69 | valid_steps=3.28
[2025-11-17 17:40:28,784][INFO] Iter    200 | loss=13.6953 | td_err=2.9419 | kl=2.3529 | temp=0.025 | eps=0.198 | success=0.125 | hit=0.125 | stage2=0.562 | invalid_edge=0.875 | invalid_tok=0.000 | avg_ep_reward=0.120 | avg_path=6.22 | valid_steps=3.50
[2025-11-17 17:40:37,710][INFO] Iter    250 | loss=12.4527 | td_err=2.6278 | kl=2.4558 | temp=0.031 | eps=0.197 | success=0.031 | hit=0.031 | stage2=0.656 | invalid_edge=0.969 | invalid_tok=0.000 | avg_ep_reward=0.019 | avg_path=7.19 | valid_steps=4.25
[2025-11-17 17:40:46,430][INFO] Iter    300 | loss=10.1433 | td_err=2.2672 | kl=2.6742 | temp=0.037 | eps=0.196 | success=0.000 | hit=0.000 | stage2=0.469 | invalid_edge=1.000 | invalid_tok=0.000 | avg_ep_reward=-0.109 | avg_path=6.97 | valid_steps=3.97
[2025-11-17 17:40:55,239][INFO] Iter    350 | loss=8.1168 | td_err=2.0196 | kl=2.9559 | temp=0.044 | eps=0.196 | success=0.000 | hit=0.000 | stage2=0.594 | invalid_edge=1.000 | invalid_tok=0.000 | avg_ep_reward=-0.116 | avg_path=6.66 | valid_steps=3.66
[2025-11-17 17:41:04,408][INFO] Iter    400 | loss=9.7495 | td_err=2.2276 | kl=2.6236 | temp=0.050 | eps=0.195 | success=0.031 | hit=0.031 | stage2=0.625 | invalid_edge=0.969 | invalid_tok=0.000 | avg_ep_reward=-0.094 | avg_path=6.12 | valid_steps=3.19
[2025-11-17 17:41:13,715][INFO] Iter    450 | loss=7.6750 | td_err=1.9626 | kl=2.6890 | temp=0.056 | eps=0.194 | success=0.000 | hit=0.000 | stage2=0.438 | invalid_edge=1.000 | invalid_tok=0.000 | avg_ep_reward=-0.184 | avg_path=6.06 | valid_steps=3.12
[2025-11-17 17:41:22,889][INFO] Iter    500 | loss=6.9507 | td_err=1.8735 | kl=3.0154 | temp=0.062 | eps=0.194 | success=0.000 | hit=0.000 | stage2=0.531 | invalid_edge=1.000 | invalid_tok=0.000 | avg_ep_reward=-0.106 | avg_path=5.72 | valid_steps=2.78
[2025-11-17 17:41:32,245][INFO] Iter    550 | loss=7.4854 | td_err=1.9015 | kl=2.6893 | temp=0.069 | eps=0.193 | success=0.000 | hit=0.000 | stage2=0.594 | invalid_edge=1.000 | invalid_tok=0.000 | avg_ep_reward=-0.061 | avg_path=6.62 | valid_steps=3.66
[2025-11-17 17:41:41,424][INFO] Iter    600 | loss=6.3576 | td_err=1.7602 | kl=2.7649 | temp=0.075 | eps=0.193 | success=0.000 | hit=0.000 | stage2=0.562 | invalid_edge=1.000 | invalid_tok=0.000 | avg_ep_reward=-0.166 | avg_path=6.22 | valid_steps=3.22
[2025-11-17 17:41:50,388][INFO] Iter    650 | loss=6.6944 | td_err=1.8279 | kl=2.8495 | temp=0.081 | eps=0.192 | success=0.000 | hit=0.000 | stage2=0.562 | invalid_edge=1.000 | invalid_tok=0.000 | avg_ep_reward=-0.114 | avg_path=6.16 | valid_steps=3.19
[2025-11-17 17:41:59,280][INFO] Iter    700 | loss=5.9057 | td_err=1.7942 | kl=2.8457 | temp=0.087 | eps=0.191 | success=0.000 | hit=0.000 | stage2=0.594 | invalid_edge=1.000 | invalid_tok=0.000 | avg_ep_reward=-0.144 | avg_path=6.38 | valid_steps=3.38
[2025-11-17 17:42:08,597][INFO] Iter    750 | loss=4.1677 | td_err=1.3964 | kl=3.1129 | temp=0.094 | eps=0.191 | success=0.031 | hit=0.031 | stage2=0.719 | invalid_edge=0.969 | invalid_tok=0.000 | avg_ep_reward=0.072 | avg_path=7.59 | valid_steps=4.66
[2025-11-17 17:42:18,030][INFO] Iter    800 | loss=4.0562 | td_err=1.4287 | kl=2.6382 | temp=0.100 | eps=0.190 | success=0.094 | hit=0.094 | stage2=0.500 | invalid_edge=0.906 | invalid_tok=0.000 | avg_ep_reward=0.012 | avg_path=6.06 | valid_steps=3.25
[2025-11-17 17:42:27,485][INFO] Iter    850 | loss=3.5450 | td_err=1.2797 | kl=2.7349 | temp=0.106 | eps=0.189 | success=0.000 | hit=0.000 | stage2=0.500 | invalid_edge=1.000 | invalid_tok=0.000 | avg_ep_reward=-0.141 | avg_path=6.59 | valid_steps=3.59
[2025-11-17 17:42:36,978][INFO] Iter    900 | loss=3.1161 | td_err=1.1660 | kl=2.7688 | temp=0.113 | eps=0.189 | success=0.031 | hit=0.031 | stage2=0.750 | invalid_edge=0.969 | invalid_tok=0.000 | avg_ep_reward=0.050 | avg_path=7.31 | valid_steps=4.38
[2025-11-17 17:42:46,796][INFO] Iter    950 | loss=2.0684 | td_err=0.9933 | kl=2.6232 | temp=0.119 | eps=0.188 | success=0.094 | hit=0.094 | stage2=0.656 | invalid_edge=0.906 | invalid_tok=0.000 | avg_ep_reward=0.169 | avg_path=7.31 | valid_steps=4.50
[2025-11-17 17:42:57,068][INFO] Iter   1000 | loss=1.9817 | td_err=0.9772 | kl=2.9790 | temp=0.125 | eps=0.188 | success=0.125 | hit=0.125 | stage2=0.781 | invalid_edge=0.875 | invalid_tok=0.000 | avg_ep_reward=0.322 | avg_path=7.91 | valid_steps=5.16
[2025-11-17 17:43:05,042][INFO] ---- Evaluation at iter 1000 ----
[2025-11-17 17:43:05,043][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 17:43:05,043][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 17:43:05,043][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 17:43:05,043][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 17:43:15,012][INFO] Iter   1050 | loss=1.5669 | td_err=0.8733 | kl=2.6843 | temp=0.131 | eps=0.187 | success=0.062 | hit=0.062 | stage2=0.688 | invalid_edge=0.938 | invalid_tok=0.000 | avg_ep_reward=0.137 | avg_path=7.62 | valid_steps=4.75
[2025-11-17 17:43:25,091][INFO] Iter   1100 | loss=1.6114 | td_err=0.8841 | kl=2.7212 | temp=0.138 | eps=0.186 | success=0.031 | hit=0.031 | stage2=0.719 | invalid_edge=0.969 | invalid_tok=0.000 | avg_ep_reward=0.137 | avg_path=8.25 | valid_steps=5.31
[2025-11-17 17:43:35,433][INFO] Iter   1150 | loss=1.1475 | td_err=0.7286 | kl=2.8073 | temp=0.144 | eps=0.186 | success=0.031 | hit=0.031 | stage2=0.688 | invalid_edge=0.969 | invalid_tok=0.000 | avg_ep_reward=0.147 | avg_path=8.41 | valid_steps=5.47
[2025-11-17 17:43:46,258][INFO] Iter   1200 | loss=1.1293 | td_err=0.7158 | kl=2.7862 | temp=0.150 | eps=0.185 | success=0.156 | hit=0.156 | stage2=0.812 | invalid_edge=0.844 | invalid_tok=0.000 | avg_ep_reward=0.466 | avg_path=8.59 | valid_steps=5.91
[2025-11-17 17:43:57,268][INFO] Iter   1250 | loss=0.8201 | td_err=0.5935 | kl=2.7701 | temp=0.156 | eps=0.184 | success=0.125 | hit=0.125 | stage2=0.625 | invalid_edge=0.875 | invalid_tok=0.000 | avg_ep_reward=0.405 | avg_path=8.47 | valid_steps=5.75
[2025-11-17 17:44:08,607][INFO] Iter   1300 | loss=1.2350 | td_err=0.5904 | kl=2.5199 | temp=0.163 | eps=0.184 | success=0.125 | hit=0.125 | stage2=0.625 | invalid_edge=0.875 | invalid_tok=0.000 | avg_ep_reward=0.383 | avg_path=8.25 | valid_steps=5.53
[2025-11-17 17:44:19,727][INFO] Iter   1350 | loss=0.4657 | td_err=0.4309 | kl=2.5253 | temp=0.169 | eps=0.183 | success=0.219 | hit=0.219 | stage2=0.781 | invalid_edge=0.781 | invalid_tok=0.000 | avg_ep_reward=0.662 | avg_path=8.81 | valid_steps=6.38
[2025-11-17 17:44:30,854][INFO] Iter   1400 | loss=0.5778 | td_err=0.4532 | kl=2.3713 | temp=0.175 | eps=0.182 | success=0.219 | hit=0.219 | stage2=0.656 | invalid_edge=0.781 | invalid_tok=0.000 | avg_ep_reward=0.573 | avg_path=8.50 | valid_steps=5.97
[2025-11-17 17:44:42,127][INFO] Iter   1450 | loss=0.3629 | td_err=0.3500 | kl=2.4079 | temp=0.181 | eps=0.182 | success=0.156 | hit=0.156 | stage2=0.656 | invalid_edge=0.844 | invalid_tok=0.000 | avg_ep_reward=0.484 | avg_path=8.88 | valid_steps=6.25
[2025-11-17 17:44:53,428][INFO] Iter   1500 | loss=0.3048 | td_err=0.3180 | kl=2.5021 | temp=0.188 | eps=0.181 | success=0.031 | hit=0.031 | stage2=0.844 | invalid_edge=0.875 | invalid_tok=0.000 | avg_ep_reward=0.466 | avg_path=9.72 | valid_steps=7.09
[2025-11-17 17:45:04,809][INFO] Iter   1550 | loss=0.3729 | td_err=0.3386 | kl=2.4703 | temp=0.194 | eps=0.181 | success=0.062 | hit=0.062 | stage2=0.781 | invalid_edge=0.844 | invalid_tok=0.000 | avg_ep_reward=0.462 | avg_path=9.38 | valid_steps=6.88
[2025-11-17 17:45:16,506][INFO] Iter   1600 | loss=0.3681 | td_err=0.3311 | kl=2.3485 | temp=0.200 | eps=0.180 | success=0.156 | hit=0.156 | stage2=0.750 | invalid_edge=0.781 | invalid_tok=0.000 | avg_ep_reward=0.623 | avg_path=9.31 | valid_steps=6.91
[2025-11-17 17:45:28,255][INFO] Iter   1650 | loss=0.3072 | td_err=0.3156 | kl=2.5454 | temp=0.206 | eps=0.179 | success=0.000 | hit=0.000 | stage2=0.938 | invalid_edge=1.000 | invalid_tok=0.000 | avg_ep_reward=0.458 | avg_path=11.12 | valid_steps=8.16
[2025-11-17 17:45:40,228][INFO] Iter   1700 | loss=0.2908 | td_err=0.2923 | kl=2.3722 | temp=0.212 | eps=0.179 | success=0.125 | hit=0.125 | stage2=0.812 | invalid_edge=0.781 | invalid_tok=0.000 | avg_ep_reward=0.666 | avg_path=10.41 | valid_steps=7.91
[2025-11-17 17:45:52,494][INFO] Iter   1750 | loss=0.4062 | td_err=0.3376 | kl=2.3792 | temp=0.219 | eps=0.178 | success=0.031 | hit=0.031 | stage2=0.812 | invalid_edge=0.969 | invalid_tok=0.000 | avg_ep_reward=0.433 | avg_path=10.66 | valid_steps=7.84
[2025-11-17 17:46:04,726][INFO] Iter   1800 | loss=0.4922 | td_err=0.3642 | kl=2.3205 | temp=0.225 | eps=0.178 | success=0.156 | hit=0.156 | stage2=0.844 | invalid_edge=0.719 | invalid_tok=0.000 | avg_ep_reward=0.711 | avg_path=9.09 | valid_steps=6.97
[2025-11-17 17:46:17,339][INFO] Iter   1850 | loss=0.2790 | td_err=0.2603 | kl=2.3053 | temp=0.231 | eps=0.177 | success=0.188 | hit=0.188 | stage2=0.969 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.081 | avg_path=9.81 | valid_steps=8.31
[2025-11-17 17:46:30,180][INFO] Iter   1900 | loss=0.3115 | td_err=0.2863 | kl=2.2746 | temp=0.237 | eps=0.176 | success=0.156 | hit=0.156 | stage2=0.875 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=0.973 | avg_path=10.38 | valid_steps=8.59
[2025-11-17 17:46:43,006][INFO] Iter   1950 | loss=0.2149 | td_err=0.2441 | kl=2.3027 | temp=0.244 | eps=0.176 | success=0.062 | hit=0.062 | stage2=0.969 | invalid_edge=0.781 | invalid_tok=0.000 | avg_ep_reward=0.770 | avg_path=11.94 | valid_steps=9.50
[2025-11-17 17:46:56,192][INFO] Iter   2000 | loss=0.2050 | td_err=0.2168 | kl=2.3021 | temp=0.250 | eps=0.175 | success=0.156 | hit=0.156 | stage2=0.812 | invalid_edge=0.688 | invalid_tok=0.000 | avg_ep_reward=0.945 | avg_path=11.53 | valid_steps=9.38
[2025-11-17 17:47:04,352][INFO] ---- Evaluation at iter 2000 ----
[2025-11-17 17:47:04,355][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 17:47:04,355][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 17:47:04,355][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 17:47:04,355][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 17:47:04,359][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251117_173956/ckpt_ql_2000.pt
[2025-11-17 17:47:17,684][INFO] Iter   2050 | loss=0.2086 | td_err=0.2137 | kl=2.3123 | temp=0.256 | eps=0.174 | success=0.156 | hit=0.156 | stage2=0.938 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.083 | avg_path=11.34 | valid_steps=9.56
[2025-11-17 17:47:31,246][INFO] Iter   2100 | loss=0.1738 | td_err=0.1810 | kl=2.1648 | temp=0.263 | eps=0.174 | success=0.156 | hit=0.156 | stage2=0.938 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.009 | avg_path=10.50 | valid_steps=8.75
[2025-11-17 17:47:44,794][INFO] Iter   2150 | loss=0.1958 | td_err=0.2042 | kl=2.2242 | temp=0.269 | eps=0.173 | success=0.125 | hit=0.125 | stage2=0.906 | invalid_edge=0.750 | invalid_tok=0.000 | avg_ep_reward=0.859 | avg_path=11.72 | valid_steps=9.34
[2025-11-17 17:47:58,504][INFO] Iter   2200 | loss=0.1703 | td_err=0.1660 | kl=2.2740 | temp=0.275 | eps=0.173 | success=0.125 | hit=0.125 | stage2=0.906 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.069 | avg_path=11.19 | valid_steps=9.56
[2025-11-17 17:48:11,664][INFO] Iter   2250 | loss=0.1891 | td_err=0.2108 | kl=2.0940 | temp=0.281 | eps=0.172 | success=0.312 | hit=0.312 | stage2=0.875 | invalid_edge=0.219 | invalid_tok=0.000 | avg_ep_reward=1.295 | avg_path=9.28 | valid_steps=8.06
[2025-11-17 17:48:25,266][INFO] Iter   2300 | loss=0.2099 | td_err=0.2148 | kl=2.1939 | temp=0.287 | eps=0.171 | success=0.281 | hit=0.281 | stage2=0.844 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.275 | avg_path=9.91 | valid_steps=8.62
[2025-11-17 17:48:38,899][INFO] Iter   2350 | loss=0.1415 | td_err=0.1603 | kl=2.0367 | temp=0.294 | eps=0.171 | success=0.219 | hit=0.219 | stage2=1.000 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.347 | avg_path=11.69 | valid_steps=10.12
[2025-11-17 17:48:52,498][INFO] Iter   2400 | loss=0.1273 | td_err=0.1506 | kl=2.1078 | temp=0.300 | eps=0.170 | success=0.188 | hit=0.188 | stage2=0.906 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.191 | avg_path=11.47 | valid_steps=9.84
[2025-11-17 17:49:06,135][INFO] Iter   2450 | loss=0.1644 | td_err=0.1908 | kl=1.9896 | temp=0.306 | eps=0.169 | success=0.344 | hit=0.344 | stage2=0.969 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=1.380 | avg_path=10.53 | valid_steps=9.03
[2025-11-17 17:49:19,687][INFO] Iter   2500 | loss=0.1224 | td_err=0.1546 | kl=1.9002 | temp=0.312 | eps=0.169 | success=0.406 | hit=0.406 | stage2=0.969 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.378 | avg_path=10.38 | valid_steps=8.62
[2025-11-17 17:49:33,650][INFO] Iter   2550 | loss=0.1299 | td_err=0.1456 | kl=2.0094 | temp=0.319 | eps=0.168 | success=0.312 | hit=0.312 | stage2=0.844 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.298 | avg_path=11.12 | valid_steps=9.41
[2025-11-17 17:49:48,321][INFO] Iter   2600 | loss=0.1243 | td_err=0.1378 | kl=2.0385 | temp=0.325 | eps=0.168 | success=0.188 | hit=0.188 | stage2=0.875 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.300 | avg_path=12.62 | valid_steps=11.00
[2025-11-17 17:50:02,211][INFO] Iter   2650 | loss=0.1425 | td_err=0.1466 | kl=1.9923 | temp=0.331 | eps=0.167 | success=0.281 | hit=0.281 | stage2=0.938 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.467 | avg_path=12.22 | valid_steps=10.75
[2025-11-17 17:50:16,662][INFO] Iter   2700 | loss=0.1153 | td_err=0.1423 | kl=1.9256 | temp=0.338 | eps=0.166 | success=0.344 | hit=0.344 | stage2=0.938 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.464 | avg_path=12.12 | valid_steps=10.41
[2025-11-17 17:50:30,524][INFO] Iter   2750 | loss=0.1328 | td_err=0.1555 | kl=1.9633 | temp=0.344 | eps=0.166 | success=0.469 | hit=0.469 | stage2=0.875 | invalid_edge=0.312 | invalid_tok=0.000 | avg_ep_reward=1.584 | avg_path=10.38 | valid_steps=9.00
[2025-11-17 17:50:44,616][INFO] Iter   2800 | loss=0.1186 | td_err=0.1431 | kl=1.9292 | temp=0.350 | eps=0.165 | success=0.250 | hit=0.250 | stage2=1.000 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.525 | avg_path=12.59 | valid_steps=11.28
[2025-11-17 17:50:58,547][INFO] Iter   2850 | loss=0.1118 | td_err=0.1221 | kl=1.8172 | temp=0.356 | eps=0.164 | success=0.406 | hit=0.406 | stage2=0.906 | invalid_edge=0.312 | invalid_tok=0.000 | avg_ep_reward=1.559 | avg_path=11.66 | valid_steps=10.09
[2025-11-17 17:51:12,003][INFO] Iter   2900 | loss=0.1024 | td_err=0.1179 | kl=1.8712 | temp=0.362 | eps=0.164 | success=0.281 | hit=0.281 | stage2=0.938 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.333 | avg_path=10.22 | valid_steps=8.94
[2025-11-17 17:51:25,481][INFO] Iter   2950 | loss=0.0959 | td_err=0.1035 | kl=1.8583 | temp=0.369 | eps=0.163 | success=0.312 | hit=0.312 | stage2=0.938 | invalid_edge=0.219 | invalid_tok=0.000 | avg_ep_reward=1.602 | avg_path=12.22 | valid_steps=11.00
[2025-11-17 17:51:39,223][INFO] Iter   3000 | loss=0.1153 | td_err=0.1219 | kl=2.0040 | temp=0.375 | eps=0.163 | success=0.312 | hit=0.312 | stage2=0.969 | invalid_edge=0.219 | invalid_tok=0.000 | avg_ep_reward=1.706 | avg_path=13.31 | valid_steps=12.06
[2025-11-17 17:51:47,254][INFO] ---- Evaluation at iter 3000 ----
[2025-11-17 17:51:47,256][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 17:51:47,256][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 17:51:47,256][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 17:51:47,256][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 17:52:01,109][INFO] Iter   3050 | loss=0.1091 | td_err=0.1398 | kl=1.7580 | temp=0.381 | eps=0.162 | success=0.500 | hit=0.500 | stage2=0.938 | invalid_edge=0.125 | invalid_tok=0.000 | avg_ep_reward=1.834 | avg_path=11.62 | valid_steps=10.44
[2025-11-17 17:52:15,493][INFO] Iter   3100 | loss=0.1126 | td_err=0.1387 | kl=1.6866 | temp=0.388 | eps=0.161 | success=0.406 | hit=0.406 | stage2=1.000 | invalid_edge=0.125 | invalid_tok=0.000 | avg_ep_reward=1.781 | avg_path=12.59 | valid_steps=11.34
[2025-11-17 17:52:29,646][INFO] Iter   3150 | loss=0.0933 | td_err=0.1065 | kl=1.9483 | temp=0.394 | eps=0.161 | success=0.344 | hit=0.344 | stage2=0.906 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.519 | avg_path=12.41 | valid_steps=10.78
[2025-11-17 17:52:43,529][INFO] Iter   3200 | loss=0.0816 | td_err=0.1034 | kl=1.6760 | temp=0.400 | eps=0.160 | success=0.469 | hit=0.469 | stage2=0.969 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.813 | avg_path=12.47 | valid_steps=11.09
[2025-11-17 17:52:57,666][INFO] Iter   3250 | loss=0.0800 | td_err=0.0946 | kl=1.7458 | temp=0.406 | eps=0.159 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.689 | avg_path=11.62 | valid_steps=10.16
[2025-11-17 17:53:11,357][INFO] Iter   3300 | loss=0.0818 | td_err=0.0955 | kl=1.8106 | temp=0.412 | eps=0.159 | success=0.344 | hit=0.344 | stage2=0.875 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.577 | avg_path=12.50 | valid_steps=11.03
[2025-11-17 17:53:25,154][INFO] Iter   3350 | loss=0.0991 | td_err=0.0990 | kl=1.8386 | temp=0.419 | eps=0.158 | success=0.250 | hit=0.250 | stage2=1.000 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.648 | avg_path=13.72 | valid_steps=12.44
[2025-11-17 17:53:38,978][INFO] Iter   3400 | loss=0.0879 | td_err=0.1077 | kl=1.6705 | temp=0.425 | eps=0.158 | success=0.406 | hit=0.406 | stage2=0.969 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=1.755 | avg_path=11.84 | valid_steps=10.75
[2025-11-17 17:53:52,506][INFO] Iter   3450 | loss=0.0719 | td_err=0.0843 | kl=1.5977 | temp=0.431 | eps=0.157 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.250 | invalid_tok=0.000 | avg_ep_reward=1.850 | avg_path=11.53 | valid_steps=10.28
[2025-11-17 17:54:05,994][INFO] Iter   3500 | loss=0.0725 | td_err=0.0907 | kl=1.5933 | temp=0.438 | eps=0.156 | success=0.531 | hit=0.531 | stage2=0.906 | invalid_edge=0.156 | invalid_tok=0.000 | avg_ep_reward=1.870 | avg_path=11.47 | valid_steps=10.31
[2025-11-17 17:54:19,333][INFO] Iter   3550 | loss=0.0747 | td_err=0.0952 | kl=1.4519 | temp=0.444 | eps=0.156 | success=0.688 | hit=0.688 | stage2=0.906 | invalid_edge=0.031 | invalid_tok=0.000 | avg_ep_reward=1.983 | avg_path=9.81 | valid_steps=8.78
[2025-11-17 17:54:32,527][INFO] Iter   3600 | loss=0.0713 | td_err=0.0930 | kl=1.5253 | temp=0.450 | eps=0.155 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=1.789 | avg_path=11.31 | valid_steps=10.22
[2025-11-17 17:54:45,716][INFO] Iter   3650 | loss=0.0617 | td_err=0.0729 | kl=1.4678 | temp=0.456 | eps=0.154 | success=0.562 | hit=0.562 | stage2=0.875 | invalid_edge=0.188 | invalid_tok=0.000 | avg_ep_reward=1.856 | avg_path=11.03 | valid_steps=9.84
[2025-11-17 17:54:58,654][INFO] Iter   3700 | loss=0.0628 | td_err=0.0754 | kl=1.4793 | temp=0.463 | eps=0.154 | success=0.531 | hit=0.531 | stage2=0.906 | invalid_edge=0.250 | invalid_tok=0.000 | avg_ep_reward=1.872 | avg_path=11.81 | valid_steps=10.56
[2025-11-17 17:55:11,802][INFO] Iter   3750 | loss=0.0607 | td_err=0.0745 | kl=1.4033 | temp=0.469 | eps=0.153 | success=0.625 | hit=0.625 | stage2=0.938 | invalid_edge=0.125 | invalid_tok=0.000 | avg_ep_reward=1.988 | avg_path=11.06 | valid_steps=9.94
[2025-11-17 17:55:25,038][INFO] Iter   3800 | loss=0.0682 | td_err=0.0805 | kl=1.4945 | temp=0.475 | eps=0.152 | success=0.500 | hit=0.500 | stage2=0.969 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.777 | avg_path=11.75 | valid_steps=10.34
[2025-11-17 17:55:37,842][INFO] Iter   3850 | loss=0.0611 | td_err=0.0723 | kl=1.4750 | temp=0.481 | eps=0.152 | success=0.500 | hit=0.500 | stage2=1.000 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.803 | avg_path=12.06 | valid_steps=10.62
[2025-11-17 17:55:50,729][INFO] Iter   3900 | loss=0.0594 | td_err=0.0639 | kl=1.5134 | temp=0.487 | eps=0.151 | success=0.469 | hit=0.469 | stage2=0.875 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=1.745 | avg_path=11.00 | valid_steps=9.91
[2025-11-17 17:56:03,806][INFO] Iter   3950 | loss=0.0621 | td_err=0.0697 | kl=1.4606 | temp=0.494 | eps=0.151 | success=0.469 | hit=0.469 | stage2=0.969 | invalid_edge=0.125 | invalid_tok=0.000 | avg_ep_reward=1.856 | avg_path=12.03 | valid_steps=10.91
[2025-11-17 17:56:16,588][INFO] Iter   4000 | loss=0.0604 | td_err=0.0740 | kl=1.3799 | temp=0.500 | eps=0.150 | success=0.594 | hit=0.594 | stage2=0.875 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.825 | avg_path=10.69 | valid_steps=9.38
[2025-11-17 17:56:24,311][INFO] ---- Evaluation at iter 4000 ----
[2025-11-17 17:56:24,313][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 17:56:24,313][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 17:56:24,313][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 17:56:24,313][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 17:56:24,317][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251117_173956/ckpt_ql_4000.pt
[2025-11-17 17:56:37,437][INFO] Iter   4050 | loss=0.0602 | td_err=0.0776 | kl=1.3703 | temp=0.506 | eps=0.149 | success=0.500 | hit=0.500 | stage2=0.875 | invalid_edge=0.312 | invalid_tok=0.000 | avg_ep_reward=1.800 | avg_path=11.84 | valid_steps=10.53
[2025-11-17 17:56:50,513][INFO] Iter   4100 | loss=0.0715 | td_err=0.0898 | kl=1.3281 | temp=0.512 | eps=0.149 | success=0.562 | hit=0.562 | stage2=0.969 | invalid_edge=0.250 | invalid_tok=0.000 | avg_ep_reward=1.838 | avg_path=10.88 | valid_steps=9.62
[2025-11-17 17:57:03,458][INFO] Iter   4150 | loss=0.0694 | td_err=0.0786 | kl=1.4059 | temp=0.519 | eps=0.148 | success=0.406 | hit=0.406 | stage2=0.906 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=1.678 | avg_path=12.19 | valid_steps=10.81
[2025-11-17 17:57:16,233][INFO] Iter   4200 | loss=0.0537 | td_err=0.0606 | kl=1.4120 | temp=0.525 | eps=0.148 | success=0.500 | hit=0.500 | stage2=0.938 | invalid_edge=0.312 | invalid_tok=0.000 | avg_ep_reward=1.708 | avg_path=10.91 | valid_steps=9.56
[2025-11-17 17:57:28,732][INFO] Iter   4250 | loss=0.0663 | td_err=0.0774 | kl=1.4323 | temp=0.531 | eps=0.147 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.250 | invalid_tok=0.000 | avg_ep_reward=1.652 | avg_path=11.53 | valid_steps=10.25
[2025-11-17 17:57:41,469][INFO] Iter   4300 | loss=0.0493 | td_err=0.0598 | kl=1.2895 | temp=0.537 | eps=0.146 | success=0.562 | hit=0.562 | stage2=0.969 | invalid_edge=0.312 | invalid_tok=0.000 | avg_ep_reward=1.859 | avg_path=11.31 | valid_steps=10.00
[2025-11-17 17:57:54,177][INFO] Iter   4350 | loss=0.0583 | td_err=0.0680 | kl=1.4267 | temp=0.544 | eps=0.146 | success=0.344 | hit=0.344 | stage2=0.969 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=1.714 | avg_path=13.25 | valid_steps=11.91
[2025-11-17 17:58:06,948][INFO] Iter   4400 | loss=0.0444 | td_err=0.0673 | kl=1.1368 | temp=0.550 | eps=0.145 | success=0.781 | hit=0.781 | stage2=0.969 | invalid_edge=0.125 | invalid_tok=0.000 | avg_ep_reward=2.000 | avg_path=8.78 | valid_steps=7.66
[2025-11-17 17:58:19,807][INFO] Iter   4450 | loss=0.0469 | td_err=0.0633 | kl=1.2555 | temp=0.556 | eps=0.144 | success=0.562 | hit=0.562 | stage2=0.969 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.833 | avg_path=10.94 | valid_steps=9.66
[2025-11-17 17:58:32,720][INFO] Iter   4500 | loss=0.0481 | td_err=0.0699 | kl=1.2259 | temp=0.562 | eps=0.144 | success=0.594 | hit=0.594 | stage2=0.875 | invalid_edge=0.312 | invalid_tok=0.000 | avg_ep_reward=1.881 | avg_path=11.25 | valid_steps=9.94
[2025-11-17 17:58:45,554][INFO] Iter   4550 | loss=0.0484 | td_err=0.0642 | kl=1.3064 | temp=0.569 | eps=0.143 | success=0.500 | hit=0.500 | stage2=0.906 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.830 | avg_path=11.97 | valid_steps=10.69
[2025-11-17 17:58:58,328][INFO] Iter   4600 | loss=0.0498 | td_err=0.0723 | kl=1.3060 | temp=0.575 | eps=0.143 | success=0.594 | hit=0.594 | stage2=0.812 | invalid_edge=0.219 | invalid_tok=0.000 | avg_ep_reward=1.773 | avg_path=9.97 | valid_steps=8.75
[2025-11-17 17:59:10,743][INFO] Iter   4650 | loss=0.0433 | td_err=0.0602 | kl=1.1834 | temp=0.581 | eps=0.142 | success=0.656 | hit=0.656 | stage2=0.969 | invalid_edge=0.188 | invalid_tok=0.000 | avg_ep_reward=1.973 | avg_path=10.72 | valid_steps=9.50
[2025-11-17 17:59:23,523][INFO] Iter   4700 | loss=0.0471 | td_err=0.0618 | kl=1.3201 | temp=0.588 | eps=0.141 | success=0.469 | hit=0.469 | stage2=0.906 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=1.723 | avg_path=11.59 | valid_steps=10.25
[2025-11-17 17:59:36,297][INFO] Iter   4750 | loss=0.0409 | td_err=0.0504 | kl=1.1966 | temp=0.594 | eps=0.141 | success=0.625 | hit=0.625 | stage2=0.906 | invalid_edge=0.188 | invalid_tok=0.000 | avg_ep_reward=1.903 | avg_path=10.50 | valid_steps=9.31
[2025-11-17 17:59:49,177][INFO] Iter   4800 | loss=0.0433 | td_err=0.0593 | kl=1.2260 | temp=0.600 | eps=0.140 | success=0.594 | hit=0.594 | stage2=0.938 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.836 | avg_path=10.56 | valid_steps=9.28
[2025-11-17 18:00:01,819][INFO] Iter   4850 | loss=0.0446 | td_err=0.0604 | kl=1.2705 | temp=0.606 | eps=0.139 | success=0.594 | hit=0.594 | stage2=0.844 | invalid_edge=0.219 | invalid_tok=0.000 | avg_ep_reward=1.848 | avg_path=10.66 | valid_steps=9.44
[2025-11-17 18:00:14,982][INFO] Iter   4900 | loss=0.0521 | td_err=0.0637 | kl=1.2963 | temp=0.613 | eps=0.139 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.250 | invalid_tok=0.000 | avg_ep_reward=1.734 | avg_path=11.31 | valid_steps=10.06
[2025-11-17 18:00:27,331][INFO] Iter   4950 | loss=0.0423 | td_err=0.0589 | kl=1.2362 | temp=0.619 | eps=0.138 | success=0.500 | hit=0.500 | stage2=0.938 | invalid_edge=0.312 | invalid_tok=0.000 | avg_ep_reward=1.781 | avg_path=11.53 | valid_steps=10.22
[2025-11-17 18:00:39,992][INFO] Iter   5000 | loss=0.0565 | td_err=0.0690 | kl=1.2420 | temp=0.625 | eps=0.138 | success=0.688 | hit=0.688 | stage2=0.781 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=1.866 | avg_path=9.22 | valid_steps=8.09
[2025-11-17 18:00:47,689][INFO] ---- Evaluation at iter 5000 ----
[2025-11-17 18:00:47,690][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 18:00:47,690][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 18:00:47,690][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 18:00:47,690][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 18:01:00,523][INFO] Iter   5050 | loss=0.0448 | td_err=0.0692 | kl=1.2536 | temp=0.631 | eps=0.137 | success=0.531 | hit=0.531 | stage2=0.906 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.847 | avg_path=11.78 | valid_steps=10.47
[2025-11-17 18:01:13,423][INFO] Iter   5100 | loss=0.0512 | td_err=0.0689 | kl=1.3042 | temp=0.637 | eps=0.136 | success=0.531 | hit=0.531 | stage2=0.844 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.744 | avg_path=10.88 | valid_steps=9.56
[2025-11-17 18:01:26,091][INFO] Iter   5150 | loss=0.0533 | td_err=0.0654 | kl=1.3391 | temp=0.644 | eps=0.136 | success=0.562 | hit=0.562 | stage2=0.906 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.827 | avg_path=11.00 | valid_steps=9.72
[2025-11-17 18:01:38,815][INFO] Iter   5200 | loss=0.0676 | td_err=0.0789 | kl=1.3542 | temp=0.650 | eps=0.135 | success=0.406 | hit=0.406 | stage2=0.969 | invalid_edge=0.312 | invalid_tok=0.000 | avg_ep_reward=1.719 | avg_path=12.25 | valid_steps=10.94
[2025-11-17 18:01:51,500][INFO] Iter   5250 | loss=0.0401 | td_err=0.0634 | kl=1.1733 | temp=0.656 | eps=0.134 | success=0.625 | hit=0.625 | stage2=1.000 | invalid_edge=0.188 | invalid_tok=0.000 | avg_ep_reward=1.981 | avg_path=11.09 | valid_steps=9.91
[2025-11-17 18:02:04,277][INFO] Iter   5300 | loss=0.0489 | td_err=0.0686 | kl=1.2304 | temp=0.662 | eps=0.134 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.188 | invalid_tok=0.000 | avg_ep_reward=1.744 | avg_path=11.66 | valid_steps=10.47
[2025-11-17 18:02:17,075][INFO] Iter   5350 | loss=0.0546 | td_err=0.0745 | kl=1.5028 | temp=0.669 | eps=0.133 | success=0.250 | hit=0.250 | stage2=1.000 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.623 | avg_path=14.34 | valid_steps=12.81
[2025-11-17 18:02:29,539][INFO] Iter   5400 | loss=0.0528 | td_err=0.0749 | kl=1.2302 | temp=0.675 | eps=0.133 | success=0.562 | hit=0.562 | stage2=0.969 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.847 | avg_path=11.19 | valid_steps=9.88
[2025-11-17 18:02:41,985][INFO] Iter   5450 | loss=0.0433 | td_err=0.0744 | kl=1.1584 | temp=0.681 | eps=0.132 | success=0.656 | hit=0.656 | stage2=0.906 | invalid_edge=0.125 | invalid_tok=0.000 | avg_ep_reward=1.884 | avg_path=9.62 | valid_steps=8.50
[2025-11-17 18:02:54,643][INFO] Iter   5500 | loss=0.0466 | td_err=0.0653 | kl=1.3814 | temp=0.688 | eps=0.131 | success=0.406 | hit=0.406 | stage2=0.875 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.672 | avg_path=12.41 | valid_steps=10.97
[2025-11-17 18:03:07,152][INFO] Iter   5550 | loss=0.0408 | td_err=0.0661 | kl=1.2126 | temp=0.694 | eps=0.131 | success=0.594 | hit=0.594 | stage2=0.938 | invalid_edge=0.312 | invalid_tok=0.000 | avg_ep_reward=1.884 | avg_path=11.16 | valid_steps=9.84
[2025-11-17 18:03:19,470][INFO] Iter   5600 | loss=0.0389 | td_err=0.0645 | kl=1.1914 | temp=0.700 | eps=0.130 | success=0.594 | hit=0.594 | stage2=0.969 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.880 | avg_path=11.16 | valid_steps=9.81
[2025-11-17 18:03:31,847][INFO] Iter   5650 | loss=0.0369 | td_err=0.0612 | kl=1.1276 | temp=0.706 | eps=0.129 | success=0.625 | hit=0.625 | stage2=0.906 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=1.842 | avg_path=10.44 | valid_steps=9.09
[2025-11-17 18:03:44,665][INFO] Iter   5700 | loss=0.0474 | td_err=0.0743 | kl=1.2623 | temp=0.713 | eps=0.129 | success=0.500 | hit=0.500 | stage2=0.969 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.808 | avg_path=12.06 | valid_steps=10.66
[2025-11-17 18:03:57,385][INFO] Iter   5750 | loss=0.0406 | td_err=0.0689 | kl=1.1828 | temp=0.719 | eps=0.128 | success=0.625 | hit=0.625 | stage2=0.938 | invalid_edge=0.312 | invalid_tok=0.000 | avg_ep_reward=1.858 | avg_path=10.53 | valid_steps=9.19
[2025-11-17 18:04:10,043][INFO] Iter   5800 | loss=0.0425 | td_err=0.0792 | kl=1.1311 | temp=0.725 | eps=0.128 | success=0.656 | hit=0.656 | stage2=0.938 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=1.889 | avg_path=10.38 | valid_steps=9.03
[2025-11-17 18:04:22,131][INFO] Iter   5850 | loss=0.0423 | td_err=0.0799 | kl=1.1396 | temp=0.731 | eps=0.127 | success=0.688 | hit=0.688 | stage2=0.938 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.872 | avg_path=9.62 | valid_steps=8.31
[2025-11-17 18:04:34,350][INFO] Iter   5900 | loss=0.0567 | td_err=0.0988 | kl=1.2608 | temp=0.738 | eps=0.126 | success=0.531 | hit=0.531 | stage2=0.906 | invalid_edge=0.312 | invalid_tok=0.000 | avg_ep_reward=1.772 | avg_path=11.03 | valid_steps=9.72
[2025-11-17 18:04:46,788][INFO] Iter   5950 | loss=0.0530 | td_err=0.0913 | kl=1.2821 | temp=0.744 | eps=0.126 | success=0.562 | hit=0.562 | stage2=0.906 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=1.823 | avg_path=11.19 | valid_steps=9.84
[2025-11-17 18:04:59,221][INFO] Iter   6000 | loss=0.0540 | td_err=0.0778 | kl=1.5479 | temp=0.750 | eps=0.125 | success=0.375 | hit=0.375 | stage2=0.906 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.594 | avg_path=12.25 | valid_steps=10.75
[2025-11-17 18:05:06,848][INFO] ---- Evaluation at iter 6000 ----
[2025-11-17 18:05:06,850][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 18:05:06,850][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 18:05:06,850][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 18:05:06,850][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 18:05:06,855][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251117_173956/ckpt_ql_6000.pt
[2025-11-17 18:05:19,332][INFO] Iter   6050 | loss=0.0589 | td_err=0.0945 | kl=1.3462 | temp=0.756 | eps=0.124 | success=0.406 | hit=0.406 | stage2=0.906 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.688 | avg_path=12.50 | valid_steps=11.06
[2025-11-17 18:05:31,770][INFO] Iter   6100 | loss=0.0498 | td_err=0.0776 | kl=1.2953 | temp=0.762 | eps=0.124 | success=0.500 | hit=0.500 | stage2=0.844 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.678 | avg_path=10.91 | valid_steps=9.53
[2025-11-17 18:05:44,409][INFO] Iter   6150 | loss=0.0498 | td_err=0.0809 | kl=1.2465 | temp=0.769 | eps=0.123 | success=0.500 | hit=0.500 | stage2=0.875 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.763 | avg_path=11.69 | valid_steps=10.31
[2025-11-17 18:05:57,242][INFO] Iter   6200 | loss=0.0512 | td_err=0.1096 | kl=1.1158 | temp=0.775 | eps=0.122 | success=0.656 | hit=0.656 | stage2=0.906 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=1.889 | avg_path=10.66 | valid_steps=9.25
[2025-11-17 18:06:09,798][INFO] Iter   6250 | loss=0.0603 | td_err=0.1008 | kl=1.4905 | temp=0.781 | eps=0.122 | success=0.469 | hit=0.469 | stage2=0.906 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.683 | avg_path=11.41 | valid_steps=10.00
[2025-11-17 18:06:22,303][INFO] Iter   6300 | loss=0.0702 | td_err=0.1162 | kl=1.4728 | temp=0.787 | eps=0.121 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.691 | avg_path=12.25 | valid_steps=10.88
[2025-11-17 18:06:34,782][INFO] Iter   6350 | loss=0.0548 | td_err=0.0967 | kl=1.3631 | temp=0.794 | eps=0.121 | success=0.344 | hit=0.344 | stage2=0.844 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.550 | avg_path=12.41 | valid_steps=10.91
[2025-11-17 18:06:47,240][INFO] Iter   6400 | loss=0.0651 | td_err=0.1065 | kl=1.2045 | temp=0.800 | eps=0.120 | success=0.625 | hit=0.625 | stage2=0.969 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.873 | avg_path=10.41 | valid_steps=9.12
[2025-11-17 18:06:59,752][INFO] Iter   6450 | loss=0.0553 | td_err=0.0924 | kl=1.3845 | temp=0.806 | eps=0.119 | success=0.469 | hit=0.469 | stage2=0.969 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.719 | avg_path=12.19 | valid_steps=10.62
[2025-11-17 18:07:12,258][INFO] Iter   6500 | loss=0.0499 | td_err=0.0916 | kl=1.3651 | temp=0.812 | eps=0.119 | success=0.500 | hit=0.500 | stage2=0.875 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.731 | avg_path=11.59 | valid_steps=10.16
[2025-11-17 18:07:24,805][INFO] Iter   6550 | loss=0.0380 | td_err=0.0716 | kl=1.2415 | temp=0.819 | eps=0.118 | success=0.625 | hit=0.625 | stage2=0.906 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.811 | avg_path=10.34 | valid_steps=8.94
[2025-11-17 18:07:37,402][INFO] Iter   6600 | loss=0.1110 | td_err=0.1095 | kl=1.2443 | temp=0.825 | eps=0.117 | success=0.562 | hit=0.562 | stage2=0.906 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.788 | avg_path=11.16 | valid_steps=9.72
[2025-11-17 18:07:50,113][INFO] Iter   6650 | loss=0.0463 | td_err=0.0884 | kl=1.3083 | temp=0.831 | eps=0.117 | success=0.594 | hit=0.594 | stage2=0.812 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.753 | avg_path=10.31 | valid_steps=8.94
[2025-11-17 18:08:02,759][INFO] Iter   6700 | loss=0.0469 | td_err=0.0871 | kl=1.3549 | temp=0.838 | eps=0.116 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.709 | avg_path=10.78 | valid_steps=9.34
[2025-11-17 18:08:15,361][INFO] Iter   6750 | loss=0.0641 | td_err=0.0946 | kl=1.2850 | temp=0.844 | eps=0.116 | success=0.594 | hit=0.594 | stage2=0.938 | invalid_edge=0.312 | invalid_tok=0.000 | avg_ep_reward=1.753 | avg_path=9.84 | valid_steps=8.53
[2025-11-17 18:08:27,824][INFO] Iter   6800 | loss=0.0613 | td_err=0.0992 | kl=1.3708 | temp=0.850 | eps=0.115 | success=0.656 | hit=0.656 | stage2=0.875 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.780 | avg_path=9.19 | valid_steps=7.91
[2025-11-17 18:08:40,188][INFO] Iter   6850 | loss=0.0518 | td_err=0.0882 | kl=1.5385 | temp=0.856 | eps=0.114 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.659 | avg_path=12.38 | valid_steps=10.88
[2025-11-17 18:08:52,763][INFO] Iter   6900 | loss=0.0499 | td_err=0.0752 | kl=1.7075 | temp=0.863 | eps=0.114 | success=0.281 | hit=0.281 | stage2=0.938 | invalid_edge=0.594 | invalid_tok=0.000 | avg_ep_reward=1.542 | avg_path=13.41 | valid_steps=11.81
[2025-11-17 18:09:05,395][INFO] Iter   6950 | loss=0.0421 | td_err=0.0797 | kl=1.3233 | temp=0.869 | eps=0.113 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.656 | avg_path=11.44 | valid_steps=10.06
[2025-11-17 18:09:18,078][INFO] Iter   7000 | loss=1.0517 | td_err=0.2322 | kl=1.4279 | temp=0.875 | eps=0.112 | success=0.625 | hit=0.625 | stage2=0.906 | invalid_edge=0.094 | invalid_tok=0.000 | avg_ep_reward=1.808 | avg_path=9.22 | valid_steps=8.12
[2025-11-17 18:09:25,654][INFO] ---- Evaluation at iter 7000 ----
[2025-11-17 18:09:25,655][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 18:09:25,655][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 18:09:25,655][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 18:09:25,655][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 18:09:38,405][INFO] Iter   7050 | loss=0.0361 | td_err=0.0744 | kl=1.2090 | temp=0.881 | eps=0.112 | success=0.656 | hit=0.656 | stage2=0.969 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.948 | avg_path=10.69 | valid_steps=9.41
[2025-11-17 18:09:51,358][INFO] Iter   7100 | loss=0.0638 | td_err=0.1106 | kl=1.2700 | temp=0.887 | eps=0.111 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.797 | avg_path=11.66 | valid_steps=10.22
[2025-11-17 18:10:04,374][INFO] Iter   7150 | loss=0.0459 | td_err=0.0805 | kl=1.4389 | temp=0.894 | eps=0.111 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=1.697 | avg_path=12.50 | valid_steps=10.94
[2025-11-17 18:10:17,208][INFO] Iter   7200 | loss=0.1281 | td_err=0.1142 | kl=1.2848 | temp=0.900 | eps=0.110 | success=0.594 | hit=0.594 | stage2=0.969 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=1.825 | avg_path=10.72 | valid_steps=9.34
[2025-11-17 18:10:30,045][INFO] Iter   7250 | loss=0.1760 | td_err=0.1403 | kl=1.7650 | temp=0.906 | eps=0.109 | success=0.219 | hit=0.219 | stage2=1.000 | invalid_edge=0.750 | invalid_tok=0.000 | avg_ep_reward=1.473 | avg_path=14.19 | valid_steps=12.41
[2025-11-17 18:10:42,692][INFO] Iter   7300 | loss=0.1878 | td_err=0.1026 | kl=1.5100 | temp=0.912 | eps=0.109 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.738 | avg_path=12.69 | valid_steps=11.19
[2025-11-17 18:10:55,670][INFO] Iter   7350 | loss=0.0382 | td_err=0.0727 | kl=1.3971 | temp=0.919 | eps=0.108 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.748 | avg_path=12.22 | valid_steps=10.75
[2025-11-17 18:11:08,440][INFO] Iter   7400 | loss=0.0502 | td_err=0.0860 | kl=1.4594 | temp=0.925 | eps=0.107 | success=0.469 | hit=0.469 | stage2=0.906 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.703 | avg_path=11.94 | valid_steps=10.44
[2025-11-17 18:11:21,593][INFO] Iter   7450 | loss=0.0362 | td_err=0.0776 | kl=1.2727 | temp=0.931 | eps=0.107 | success=0.625 | hit=0.625 | stage2=0.938 | invalid_edge=0.312 | invalid_tok=0.000 | avg_ep_reward=1.853 | avg_path=10.38 | valid_steps=9.06
[2025-11-17 18:11:34,477][INFO] Iter   7500 | loss=0.1329 | td_err=0.1289 | kl=1.4454 | temp=0.938 | eps=0.106 | success=0.375 | hit=0.375 | stage2=0.906 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.572 | avg_path=11.59 | valid_steps=10.22
[2025-11-17 18:11:47,264][INFO] Iter   7550 | loss=0.0469 | td_err=0.0897 | kl=1.5085 | temp=0.944 | eps=0.106 | success=0.406 | hit=0.406 | stage2=0.906 | invalid_edge=0.594 | invalid_tok=0.000 | avg_ep_reward=1.664 | avg_path=12.81 | valid_steps=11.22
[2025-11-17 18:12:00,074][INFO] Iter   7600 | loss=0.0663 | td_err=0.1177 | kl=1.2144 | temp=0.950 | eps=0.105 | success=0.594 | hit=0.594 | stage2=0.938 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.842 | avg_path=11.06 | valid_steps=9.66
[2025-11-17 18:12:12,822][INFO] Iter   7650 | loss=0.0454 | td_err=0.0914 | kl=1.2805 | temp=0.956 | eps=0.104 | success=0.500 | hit=0.500 | stage2=0.969 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=1.777 | avg_path=11.53 | valid_steps=10.19
[2025-11-17 18:12:25,436][INFO] Iter   7700 | loss=0.0436 | td_err=0.0888 | kl=1.3836 | temp=0.963 | eps=0.104 | success=0.531 | hit=0.531 | stage2=0.875 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.766 | avg_path=11.47 | valid_steps=10.03
[2025-11-17 18:12:38,265][INFO] Iter   7750 | loss=0.0418 | td_err=0.0858 | kl=1.3683 | temp=0.969 | eps=0.103 | success=0.469 | hit=0.469 | stage2=0.875 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.714 | avg_path=12.00 | valid_steps=10.53
[2025-11-17 18:12:51,225][INFO] Iter   7800 | loss=0.1210 | td_err=0.1114 | kl=1.4743 | temp=0.975 | eps=0.102 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.594 | invalid_tok=0.000 | avg_ep_reward=1.713 | avg_path=13.34 | valid_steps=11.72
[2025-11-17 18:13:04,136][INFO] Iter   7850 | loss=0.0494 | td_err=0.0839 | kl=1.5914 | temp=0.981 | eps=0.102 | success=0.375 | hit=0.375 | stage2=0.938 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.692 | avg_path=13.28 | valid_steps=11.75
[2025-11-17 18:13:17,042][INFO] Iter   7900 | loss=0.0378 | td_err=0.0799 | kl=1.1779 | temp=0.988 | eps=0.101 | success=0.562 | hit=0.562 | stage2=0.906 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.822 | avg_path=11.50 | valid_steps=10.06
[2025-11-17 18:13:29,985][INFO] Iter   7950 | loss=0.2154 | td_err=0.1071 | kl=1.3043 | temp=0.994 | eps=0.101 | success=0.438 | hit=0.438 | stage2=0.906 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=1.636 | avg_path=11.19 | valid_steps=9.84
[2025-11-17 18:13:42,765][INFO] Iter   8000 | loss=0.0746 | td_err=0.0895 | kl=1.3571 | temp=1.000 | eps=0.100 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.681 | avg_path=11.44 | valid_steps=10.00
[2025-11-17 18:13:50,445][INFO] ---- Evaluation at iter 8000 ----
[2025-11-17 18:13:50,446][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 18:13:50,446][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 18:13:50,446][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 18:13:50,446][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 18:13:50,451][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251117_173956/ckpt_ql_8000.pt
[2025-11-17 18:14:03,268][INFO] Iter   8050 | loss=0.0351 | td_err=0.0776 | kl=1.2029 | temp=1.000 | eps=0.099 | success=0.625 | hit=0.625 | stage2=0.906 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.844 | avg_path=10.56 | valid_steps=9.19
[2025-11-17 18:14:16,453][INFO] Iter   8100 | loss=0.1462 | td_err=0.1164 | kl=1.0327 | temp=1.000 | eps=0.099 | success=0.750 | hit=0.750 | stage2=0.938 | invalid_edge=0.250 | invalid_tok=0.000 | avg_ep_reward=2.041 | avg_path=10.16 | valid_steps=8.91
[2025-11-17 18:14:29,605][INFO] Iter   8150 | loss=0.1983 | td_err=0.1237 | kl=1.3115 | temp=1.000 | eps=0.098 | success=0.500 | hit=0.500 | stage2=0.906 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.753 | avg_path=11.75 | valid_steps=10.31
[2025-11-17 18:14:42,524][INFO] Iter   8200 | loss=0.0291 | td_err=0.0666 | kl=1.2554 | temp=1.000 | eps=0.097 | success=0.500 | hit=0.500 | stage2=0.906 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.706 | avg_path=11.28 | valid_steps=9.84
[2025-11-17 18:14:55,291][INFO] Iter   8250 | loss=0.0387 | td_err=0.0807 | kl=1.3320 | temp=1.000 | eps=0.097 | success=0.562 | hit=0.562 | stage2=0.875 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.688 | avg_path=10.22 | valid_steps=8.78
[2025-11-17 18:15:08,359][INFO] Iter   8300 | loss=0.0303 | td_err=0.0723 | kl=1.3098 | temp=1.000 | eps=0.096 | success=0.438 | hit=0.438 | stage2=1.000 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.713 | avg_path=12.31 | valid_steps=10.81
[2025-11-17 18:15:21,197][INFO] Iter   8350 | loss=0.0260 | td_err=0.0639 | kl=1.1364 | temp=1.000 | eps=0.096 | success=0.562 | hit=0.562 | stage2=0.906 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.745 | avg_path=10.62 | valid_steps=9.22
[2025-11-17 18:15:34,183][INFO] Iter   8400 | loss=0.4212 | td_err=0.1370 | kl=1.1389 | temp=1.000 | eps=0.095 | success=0.500 | hit=0.500 | stage2=0.938 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.770 | avg_path=11.31 | valid_steps=10.03
[2025-11-17 18:15:47,172][INFO] Iter   8450 | loss=0.0331 | td_err=0.0749 | kl=1.3742 | temp=1.000 | eps=0.094 | success=0.375 | hit=0.375 | stage2=1.000 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=1.664 | avg_path=13.09 | valid_steps=11.50
[2025-11-17 18:16:00,207][INFO] Iter   8500 | loss=0.0272 | td_err=0.0733 | kl=1.0380 | temp=1.000 | eps=0.094 | success=0.656 | hit=0.656 | stage2=0.875 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.936 | avg_path=10.75 | valid_steps=9.47
[2025-11-17 18:16:13,255][INFO] Iter   8550 | loss=0.0347 | td_err=0.0773 | kl=1.2974 | temp=1.000 | eps=0.093 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.739 | avg_path=12.34 | valid_steps=10.81
[2025-11-17 18:16:26,390][INFO] Iter   8600 | loss=0.0318 | td_err=0.0798 | kl=1.2623 | temp=1.000 | eps=0.092 | success=0.469 | hit=0.469 | stage2=0.906 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.706 | avg_path=11.75 | valid_steps=10.31
[2025-11-17 18:16:39,495][INFO] Iter   8650 | loss=0.0318 | td_err=0.0776 | kl=1.2299 | temp=1.000 | eps=0.092 | success=0.562 | hit=0.562 | stage2=0.812 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.739 | avg_path=10.97 | valid_steps=9.50
[2025-11-17 18:16:52,690][INFO] Iter   8700 | loss=0.2647 | td_err=0.1043 | kl=1.2975 | temp=1.000 | eps=0.091 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.756 | avg_path=11.03 | valid_steps=9.66
[2025-11-17 18:17:05,741][INFO] Iter   8750 | loss=0.0298 | td_err=0.0727 | kl=1.2233 | temp=1.000 | eps=0.091 | success=0.469 | hit=0.469 | stage2=0.906 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.673 | avg_path=11.31 | valid_steps=9.91
[2025-11-17 18:17:18,686][INFO] Iter   8800 | loss=0.0299 | td_err=0.0655 | kl=1.2661 | temp=1.000 | eps=0.090 | success=0.406 | hit=0.406 | stage2=0.875 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=1.647 | avg_path=12.59 | valid_steps=11.03
[2025-11-17 18:17:31,701][INFO] Iter   8850 | loss=0.0237 | td_err=0.0607 | kl=1.1801 | temp=1.000 | eps=0.089 | success=0.562 | hit=0.562 | stage2=0.875 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.747 | avg_path=10.81 | valid_steps=9.38
[2025-11-17 18:17:44,685][INFO] Iter   8900 | loss=0.1209 | td_err=0.0729 | kl=1.0962 | temp=1.000 | eps=0.089 | success=0.625 | hit=0.625 | stage2=0.969 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.848 | avg_path=10.16 | valid_steps=8.88
[2025-11-17 18:17:57,828][INFO] Iter   8950 | loss=0.1639 | td_err=0.0889 | kl=1.1822 | temp=1.000 | eps=0.088 | success=0.406 | hit=0.406 | stage2=0.844 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.630 | avg_path=12.38 | valid_steps=10.84
[2025-11-17 18:18:10,897][INFO] Iter   9000 | loss=0.0235 | td_err=0.0636 | kl=1.2707 | temp=1.000 | eps=0.087 | success=0.500 | hit=0.500 | stage2=1.000 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.775 | avg_path=11.78 | valid_steps=10.34
[2025-11-17 18:18:18,702][INFO] ---- Evaluation at iter 9000 ----
[2025-11-17 18:18:18,704][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 18:18:18,704][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 18:18:18,704][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 18:18:18,704][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 18:18:31,883][INFO] Iter   9050 | loss=0.0242 | td_err=0.0639 | kl=1.1078 | temp=1.000 | eps=0.087 | success=0.531 | hit=0.531 | stage2=0.906 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=1.730 | avg_path=10.72 | valid_steps=9.38
[2025-11-17 18:18:45,004][INFO] Iter   9100 | loss=0.0283 | td_err=0.0733 | kl=1.2722 | temp=1.000 | eps=0.086 | success=0.375 | hit=0.375 | stage2=1.000 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.622 | avg_path=12.56 | valid_steps=11.00
[2025-11-17 18:18:58,066][INFO] Iter   9150 | loss=0.0238 | td_err=0.0589 | kl=1.2414 | temp=1.000 | eps=0.086 | success=0.438 | hit=0.438 | stage2=0.969 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.742 | avg_path=12.78 | valid_steps=11.25
[2025-11-17 18:19:10,936][INFO] Iter   9200 | loss=0.0232 | td_err=0.0673 | kl=1.1212 | temp=1.000 | eps=0.085 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=1.678 | avg_path=12.78 | valid_steps=11.22
[2025-11-17 18:19:23,772][INFO] Iter   9250 | loss=0.0217 | td_err=0.0635 | kl=1.1693 | temp=1.000 | eps=0.084 | success=0.406 | hit=0.406 | stage2=0.906 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.595 | avg_path=11.91 | valid_steps=10.38
[2025-11-17 18:19:36,523][INFO] Iter   9300 | loss=0.6712 | td_err=0.1603 | kl=1.2977 | temp=1.000 | eps=0.084 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.594 | avg_path=11.28 | valid_steps=9.91
[2025-11-17 18:19:49,388][INFO] Iter   9350 | loss=0.0213 | td_err=0.0559 | kl=1.2025 | temp=1.000 | eps=0.083 | success=0.500 | hit=0.500 | stage2=0.938 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.742 | avg_path=11.69 | valid_steps=10.22
[2025-11-17 18:20:02,212][INFO] Iter   9400 | loss=0.0198 | td_err=0.0583 | kl=1.2131 | temp=1.000 | eps=0.082 | success=0.500 | hit=0.500 | stage2=0.938 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.780 | avg_path=12.06 | valid_steps=10.59
[2025-11-17 18:20:15,423][INFO] Iter   9450 | loss=0.0268 | td_err=0.0748 | kl=1.3226 | temp=1.000 | eps=0.082 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.600 | avg_path=11.56 | valid_steps=10.12
[2025-11-17 18:20:28,354][INFO] Iter   9500 | loss=0.0169 | td_err=0.0482 | kl=1.1931 | temp=1.000 | eps=0.081 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.808 | avg_path=11.66 | valid_steps=10.25
[2025-11-17 18:20:41,387][INFO] Iter   9550 | loss=0.0243 | td_err=0.0636 | kl=1.1150 | temp=1.000 | eps=0.081 | success=0.500 | hit=0.500 | stage2=0.906 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.748 | avg_path=11.81 | valid_steps=10.34
[2025-11-17 18:20:54,430][INFO] Iter   9600 | loss=0.0217 | td_err=0.0578 | kl=1.1134 | temp=1.000 | eps=0.080 | success=0.531 | hit=0.531 | stage2=0.906 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.809 | avg_path=11.84 | valid_steps=10.41
[2025-11-17 18:21:07,440][INFO] Iter   9650 | loss=0.0208 | td_err=0.0692 | kl=1.0224 | temp=1.000 | eps=0.079 | success=0.531 | hit=0.531 | stage2=1.000 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.819 | avg_path=11.75 | valid_steps=10.31
[2025-11-17 18:21:20,485][INFO] Iter   9700 | loss=0.0176 | td_err=0.0551 | kl=1.1331 | temp=1.000 | eps=0.079 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=1.738 | avg_path=12.91 | valid_steps=11.34
[2025-11-17 18:21:33,640][INFO] Iter   9750 | loss=0.0167 | td_err=0.0563 | kl=1.1160 | temp=1.000 | eps=0.078 | success=0.438 | hit=0.438 | stage2=0.969 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.759 | avg_path=12.84 | valid_steps=11.34
[2025-11-17 18:21:46,525][INFO] Iter   9800 | loss=0.0144 | td_err=0.0454 | kl=1.1205 | temp=1.000 | eps=0.077 | success=0.406 | hit=0.406 | stage2=1.000 | invalid_edge=0.594 | invalid_tok=0.000 | avg_ep_reward=1.683 | avg_path=12.81 | valid_steps=11.22
[2025-11-17 18:21:59,572][INFO] Iter   9850 | loss=0.0186 | td_err=0.0614 | kl=1.1666 | temp=1.000 | eps=0.077 | success=0.375 | hit=0.375 | stage2=0.906 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=1.616 | avg_path=12.69 | valid_steps=11.12
[2025-11-17 18:22:12,527][INFO] Iter   9900 | loss=0.2031 | td_err=0.0844 | kl=1.1305 | temp=1.000 | eps=0.076 | success=0.562 | hit=0.562 | stage2=0.969 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.836 | avg_path=11.41 | valid_steps=10.00
[2025-11-17 18:22:25,525][INFO] Iter   9950 | loss=0.0163 | td_err=0.0585 | kl=1.0927 | temp=1.000 | eps=0.076 | success=0.594 | hit=0.594 | stage2=0.938 | invalid_edge=0.312 | invalid_tok=0.000 | avg_ep_reward=1.850 | avg_path=10.81 | valid_steps=9.50
[2025-11-17 18:22:38,642][INFO] Iter  10000 | loss=0.0165 | td_err=0.0534 | kl=1.0835 | temp=1.000 | eps=0.075 | success=0.562 | hit=0.562 | stage2=0.906 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.802 | avg_path=11.19 | valid_steps=9.78
[2025-11-17 18:22:46,252][INFO] ---- Evaluation at iter 10000 ----
[2025-11-17 18:22:46,253][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 18:22:46,253][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 18:22:46,253][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 18:22:46,253][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 18:22:46,258][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251117_173956/ckpt_ql_10000.pt
[2025-11-17 18:22:59,237][INFO] Iter  10050 | loss=0.1782 | td_err=0.0856 | kl=1.3069 | temp=1.000 | eps=0.074 | success=0.375 | hit=0.375 | stage2=1.000 | invalid_edge=0.594 | invalid_tok=0.000 | avg_ep_reward=1.667 | avg_path=13.12 | valid_steps=11.53
[2025-11-17 18:23:12,207][INFO] Iter  10100 | loss=0.0161 | td_err=0.0567 | kl=1.2722 | temp=1.000 | eps=0.074 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.742 | avg_path=12.84 | valid_steps=11.31
[2025-11-17 18:23:25,116][INFO] Iter  10150 | loss=0.0177 | td_err=0.0584 | kl=1.2683 | temp=1.000 | eps=0.073 | success=0.375 | hit=0.375 | stage2=1.000 | invalid_edge=0.594 | invalid_tok=0.000 | avg_ep_reward=1.680 | avg_path=13.25 | valid_steps=11.66
[2025-11-17 18:23:38,085][INFO] Iter  10200 | loss=0.0198 | td_err=0.0571 | kl=1.0634 | temp=1.000 | eps=0.073 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.756 | avg_path=11.47 | valid_steps=9.97
[2025-11-17 18:23:51,152][INFO] Iter  10250 | loss=0.0834 | td_err=0.0838 | kl=1.0466 | temp=1.000 | eps=0.072 | success=0.562 | hit=0.562 | stage2=0.875 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=1.811 | avg_path=11.12 | valid_steps=9.78
[2025-11-17 18:24:04,268][INFO] Iter  10300 | loss=0.0141 | td_err=0.0533 | kl=1.1076 | temp=1.000 | eps=0.071 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.756 | avg_path=12.41 | valid_steps=10.91
[2025-11-17 18:24:17,466][INFO] Iter  10350 | loss=0.0135 | td_err=0.0493 | kl=0.9633 | temp=1.000 | eps=0.071 | success=0.562 | hit=0.562 | stage2=0.938 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.853 | avg_path=11.53 | valid_steps=10.16
[2025-11-17 18:24:30,901][INFO] Iter  10400 | loss=0.0180 | td_err=0.0571 | kl=1.2500 | temp=1.000 | eps=0.070 | success=0.375 | hit=0.375 | stage2=0.938 | invalid_edge=0.594 | invalid_tok=0.000 | avg_ep_reward=1.634 | avg_path=13.03 | valid_steps=11.41
[2025-11-17 18:24:44,032][INFO] Iter  10450 | loss=0.0141 | td_err=0.0469 | kl=1.0621 | temp=1.000 | eps=0.069 | success=0.594 | hit=0.594 | stage2=0.906 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=1.758 | avg_path=10.06 | valid_steps=8.72
[2025-11-17 18:24:56,985][INFO] Iter  10500 | loss=0.0127 | td_err=0.0508 | kl=1.1631 | temp=1.000 | eps=0.069 | success=0.312 | hit=0.312 | stage2=1.000 | invalid_edge=0.688 | invalid_tok=0.000 | avg_ep_reward=1.641 | avg_path=14.12 | valid_steps=12.44
[2025-11-17 18:25:10,210][INFO] Iter  10550 | loss=0.3446 | td_err=0.1075 | kl=1.2266 | temp=1.000 | eps=0.068 | success=0.375 | hit=0.375 | stage2=1.000 | invalid_edge=0.625 | invalid_tok=0.000 | avg_ep_reward=1.652 | avg_path=13.19 | valid_steps=11.53
[2025-11-17 18:25:23,439][INFO] Iter  10600 | loss=0.2406 | td_err=0.1090 | kl=1.2209 | temp=1.000 | eps=0.068 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.719 | avg_path=12.25 | valid_steps=10.69
[2025-11-17 18:25:36,504][INFO] Iter  10650 | loss=0.1162 | td_err=0.0812 | kl=1.1185 | temp=1.000 | eps=0.067 | success=0.656 | hit=0.656 | stage2=0.844 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=1.853 | avg_path=10.31 | valid_steps=8.94
[2025-11-17 18:25:49,677][INFO] Iter  10700 | loss=0.0103 | td_err=0.0488 | kl=1.1684 | temp=1.000 | eps=0.066 | success=0.500 | hit=0.500 | stage2=0.938 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.745 | avg_path=11.72 | valid_steps=10.25
[2025-11-17 18:26:02,848][INFO] Iter  10750 | loss=0.0239 | td_err=0.0668 | kl=1.5748 | temp=1.000 | eps=0.066 | success=0.469 | hit=0.469 | stage2=1.000 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.781 | avg_path=12.53 | valid_steps=11.03
[2025-11-17 18:26:16,018][INFO] Iter  10800 | loss=0.0111 | td_err=0.0481 | kl=1.2471 | temp=1.000 | eps=0.065 | success=0.531 | hit=0.531 | stage2=0.844 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.755 | avg_path=11.53 | valid_steps=10.06
[2025-11-17 18:26:29,209][INFO] Iter  10850 | loss=0.0113 | td_err=0.0486 | kl=1.0864 | temp=1.000 | eps=0.064 | success=0.656 | hit=0.656 | stage2=0.906 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=1.895 | avg_path=10.50 | valid_steps=9.16
[2025-11-17 18:26:42,706][INFO] Iter  10900 | loss=0.0163 | td_err=0.0662 | kl=1.2918 | temp=1.000 | eps=0.064 | success=0.500 | hit=0.500 | stage2=0.969 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.822 | avg_path=12.53 | valid_steps=11.03
[2025-11-17 18:26:55,951][INFO] Iter  10950 | loss=0.0208 | td_err=0.0611 | kl=1.2413 | temp=1.000 | eps=0.063 | success=0.531 | hit=0.531 | stage2=1.000 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.842 | avg_path=12.09 | valid_steps=10.62
[2025-11-17 18:27:09,307][INFO] Iter  11000 | loss=0.0100 | td_err=0.0491 | kl=1.1791 | temp=1.000 | eps=0.062 | success=0.594 | hit=0.594 | stage2=0.906 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.825 | avg_path=10.84 | valid_steps=9.47
[2025-11-17 18:27:17,024][INFO] ---- Evaluation at iter 11000 ----
[2025-11-17 18:27:17,026][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 18:27:17,026][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 18:27:17,026][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 18:27:17,026][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 18:27:30,237][INFO] Iter  11050 | loss=0.0258 | td_err=0.0620 | kl=1.3275 | temp=1.000 | eps=0.062 | success=0.500 | hit=0.500 | stage2=0.875 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.709 | avg_path=11.38 | valid_steps=9.94
[2025-11-17 18:27:43,652][INFO] Iter  11100 | loss=0.3306 | td_err=0.1287 | kl=1.4502 | temp=1.000 | eps=0.061 | success=0.500 | hit=0.500 | stage2=0.875 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.677 | avg_path=11.38 | valid_steps=9.84
[2025-11-17 18:27:56,797][INFO] Iter  11150 | loss=0.0107 | td_err=0.0577 | kl=1.4338 | temp=1.000 | eps=0.061 | success=0.500 | hit=0.500 | stage2=0.969 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.747 | avg_path=11.78 | valid_steps=10.28
[2025-11-17 18:28:09,941][INFO] Iter  11200 | loss=0.0110 | td_err=0.0561 | kl=1.0975 | temp=1.000 | eps=0.060 | success=0.688 | hit=0.688 | stage2=0.875 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.939 | avg_path=10.31 | valid_steps=9.03
[2025-11-17 18:28:23,088][INFO] Iter  11250 | loss=0.0143 | td_err=0.0559 | kl=1.1907 | temp=1.000 | eps=0.059 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.820 | avg_path=11.78 | valid_steps=10.38
[2025-11-17 18:28:36,422][INFO] Iter  11300 | loss=0.0093 | td_err=0.0493 | kl=1.4105 | temp=1.000 | eps=0.059 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.755 | avg_path=11.34 | valid_steps=9.88
[2025-11-17 18:28:49,617][INFO] Iter  11350 | loss=0.0454 | td_err=0.0800 | kl=1.4052 | temp=1.000 | eps=0.058 | success=0.594 | hit=0.594 | stage2=0.938 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.798 | avg_path=10.62 | valid_steps=9.22
[2025-11-17 18:29:03,009][INFO] Iter  11400 | loss=0.0128 | td_err=0.0631 | kl=1.3341 | temp=1.000 | eps=0.057 | success=0.469 | hit=0.469 | stage2=1.000 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.777 | avg_path=12.59 | valid_steps=11.06
[2025-11-17 18:29:16,332][INFO] Iter  11450 | loss=0.0107 | td_err=0.0571 | kl=1.3372 | temp=1.000 | eps=0.057 | success=0.562 | hit=0.562 | stage2=0.812 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.758 | avg_path=10.94 | valid_steps=9.53
[2025-11-17 18:29:29,444][INFO] Iter  11500 | loss=0.0144 | td_err=0.0597 | kl=1.3848 | temp=1.000 | eps=0.056 | success=0.438 | hit=0.438 | stage2=0.906 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.683 | avg_path=12.09 | valid_steps=10.62
[2025-11-17 18:29:42,473][INFO] Iter  11550 | loss=0.0150 | td_err=0.0687 | kl=1.5227 | temp=1.000 | eps=0.056 | success=0.562 | hit=0.562 | stage2=0.969 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.828 | avg_path=11.44 | valid_steps=10.00
[2025-11-17 18:29:55,689][INFO] Iter  11600 | loss=0.1413 | td_err=0.1129 | kl=1.5783 | temp=1.000 | eps=0.055 | success=0.344 | hit=0.344 | stage2=0.938 | invalid_edge=0.656 | invalid_tok=0.000 | avg_ep_reward=1.656 | avg_path=13.94 | valid_steps=12.25
[2025-11-17 18:30:08,997][INFO] Iter  11650 | loss=0.1687 | td_err=0.1257 | kl=1.5715 | temp=1.000 | eps=0.054 | success=0.375 | hit=0.375 | stage2=1.000 | invalid_edge=0.625 | invalid_tok=0.000 | avg_ep_reward=1.664 | avg_path=13.31 | valid_steps=11.66
[2025-11-17 18:30:21,950][INFO] Iter  11700 | loss=0.1301 | td_err=0.0926 | kl=1.3566 | temp=1.000 | eps=0.054 | success=0.625 | hit=0.625 | stage2=0.812 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.897 | avg_path=11.28 | valid_steps=9.91
[2025-11-17 18:30:35,097][INFO] Iter  11750 | loss=0.0411 | td_err=0.0853 | kl=1.6535 | temp=1.000 | eps=0.053 | success=0.344 | hit=0.344 | stage2=0.938 | invalid_edge=0.594 | invalid_tok=0.000 | avg_ep_reward=1.541 | avg_path=12.56 | valid_steps=10.94
[2025-11-17 18:30:48,036][INFO] Iter  11800 | loss=0.0159 | td_err=0.0750 | kl=1.4663 | temp=1.000 | eps=0.052 | success=0.562 | hit=0.562 | stage2=0.875 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.788 | avg_path=11.22 | valid_steps=9.78
[2025-11-17 18:31:01,270][INFO] Iter  11850 | loss=0.0459 | td_err=0.0824 | kl=1.6071 | temp=1.000 | eps=0.052 | success=0.344 | hit=0.344 | stage2=0.969 | invalid_edge=0.625 | invalid_tok=0.000 | avg_ep_reward=1.561 | avg_path=12.81 | valid_steps=11.16
[2025-11-17 18:31:14,372][INFO] Iter  11900 | loss=0.0089 | td_err=0.0622 | kl=1.3422 | temp=1.000 | eps=0.051 | success=0.594 | hit=0.594 | stage2=0.938 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.861 | avg_path=11.25 | valid_steps=9.84
[2025-11-17 18:31:27,817][INFO] Iter  11950 | loss=0.0067 | td_err=0.0574 | kl=1.6062 | temp=1.000 | eps=0.051 | success=0.531 | hit=0.531 | stage2=0.875 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.783 | avg_path=11.75 | valid_steps=10.28
[2025-11-17 18:31:41,185][INFO] Iter  12000 | loss=0.0451 | td_err=0.0845 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.938 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.780 | avg_path=12.28 | valid_steps=10.75
[2025-11-17 18:31:48,909][INFO] ---- Evaluation at iter 12000 ----
[2025-11-17 18:31:48,910][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 18:31:48,910][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 18:31:48,910][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 18:31:48,910][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 18:31:48,915][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251117_173956/ckpt_ql_12000.pt
[2025-11-17 18:32:01,466][INFO] Iter  12050 | loss=0.0141 | td_err=0.0675 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.375 | hit=0.375 | stage2=1.000 | invalid_edge=0.625 | invalid_tok=0.000 | avg_ep_reward=1.672 | avg_path=13.28 | valid_steps=11.66
[2025-11-17 18:32:13,887][INFO] Iter  12100 | loss=0.0077 | td_err=0.0553 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.688 | hit=0.688 | stage2=0.938 | invalid_edge=0.281 | invalid_tok=0.000 | avg_ep_reward=1.942 | avg_path=10.22 | valid_steps=8.94
[2025-11-17 18:32:26,198][INFO] Iter  12150 | loss=0.0054 | td_err=0.0522 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.625 | hit=0.625 | stage2=0.938 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.888 | avg_path=10.94 | valid_steps=9.56
[2025-11-17 18:32:38,708][INFO] Iter  12200 | loss=0.0041 | td_err=0.0438 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.594 | hit=0.594 | stage2=0.969 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.817 | avg_path=10.75 | valid_steps=9.34
[2025-11-17 18:32:51,368][INFO] Iter  12250 | loss=0.0046 | td_err=0.0492 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=1.000 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.764 | avg_path=11.78 | valid_steps=10.31
[2025-11-17 18:33:03,872][INFO] Iter  12300 | loss=0.0522 | td_err=0.1036 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.625 | invalid_tok=0.000 | avg_ep_reward=1.641 | avg_path=12.59 | valid_steps=11.00
[2025-11-17 18:33:16,338][INFO] Iter  12350 | loss=0.0120 | td_err=0.0709 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.938 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.811 | avg_path=12.38 | valid_steps=10.91
[2025-11-17 18:33:28,803][INFO] Iter  12400 | loss=0.0780 | td_err=0.0957 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.562 | hit=0.562 | stage2=0.938 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.881 | avg_path=11.81 | valid_steps=10.44
[2025-11-17 18:33:41,214][INFO] Iter  12450 | loss=0.0123 | td_err=0.0631 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.406 | hit=0.406 | stage2=0.969 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.648 | avg_path=12.31 | valid_steps=10.78
[2025-11-17 18:33:53,750][INFO] Iter  12500 | loss=0.0406 | td_err=0.0909 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.969 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.795 | avg_path=12.16 | valid_steps=10.69
[2025-11-17 18:34:06,305][INFO] Iter  12550 | loss=0.0635 | td_err=0.1001 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.756 | avg_path=11.44 | valid_steps=9.97
[2025-11-17 18:34:18,856][INFO] Iter  12600 | loss=0.0176 | td_err=0.0722 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.594 | hit=0.594 | stage2=0.812 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.744 | avg_path=10.22 | valid_steps=8.84
[2025-11-17 18:34:31,368][INFO] Iter  12650 | loss=0.0063 | td_err=0.0583 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.531 | hit=0.531 | stage2=0.844 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.734 | avg_path=11.00 | valid_steps=9.62
[2025-11-17 18:34:44,009][INFO] Iter  12700 | loss=0.0614 | td_err=0.0980 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.406 | hit=0.406 | stage2=0.969 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=1.698 | avg_path=13.00 | valid_steps=11.44
[2025-11-17 18:34:56,583][INFO] Iter  12750 | loss=0.0973 | td_err=0.1165 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.375 | hit=0.375 | stage2=0.938 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.609 | avg_path=12.34 | valid_steps=10.84
[2025-11-17 18:35:09,267][INFO] Iter  12800 | loss=0.1771 | td_err=0.1076 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.562 | hit=0.562 | stage2=0.938 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.775 | avg_path=10.97 | valid_steps=9.53
[2025-11-17 18:35:21,989][INFO] Iter  12850 | loss=0.0083 | td_err=0.0645 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.531 | hit=0.531 | stage2=0.875 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.797 | avg_path=11.78 | valid_steps=10.34
[2025-11-17 18:35:34,490][INFO] Iter  12900 | loss=0.0127 | td_err=0.0715 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.469 | hit=0.469 | stage2=1.000 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.798 | avg_path=12.81 | valid_steps=11.28
[2025-11-17 18:35:47,001][INFO] Iter  12950 | loss=0.0507 | td_err=0.0777 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.906 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.717 | avg_path=11.72 | valid_steps=10.19
[2025-11-17 18:35:59,606][INFO] Iter  13000 | loss=0.0125 | td_err=0.0588 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.406 | hit=0.406 | stage2=0.906 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=1.633 | avg_path=12.50 | valid_steps=10.91
[2025-11-17 18:36:07,288][INFO] ---- Evaluation at iter 13000 ----
[2025-11-17 18:36:07,289][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 18:36:07,289][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 18:36:07,289][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 18:36:07,289][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 18:36:19,920][INFO] Iter  13050 | loss=0.0699 | td_err=0.0924 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.531 | hit=0.531 | stage2=1.000 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.778 | avg_path=11.56 | valid_steps=10.06
[2025-11-17 18:36:32,464][INFO] Iter  13100 | loss=0.0092 | td_err=0.0640 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.594 | invalid_tok=0.000 | avg_ep_reward=1.670 | avg_path=12.81 | valid_steps=11.22
[2025-11-17 18:36:45,047][INFO] Iter  13150 | loss=0.0831 | td_err=0.0930 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.406 | hit=0.406 | stage2=0.875 | invalid_edge=0.594 | invalid_tok=0.000 | avg_ep_reward=1.622 | avg_path=12.78 | valid_steps=11.09
[2025-11-17 18:36:57,494][INFO] Iter  13200 | loss=0.0096 | td_err=0.0566 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.906 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.733 | avg_path=11.66 | valid_steps=10.19
[2025-11-17 18:37:10,171][INFO] Iter  13250 | loss=0.0138 | td_err=0.0743 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.438 | hit=0.438 | stage2=1.000 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.711 | avg_path=12.41 | valid_steps=10.88
[2025-11-17 18:37:22,724][INFO] Iter  13300 | loss=0.0092 | td_err=0.0638 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.562 | hit=0.562 | stage2=0.906 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.837 | avg_path=11.66 | valid_steps=10.22
[2025-11-17 18:37:35,201][INFO] Iter  13350 | loss=0.0057 | td_err=0.0526 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.406 | hit=0.406 | stage2=1.000 | invalid_edge=0.594 | invalid_tok=0.000 | avg_ep_reward=1.705 | avg_path=13.03 | valid_steps=11.44
[2025-11-17 18:37:47,555][INFO] Iter  13400 | loss=0.0518 | td_err=0.0730 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.531 | hit=0.531 | stage2=0.906 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.838 | avg_path=11.84 | valid_steps=10.38
[2025-11-17 18:38:00,115][INFO] Iter  13450 | loss=0.0411 | td_err=0.0745 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.969 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.784 | avg_path=12.16 | valid_steps=10.66
[2025-11-17 18:38:12,690][INFO] Iter  13500 | loss=0.0038 | td_err=0.0451 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.625 | hit=0.625 | stage2=1.000 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.944 | avg_path=11.38 | valid_steps=10.00
[2025-11-17 18:38:25,145][INFO] Iter  13550 | loss=0.0204 | td_err=0.0649 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.562 | hit=0.562 | stage2=0.938 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=1.892 | avg_path=11.81 | valid_steps=10.47
[2025-11-17 18:38:37,655][INFO] Iter  13600 | loss=0.0064 | td_err=0.0525 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.562 | hit=0.562 | stage2=0.938 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.842 | avg_path=11.53 | valid_steps=10.12
[2025-11-17 18:38:50,068][INFO] Iter  13650 | loss=0.0395 | td_err=0.0675 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.844 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.739 | avg_path=12.06 | valid_steps=10.53
[2025-11-17 18:39:02,791][INFO] Iter  13700 | loss=0.0150 | td_err=0.0601 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.469 | hit=0.469 | stage2=0.906 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.730 | avg_path=12.09 | valid_steps=10.62
[2025-11-17 18:39:15,511][INFO] Iter  13750 | loss=0.0169 | td_err=0.0542 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.562 | hit=0.562 | stage2=0.906 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.761 | avg_path=10.78 | valid_steps=9.38
[2025-11-17 18:39:27,961][INFO] Iter  13800 | loss=0.0049 | td_err=0.0497 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.594 | hit=0.594 | stage2=0.906 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.872 | avg_path=11.31 | valid_steps=9.94
[2025-11-17 18:39:40,870][INFO] Iter  13850 | loss=0.0077 | td_err=0.0588 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.875 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.681 | avg_path=10.88 | valid_steps=9.50
[2025-11-17 18:39:53,332][INFO] Iter  13900 | loss=0.0086 | td_err=0.0587 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.469 | hit=0.469 | stage2=1.000 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.777 | avg_path=12.38 | valid_steps=10.91
[2025-11-17 18:40:06,070][INFO] Iter  13950 | loss=0.1759 | td_err=0.1159 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.438 | hit=0.438 | stage2=0.969 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.719 | avg_path=12.66 | valid_steps=11.09
[2025-11-17 18:40:18,725][INFO] Iter  14000 | loss=0.0850 | td_err=0.0891 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.875 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.745 | avg_path=12.06 | valid_steps=10.53
[2025-11-17 18:40:26,415][INFO] ---- Evaluation at iter 14000 ----
[2025-11-17 18:40:26,416][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 18:40:26,416][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 18:40:26,416][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 18:40:26,416][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 18:40:26,421][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251117_173956/ckpt_ql_14000.pt
[2025-11-17 18:40:39,065][INFO] Iter  14050 | loss=0.0791 | td_err=0.0851 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.375 | hit=0.375 | stage2=0.938 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=1.605 | avg_path=12.84 | valid_steps=11.19
[2025-11-17 18:40:51,622][INFO] Iter  14100 | loss=0.0200 | td_err=0.0633 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.406 | hit=0.406 | stage2=0.906 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.641 | avg_path=12.47 | valid_steps=10.91
[2025-11-17 18:41:04,138][INFO] Iter  14150 | loss=0.0468 | td_err=0.0757 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.438 | hit=0.438 | stage2=0.844 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.666 | avg_path=12.38 | valid_steps=10.81
[2025-11-17 18:41:16,864][INFO] Iter  14200 | loss=0.0760 | td_err=0.1057 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.312 | hit=0.312 | stage2=0.906 | invalid_edge=0.656 | invalid_tok=0.000 | avg_ep_reward=1.545 | avg_path=13.47 | valid_steps=11.75
[2025-11-17 18:41:29,450][INFO] Iter  14250 | loss=0.0169 | td_err=0.0649 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.938 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.770 | avg_path=12.19 | valid_steps=10.66
[2025-11-17 18:41:42,036][INFO] Iter  14300 | loss=0.0484 | td_err=0.0702 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.469 | hit=0.469 | stage2=0.969 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.742 | avg_path=12.28 | valid_steps=10.78
[2025-11-17 18:41:54,616][INFO] Iter  14350 | loss=0.0197 | td_err=0.0735 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.375 | hit=0.375 | stage2=0.938 | invalid_edge=0.625 | invalid_tok=0.000 | avg_ep_reward=1.700 | avg_path=13.91 | valid_steps=12.22
[2025-11-17 18:42:06,931][INFO] Iter  14400 | loss=0.0257 | td_err=0.0702 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.344 | hit=0.344 | stage2=0.969 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=1.575 | avg_path=12.84 | valid_steps=11.22
[2025-11-17 18:42:19,589][INFO] Iter  14450 | loss=0.0246 | td_err=0.0651 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.773 | avg_path=11.75 | valid_steps=10.22
[2025-11-17 18:42:32,091][INFO] Iter  14500 | loss=0.0321 | td_err=0.0725 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.312 | hit=0.312 | stage2=0.938 | invalid_edge=0.688 | invalid_tok=0.000 | avg_ep_reward=1.597 | avg_path=14.03 | valid_steps=12.28
[2025-11-17 18:42:44,521][INFO] Iter  14550 | loss=0.0144 | td_err=0.0631 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.938 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.725 | avg_path=11.62 | valid_steps=10.12
[2025-11-17 18:42:56,942][INFO] Iter  14600 | loss=0.0144 | td_err=0.0623 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.562 | hit=0.562 | stage2=0.906 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.909 | avg_path=12.38 | valid_steps=10.94
[2025-11-17 18:43:09,326][INFO] Iter  14650 | loss=0.2517 | td_err=0.1198 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.344 | hit=0.344 | stage2=0.906 | invalid_edge=0.656 | invalid_tok=0.000 | avg_ep_reward=1.497 | avg_path=12.62 | valid_steps=10.88
[2025-11-17 18:43:22,029][INFO] Iter  14700 | loss=0.0212 | td_err=0.0794 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.375 | hit=0.375 | stage2=0.969 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=1.642 | avg_path=12.94 | valid_steps=11.34
[2025-11-17 18:43:34,717][INFO] Iter  14750 | loss=0.0125 | td_err=0.0595 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=1.734 | avg_path=13.09 | valid_steps=11.47
[2025-11-17 18:43:47,406][INFO] Iter  14800 | loss=0.0303 | td_err=0.0741 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.438 | hit=0.438 | stage2=0.906 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.692 | avg_path=12.62 | valid_steps=11.03
[2025-11-17 18:43:59,927][INFO] Iter  14850 | loss=0.0163 | td_err=0.0706 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.938 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.770 | avg_path=12.19 | valid_steps=10.66
[2025-11-17 18:44:12,323][INFO] Iter  14900 | loss=0.0069 | td_err=0.0554 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.531 | hit=0.531 | stage2=0.969 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.845 | avg_path=12.19 | valid_steps=10.72
[2025-11-17 18:44:24,966][INFO] Iter  14950 | loss=0.0391 | td_err=0.0737 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.562 | hit=0.562 | stage2=0.906 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.853 | avg_path=11.78 | valid_steps=10.38
[2025-11-17 18:44:37,491][INFO] Iter  15000 | loss=0.0078 | td_err=0.0536 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.531 | hit=0.531 | stage2=1.000 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.864 | avg_path=12.31 | valid_steps=10.84
[2025-11-17 18:44:45,172][INFO] ---- Evaluation at iter 15000 ----
[2025-11-17 18:44:45,173][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 18:44:45,173][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 18:44:45,173][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 18:44:45,173][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 18:44:57,889][INFO] Iter  15050 | loss=0.0369 | td_err=0.0704 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.531 | hit=0.531 | stage2=0.906 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.817 | avg_path=12.22 | valid_steps=10.72
[2025-11-17 18:45:10,733][INFO] Iter  15100 | loss=0.0300 | td_err=0.0669 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.969 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.811 | avg_path=12.75 | valid_steps=11.16
[2025-11-17 18:45:23,451][INFO] Iter  15150 | loss=0.0069 | td_err=0.0472 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.733 | avg_path=12.28 | valid_steps=10.75
[2025-11-17 18:45:36,038][INFO] Iter  15200 | loss=0.0192 | td_err=0.0573 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.938 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.723 | avg_path=11.50 | valid_steps=10.03
[2025-11-17 18:45:48,748][INFO] Iter  15250 | loss=0.0085 | td_err=0.0575 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.406 | hit=0.406 | stage2=0.969 | invalid_edge=0.594 | invalid_tok=0.000 | avg_ep_reward=1.739 | avg_path=13.44 | valid_steps=11.84
[2025-11-17 18:46:01,520][INFO] Iter  15300 | loss=0.0063 | td_err=0.0524 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.531 | hit=0.531 | stage2=0.875 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.761 | avg_path=11.53 | valid_steps=10.06
[2025-11-17 18:46:14,281][INFO] Iter  15350 | loss=0.0113 | td_err=0.0609 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.469 | hit=0.469 | stage2=0.969 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.736 | avg_path=12.47 | valid_steps=10.88
[2025-11-17 18:46:26,914][INFO] Iter  15400 | loss=0.0103 | td_err=0.0621 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.469 | hit=0.469 | stage2=0.969 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.775 | avg_path=12.75 | valid_steps=11.19
[2025-11-17 18:46:39,483][INFO] Iter  15450 | loss=0.0143 | td_err=0.0660 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.531 | hit=0.531 | stage2=0.875 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.711 | avg_path=10.78 | valid_steps=9.41
[2025-11-17 18:46:52,149][INFO] Iter  15500 | loss=0.0077 | td_err=0.0546 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.562 | hit=0.562 | stage2=0.969 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.866 | avg_path=11.81 | valid_steps=10.38
[2025-11-17 18:47:04,941][INFO] Iter  15550 | loss=0.0296 | td_err=0.0679 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.875 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.767 | avg_path=12.28 | valid_steps=10.75
[2025-11-17 18:47:17,606][INFO] Iter  15600 | loss=0.0066 | td_err=0.0476 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.594 | hit=0.594 | stage2=0.906 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=1.750 | avg_path=10.09 | valid_steps=8.72
[2025-11-17 18:47:30,257][INFO] Iter  15650 | loss=0.0118 | td_err=0.0597 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.438 | hit=0.438 | stage2=0.969 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=1.781 | avg_path=13.28 | valid_steps=11.72
[2025-11-17 18:47:42,885][INFO] Iter  15700 | loss=0.0085 | td_err=0.0587 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.594 | hit=0.594 | stage2=0.844 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.856 | avg_path=11.50 | valid_steps=10.06
[2025-11-17 18:47:55,601][INFO] Iter  15750 | loss=0.0091 | td_err=0.0547 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.406 | hit=0.406 | stage2=0.875 | invalid_edge=0.594 | invalid_tok=0.000 | avg_ep_reward=1.677 | avg_path=12.53 | valid_steps=10.94
[2025-11-17 18:48:08,243][INFO] Iter  15800 | loss=0.0094 | td_err=0.0520 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.531 | hit=0.531 | stage2=0.875 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.747 | avg_path=11.28 | valid_steps=9.84
[2025-11-17 18:48:21,105][INFO] Iter  15850 | loss=0.0052 | td_err=0.0472 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.406 | hit=0.406 | stage2=0.969 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=1.663 | avg_path=12.56 | valid_steps=11.00
[2025-11-17 18:48:33,691][INFO] Iter  15900 | loss=0.0125 | td_err=0.0512 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.969 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.814 | avg_path=12.34 | valid_steps=10.88
[2025-11-17 18:48:46,211][INFO] Iter  15950 | loss=0.0060 | td_err=0.0481 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.562 | hit=0.562 | stage2=0.875 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.902 | avg_path=12.25 | valid_steps=10.84
[2025-11-17 18:48:58,718][INFO] Iter  16000 | loss=0.0177 | td_err=0.0722 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.775 | avg_path=12.81 | valid_steps=11.25
[2025-11-17 18:49:06,430][INFO] ---- Evaluation at iter 16000 ----
[2025-11-17 18:49:06,431][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 18:49:06,431][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 18:49:06,431][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 18:49:06,431][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 18:49:06,436][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251117_173956/ckpt_ql_16000.pt
[2025-11-17 18:49:19,141][INFO] Iter  16050 | loss=0.0056 | td_err=0.0498 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.562 | hit=0.562 | stage2=0.844 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.814 | avg_path=11.44 | valid_steps=10.03
[2025-11-17 18:49:31,773][INFO] Iter  16100 | loss=0.0040 | td_err=0.0446 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.469 | hit=0.469 | stage2=0.906 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.759 | avg_path=12.50 | valid_steps=11.00
[2025-11-17 18:49:44,644][INFO] Iter  16150 | loss=0.0076 | td_err=0.0537 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.594 | hit=0.594 | stage2=0.938 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.886 | avg_path=11.50 | valid_steps=10.09
[2025-11-17 18:49:57,067][INFO] Iter  16200 | loss=0.0358 | td_err=0.0911 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.438 | hit=0.438 | stage2=0.906 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.734 | avg_path=12.47 | valid_steps=10.91
[2025-11-17 18:50:09,498][INFO] Iter  16250 | loss=0.0137 | td_err=0.0692 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.906 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.769 | avg_path=12.12 | valid_steps=10.62
[2025-11-17 18:50:21,922][INFO] Iter  16300 | loss=0.0300 | td_err=0.0894 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.875 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.788 | avg_path=12.38 | valid_steps=10.88
[2025-11-17 18:50:34,337][INFO] Iter  16350 | loss=0.0204 | td_err=0.0733 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.594 | hit=0.594 | stage2=0.875 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.853 | avg_path=11.41 | valid_steps=9.97
[2025-11-17 18:50:46,721][INFO] Iter  16400 | loss=0.0243 | td_err=0.0704 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.594 | hit=0.594 | stage2=0.906 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.863 | avg_path=11.44 | valid_steps=10.00
[2025-11-17 18:50:59,346][INFO] Iter  16450 | loss=0.0269 | td_err=0.0719 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.344 | hit=0.344 | stage2=0.969 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=1.580 | avg_path=12.75 | valid_steps=11.19
[2025-11-17 18:51:12,135][INFO] Iter  16500 | loss=0.0694 | td_err=0.1148 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.250 | hit=0.250 | stage2=0.969 | invalid_edge=0.719 | invalid_tok=0.000 | avg_ep_reward=1.453 | avg_path=13.69 | valid_steps=11.88
[2025-11-17 18:51:24,766][INFO] Iter  16550 | loss=0.0164 | td_err=0.0708 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.844 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.798 | avg_path=12.44 | valid_steps=10.97
[2025-11-17 18:51:37,247][INFO] Iter  16600 | loss=0.1895 | td_err=0.1120 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.969 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.742 | avg_path=11.62 | valid_steps=10.16
[2025-11-17 18:51:49,854][INFO] Iter  16650 | loss=0.0264 | td_err=0.0784 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.375 | hit=0.375 | stage2=0.906 | invalid_edge=0.594 | invalid_tok=0.000 | avg_ep_reward=1.652 | avg_path=13.38 | valid_steps=11.72
[2025-11-17 18:52:02,151][INFO] Iter  16700 | loss=0.0170 | td_err=0.0706 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.406 | hit=0.406 | stage2=0.969 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=1.731 | avg_path=12.78 | valid_steps=11.22
[2025-11-17 18:52:14,758][INFO] Iter  16750 | loss=0.0096 | td_err=0.0569 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=1.725 | avg_path=12.78 | valid_steps=11.22
[2025-11-17 18:52:27,360][INFO] Iter  16800 | loss=0.0100 | td_err=0.0642 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=1.772 | avg_path=12.78 | valid_steps=11.22
[2025-11-17 18:52:40,083][INFO] Iter  16850 | loss=0.1528 | td_err=0.1087 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.375 | hit=0.375 | stage2=0.969 | invalid_edge=0.625 | invalid_tok=0.000 | avg_ep_reward=1.663 | avg_path=13.25 | valid_steps=11.62
[2025-11-17 18:52:52,919][INFO] Iter  16900 | loss=0.0061 | td_err=0.0563 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.531 | hit=0.531 | stage2=1.000 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.867 | avg_path=12.34 | valid_steps=10.88
[2025-11-17 18:53:05,576][INFO] Iter  16950 | loss=0.0073 | td_err=0.0541 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.906 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.817 | avg_path=12.50 | valid_steps=11.03
[2025-11-17 18:53:18,011][INFO] Iter  17000 | loss=0.0133 | td_err=0.0621 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.469 | hit=0.469 | stage2=0.969 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.734 | avg_path=12.34 | valid_steps=10.78
[2025-11-17 18:53:25,717][INFO] ---- Evaluation at iter 17000 ----
[2025-11-17 18:53:25,718][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 18:53:25,718][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 18:53:25,718][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 18:53:25,718][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 18:53:38,649][INFO] Iter  17050 | loss=0.0075 | td_err=0.0581 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.906 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.775 | avg_path=11.97 | valid_steps=10.53
[2025-11-17 18:53:51,504][INFO] Iter  17100 | loss=0.0083 | td_err=0.0600 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.281 | hit=0.281 | stage2=0.938 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=1.498 | avg_path=12.97 | valid_steps=11.38
[2025-11-17 18:54:04,312][INFO] Iter  17150 | loss=0.0059 | td_err=0.0494 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.756 | avg_path=12.41 | valid_steps=10.91
[2025-11-17 18:54:16,928][INFO] Iter  17200 | loss=0.0118 | td_err=0.0630 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.969 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.830 | avg_path=12.25 | valid_steps=10.72
[2025-11-17 18:54:29,539][INFO] Iter  17250 | loss=0.0256 | td_err=0.0698 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.438 | hit=0.438 | stage2=1.000 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=1.741 | avg_path=12.97 | valid_steps=11.41
[2025-11-17 18:54:42,064][INFO] Iter  17300 | loss=0.0059 | td_err=0.0499 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.938 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.783 | avg_path=12.09 | valid_steps=10.62
[2025-11-17 18:54:54,410][INFO] Iter  17350 | loss=0.0090 | td_err=0.0583 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.469 | hit=0.469 | stage2=0.969 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.741 | avg_path=11.72 | valid_steps=10.22
[2025-11-17 18:55:07,042][INFO] Iter  17400 | loss=0.0048 | td_err=0.0425 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.784 | avg_path=11.53 | valid_steps=10.09
[2025-11-17 18:55:19,675][INFO] Iter  17450 | loss=0.0351 | td_err=0.0818 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.531 | hit=0.531 | stage2=0.875 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.814 | avg_path=11.56 | valid_steps=10.12
[2025-11-17 18:55:32,364][INFO] Iter  17500 | loss=0.0062 | td_err=0.0509 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.625 | hit=0.625 | stage2=0.844 | invalid_edge=0.312 | invalid_tok=0.000 | avg_ep_reward=1.844 | avg_path=10.00 | valid_steps=8.69
[2025-11-17 18:55:45,214][INFO] Iter  17550 | loss=0.0121 | td_err=0.0542 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.469 | hit=0.469 | stage2=0.844 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.772 | avg_path=12.72 | valid_steps=11.25
[2025-11-17 18:55:57,689][INFO] Iter  17600 | loss=0.0120 | td_err=0.0547 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.594 | hit=0.594 | stage2=0.938 | invalid_edge=0.312 | invalid_tok=0.000 | avg_ep_reward=1.850 | avg_path=10.81 | valid_steps=9.50
[2025-11-17 18:56:10,373][INFO] Iter  17650 | loss=0.0115 | td_err=0.0588 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.375 | hit=0.375 | stage2=0.906 | invalid_edge=0.625 | invalid_tok=0.000 | avg_ep_reward=1.608 | avg_path=12.91 | valid_steps=11.28
[2025-11-17 18:56:22,997][INFO] Iter  17700 | loss=0.0230 | td_err=0.0728 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.469 | hit=0.469 | stage2=0.969 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.825 | avg_path=13.22 | valid_steps=11.69
[2025-11-17 18:56:35,699][INFO] Iter  17750 | loss=0.0070 | td_err=0.0572 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.816 | avg_path=12.53 | valid_steps=11.03
[2025-11-17 18:56:48,199][INFO] Iter  17800 | loss=0.0169 | td_err=0.0752 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.375 | hit=0.375 | stage2=0.875 | invalid_edge=0.625 | invalid_tok=0.000 | avg_ep_reward=1.658 | avg_path=13.50 | valid_steps=11.84
[2025-11-17 18:57:00,758][INFO] Iter  17850 | loss=0.0330 | td_err=0.0625 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.438 | hit=0.438 | stage2=0.906 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=1.781 | avg_path=12.47 | valid_steps=10.91
[2025-11-17 18:57:13,163][INFO] Iter  17900 | loss=0.0080 | td_err=0.0529 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.406 | hit=0.406 | stage2=0.906 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.691 | avg_path=12.97 | valid_steps=11.41
[2025-11-17 18:57:25,903][INFO] Iter  17950 | loss=0.0190 | td_err=0.0581 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.469 | hit=0.469 | stage2=0.906 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.708 | avg_path=11.59 | valid_steps=10.09
[2025-11-17 18:57:38,683][INFO] Iter  18000 | loss=0.0044 | td_err=0.0431 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.875 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.761 | avg_path=12.00 | valid_steps=10.53
[2025-11-17 18:57:46,419][INFO] ---- Evaluation at iter 18000 ----
[2025-11-17 18:57:46,420][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 18:57:46,420][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 18:57:46,420][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 18:57:46,420][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 18:57:46,425][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251117_173956/ckpt_ql_18000.pt
[2025-11-17 18:57:59,217][INFO] Iter  18050 | loss=0.0051 | td_err=0.0461 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.723 | avg_path=11.97 | valid_steps=10.50
[2025-11-17 18:58:12,009][INFO] Iter  18100 | loss=0.0113 | td_err=0.0577 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.312 | hit=0.312 | stage2=0.938 | invalid_edge=0.594 | invalid_tok=0.000 | avg_ep_reward=1.583 | avg_path=12.88 | valid_steps=11.28
[2025-11-17 18:58:24,679][INFO] Iter  18150 | loss=0.0078 | td_err=0.0496 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.763 | avg_path=13.12 | valid_steps=11.59
[2025-11-17 18:58:37,442][INFO] Iter  18200 | loss=0.0048 | td_err=0.0447 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.625 | hit=0.625 | stage2=0.906 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=1.986 | avg_path=11.41 | valid_steps=10.06
[2025-11-17 18:58:50,221][INFO] Iter  18250 | loss=0.0235 | td_err=0.0607 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.406 | hit=0.406 | stage2=0.969 | invalid_edge=0.594 | invalid_tok=0.000 | avg_ep_reward=1.723 | avg_path=13.28 | valid_steps=11.69
[2025-11-17 18:59:03,146][INFO] Iter  18300 | loss=0.0031 | td_err=0.0401 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.531 | hit=0.531 | stage2=0.875 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=1.805 | avg_path=11.53 | valid_steps=10.19
[2025-11-17 18:59:16,194][INFO] Iter  18350 | loss=0.0051 | td_err=0.0467 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.375 | hit=0.375 | stage2=0.938 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.739 | avg_path=12.56 | valid_steps=11.12
[2025-11-17 18:59:29,269][INFO] Iter  18400 | loss=0.0035 | td_err=0.0409 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.531 | hit=0.531 | stage2=0.875 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.791 | avg_path=11.25 | valid_steps=9.81
[2025-11-17 18:59:42,093][INFO] Iter  18450 | loss=0.0027 | td_err=0.0375 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.438 | hit=0.438 | stage2=0.969 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.761 | avg_path=12.97 | valid_steps=11.44
[2025-11-17 18:59:55,168][INFO] Iter  18500 | loss=0.0061 | td_err=0.0473 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.344 | hit=0.344 | stage2=0.938 | invalid_edge=0.625 | invalid_tok=0.000 | avg_ep_reward=1.647 | avg_path=13.62 | valid_steps=12.00
[2025-11-17 19:00:07,935][INFO] Iter  18550 | loss=0.0043 | td_err=0.0410 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.469 | hit=0.469 | stage2=0.906 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.745 | avg_path=12.47 | valid_steps=10.94
[2025-11-17 19:00:20,803][INFO] Iter  18600 | loss=0.0073 | td_err=0.0496 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.594 | hit=0.594 | stage2=0.938 | invalid_edge=0.344 | invalid_tok=0.000 | avg_ep_reward=2.034 | avg_path=12.38 | valid_steps=11.03
[2025-11-17 19:00:33,609][INFO] Iter  18650 | loss=0.0068 | td_err=0.0520 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.761 | avg_path=12.72 | valid_steps=11.19
[2025-11-17 19:00:46,556][INFO] Iter  18700 | loss=0.0053 | td_err=0.0470 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.281 | hit=0.281 | stage2=0.969 | invalid_edge=0.656 | invalid_tok=0.000 | avg_ep_reward=1.667 | avg_path=14.34 | valid_steps=12.69
[2025-11-17 19:00:59,351][INFO] Iter  18750 | loss=0.0032 | td_err=0.0392 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.531 | hit=0.531 | stage2=0.875 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.798 | avg_path=11.69 | valid_steps=10.28
[2025-11-17 19:01:12,084][INFO] Iter  18800 | loss=0.0037 | td_err=0.0417 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.714 | avg_path=12.56 | valid_steps=11.03
[2025-11-17 19:01:24,987][INFO] Iter  18850 | loss=0.0047 | td_err=0.0429 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.938 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.841 | avg_path=12.78 | valid_steps=11.28
[2025-11-17 19:01:37,876][INFO] Iter  18900 | loss=0.0040 | td_err=0.0404 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.469 | hit=0.469 | stage2=1.000 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.820 | avg_path=13.03 | valid_steps=11.50
[2025-11-17 19:01:50,764][INFO] Iter  18950 | loss=0.0032 | td_err=0.0381 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.875 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.753 | avg_path=12.00 | valid_steps=10.53
[2025-11-17 19:02:03,582][INFO] Iter  19000 | loss=0.0064 | td_err=0.0439 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.438 | hit=0.438 | stage2=0.938 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.692 | avg_path=12.34 | valid_steps=10.81
[2025-11-17 19:02:11,257][INFO] ---- Evaluation at iter 19000 ----
[2025-11-17 19:02:11,258][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 19:02:11,258][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 19:02:11,258][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 19:02:11,258][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 19:02:23,997][INFO] Iter  19050 | loss=0.0080 | td_err=0.0448 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.562 | hit=0.562 | stage2=0.969 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.908 | avg_path=12.31 | valid_steps=10.88
[2025-11-17 19:02:36,656][INFO] Iter  19100 | loss=0.0062 | td_err=0.0432 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.469 | hit=0.469 | stage2=0.969 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.812 | avg_path=13.12 | valid_steps=11.56
[2025-11-17 19:02:49,461][INFO] Iter  19150 | loss=0.0039 | td_err=0.0425 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.906 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.863 | avg_path=12.59 | valid_steps=11.09
[2025-11-17 19:03:02,088][INFO] Iter  19200 | loss=0.0035 | td_err=0.0393 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.875 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.756 | avg_path=11.84 | valid_steps=10.41
[2025-11-17 19:03:14,946][INFO] Iter  19250 | loss=0.0049 | td_err=0.0460 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.375 | hit=0.375 | stage2=0.938 | invalid_edge=0.625 | invalid_tok=0.000 | avg_ep_reward=1.772 | avg_path=14.09 | valid_steps=12.47
[2025-11-17 19:03:27,555][INFO] Iter  19300 | loss=0.0036 | td_err=0.0409 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.406 | hit=0.406 | stage2=0.969 | invalid_edge=0.562 | invalid_tok=0.000 | avg_ep_reward=1.700 | avg_path=12.94 | valid_steps=11.38
[2025-11-17 19:03:40,210][INFO] Iter  19350 | loss=0.0032 | td_err=0.0382 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.562 | hit=0.562 | stage2=0.906 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.891 | avg_path=11.72 | valid_steps=10.28
[2025-11-17 19:03:52,856][INFO] Iter  19400 | loss=0.0048 | td_err=0.0437 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.438 | hit=0.438 | stage2=1.000 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.759 | avg_path=12.56 | valid_steps=11.12
[2025-11-17 19:04:05,472][INFO] Iter  19450 | loss=0.0028 | td_err=0.0361 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.438 | hit=0.438 | stage2=0.906 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.770 | avg_path=13.19 | valid_steps=11.66
[2025-11-17 19:04:18,085][INFO] Iter  19500 | loss=0.0045 | td_err=0.0437 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.406 | hit=0.406 | stage2=0.969 | invalid_edge=0.438 | invalid_tok=0.000 | avg_ep_reward=1.770 | avg_path=12.84 | valid_steps=11.38
[2025-11-17 19:04:30,734][INFO] Iter  19550 | loss=0.0043 | td_err=0.0365 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.438 | hit=0.438 | stage2=0.906 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.766 | avg_path=13.25 | valid_steps=11.69
[2025-11-17 19:04:43,487][INFO] Iter  19600 | loss=0.0082 | td_err=0.0446 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.938 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.813 | avg_path=12.44 | valid_steps=11.00
[2025-11-17 19:04:56,123][INFO] Iter  19650 | loss=0.0032 | td_err=0.0378 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.469 | hit=0.469 | stage2=0.938 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.731 | avg_path=12.12 | valid_steps=10.66
[2025-11-17 19:05:08,938][INFO] Iter  19700 | loss=0.0045 | td_err=0.0392 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.438 | hit=0.438 | stage2=0.969 | invalid_edge=0.500 | invalid_tok=0.000 | avg_ep_reward=1.783 | avg_path=13.16 | valid_steps=11.66
[2025-11-17 19:05:21,612][INFO] Iter  19750 | loss=0.0031 | td_err=0.0385 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.438 | hit=0.438 | stage2=0.906 | invalid_edge=0.531 | invalid_tok=0.000 | avg_ep_reward=1.692 | avg_path=12.38 | valid_steps=10.88
[2025-11-17 19:05:34,228][INFO] Iter  19800 | loss=0.0034 | td_err=0.0364 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.406 | hit=0.406 | stage2=0.938 | invalid_edge=0.594 | invalid_tok=0.000 | avg_ep_reward=1.767 | avg_path=13.75 | valid_steps=12.19
[2025-11-17 19:05:46,888][INFO] Iter  19850 | loss=0.0049 | td_err=0.0365 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.531 | hit=0.531 | stage2=0.938 | invalid_edge=0.375 | invalid_tok=0.000 | avg_ep_reward=1.742 | avg_path=11.00 | valid_steps=9.59
[2025-11-17 19:05:59,863][INFO] Iter  19900 | loss=0.0019 | td_err=0.0316 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.594 | hit=0.594 | stage2=0.906 | invalid_edge=0.406 | invalid_tok=0.000 | avg_ep_reward=1.995 | avg_path=12.19 | valid_steps=10.78
[2025-11-17 19:06:12,531][INFO] Iter  19950 | loss=0.0025 | td_err=0.0338 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.531 | hit=0.531 | stage2=0.906 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.898 | avg_path=12.38 | valid_steps=10.91
[2025-11-17 19:06:25,218][INFO] Iter  20000 | loss=0.0072 | td_err=0.0376 | kl=0.0000 | temp=1.000 | eps=0.050 | success=0.500 | hit=0.500 | stage2=0.969 | invalid_edge=0.469 | invalid_tok=0.000 | avg_ep_reward=1.881 | avg_path=13.09 | valid_steps=11.62
[2025-11-17 19:06:32,836][INFO] ---- Evaluation at iter 20000 ----
[2025-11-17 19:06:32,837][INFO]   S1->S2: 0.00% (0 / 296)
[2025-11-17 19:06:32,837][INFO]   S2->S3: 0.00% (0 / 301)
[2025-11-17 19:06:32,837][INFO]   S1->S3: 0.00% (0 / 450)
[2025-11-17 19:06:32,837][INFO]   overall: 0.00% (0 / 1047)
[2025-11-17 19:06:32,841][INFO] Saved Q-learning checkpoint to out_qlearning/ql_20251117_173956/ckpt_ql_20000.pt
[2025-11-17 19:06:32,841][INFO] Q-learning training finished.
