[2025-11-13 03:26:43,252][INFO] Starting GraphA Tier-3 training
[2025-11-13 03:26:43,253][INFO] Vocabulary size: 92
[2025-11-13 03:26:43,254][INFO] Block size: 32
[2025-11-13 03:26:43,254][INFO] S1->S2 loss multiplier: 4.00
[2025-11-13 03:26:45,753][INFO] Model parameters: 0.11M
[2025-11-13 03:26:45,756][INFO] Entering training loop (max_iters=50000)
[2025-11-13 03:26:52,979][INFO] ======================================================================
[2025-11-13 03:26:52,979][INFO] Iteration 0
[2025-11-13 03:26:52,979][INFO] Loss (weighted/base): train=nan/nan, val=4.3191/3.9065
[2025-11-13 03:26:52,979][INFO]   Val S1->S2 token ratio: 3.00%
[2025-11-13 03:26:52,979][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:26:52,979][INFO]   S2->S3: 0.00% (0/91)
[2025-11-13 03:26:52,979][INFO]   S1->S3: 0.00% (0/135)
[2025-11-13 03:26:52,979][INFO]   overall: 0.00% (0/315)
[2025-11-13 03:26:52,979][INFO] ======================================================================
[2025-11-13 03:27:06,065][INFO] ======================================================================
[2025-11-13 03:27:06,065][INFO] Iteration 1000
[2025-11-13 03:27:06,065][INFO] Loss (weighted/base): train=1.9684/1.6379, val=1.2873/0.9257
[2025-11-13 03:27:06,065][INFO]   Val S1->S2 token ratio: 3.06%
[2025-11-13 03:27:06,065][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:27:06,065][INFO]   S2->S3: 37.36% (34/91)
[2025-11-13 03:27:06,065][INFO]   S1->S3: 40.74% (55/135)
[2025-11-13 03:27:06,065][INFO]   overall: 28.25% (89/315)
[2025-11-13 03:27:06,065][INFO] ======================================================================
[2025-11-13 03:27:19,100][INFO] ======================================================================
[2025-11-13 03:27:19,100][INFO] Iteration 2000
[2025-11-13 03:27:19,100][INFO] Loss (weighted/base): train=0.8352/0.6220, val=1.3939/0.9591
[2025-11-13 03:27:19,100][INFO]   Val S1->S2 token ratio: 3.01%
[2025-11-13 03:27:19,100][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:27:19,100][INFO]   S2->S3: 98.90% (90/91)
[2025-11-13 03:27:19,100][INFO]   S1->S3: 100.00% (135/135)
[2025-11-13 03:27:19,100][INFO]   overall: 71.43% (225/315)
[2025-11-13 03:27:19,100][INFO] ======================================================================
[2025-11-13 03:27:32,008][INFO] ======================================================================
[2025-11-13 03:27:32,008][INFO] Iteration 3000
[2025-11-13 03:27:32,008][INFO] Loss (weighted/base): train=0.7426/0.5470, val=1.4758/1.0144
[2025-11-13 03:27:32,008][INFO]   Val S1->S2 token ratio: 2.99%
[2025-11-13 03:27:32,008][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:27:32,008][INFO]   S2->S3: 85.71% (78/91)
[2025-11-13 03:27:32,008][INFO]   S1->S3: 98.52% (133/135)
[2025-11-13 03:27:32,008][INFO]   overall: 66.98% (211/315)
[2025-11-13 03:27:32,008][INFO] ======================================================================
[2025-11-13 03:27:44,888][INFO] ======================================================================
[2025-11-13 03:27:44,889][INFO] Iteration 4000
[2025-11-13 03:27:44,889][INFO] Loss (weighted/base): train=0.7011/0.5280, val=1.5893/1.0696
[2025-11-13 03:27:44,889][INFO]   Val S1->S2 token ratio: 3.06%
[2025-11-13 03:27:44,889][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:27:44,889][INFO]   S2->S3: 93.41% (85/91)
[2025-11-13 03:27:44,889][INFO]   S1->S3: 95.56% (129/135)
[2025-11-13 03:27:44,889][INFO]   overall: 67.94% (214/315)
[2025-11-13 03:27:44,889][INFO] ======================================================================
[2025-11-13 03:27:57,812][INFO] ======================================================================
[2025-11-13 03:27:57,812][INFO] Iteration 5000
[2025-11-13 03:27:57,812][INFO] Loss (weighted/base): train=0.6569/0.5131, val=1.7270/1.1289
[2025-11-13 03:27:57,812][INFO]   Val S1->S2 token ratio: 3.13%
[2025-11-13 03:27:57,812][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:27:57,812][INFO]   S2->S3: 95.60% (87/91)
[2025-11-13 03:27:57,812][INFO]   S1->S3: 96.30% (130/135)
[2025-11-13 03:27:57,812][INFO]   overall: 68.89% (217/315)
[2025-11-13 03:27:57,812][INFO] ======================================================================
[2025-11-13 03:27:57,816][INFO] Saved checkpoint: out/composition_20251113_032643/ckpt_5000.pt
[2025-11-13 03:28:10,713][INFO] ======================================================================
[2025-11-13 03:28:10,713][INFO] Iteration 6000
[2025-11-13 03:28:10,713][INFO] Loss (weighted/base): train=0.6140/0.4995, val=1.8376/1.1744
[2025-11-13 03:28:10,713][INFO]   Val S1->S2 token ratio: 3.11%
[2025-11-13 03:28:10,713][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:28:10,713][INFO]   S2->S3: 90.11% (82/91)
[2025-11-13 03:28:10,713][INFO]   S1->S3: 95.56% (129/135)
[2025-11-13 03:28:10,713][INFO]   overall: 66.98% (211/315)
[2025-11-13 03:28:10,713][INFO] ======================================================================
[2025-11-13 03:28:23,653][INFO] ======================================================================
[2025-11-13 03:28:23,653][INFO] Iteration 7000
[2025-11-13 03:28:23,654][INFO] Loss (weighted/base): train=0.5792/0.4881, val=1.9241/1.2156
[2025-11-13 03:28:23,654][INFO]   Val S1->S2 token ratio: 3.00%
[2025-11-13 03:28:23,654][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:28:23,654][INFO]   S2->S3: 89.01% (81/91)
[2025-11-13 03:28:23,654][INFO]   S1->S3: 95.56% (129/135)
[2025-11-13 03:28:23,654][INFO]   overall: 66.67% (210/315)
[2025-11-13 03:28:23,654][INFO] ======================================================================
[2025-11-13 03:28:36,660][INFO] ======================================================================
[2025-11-13 03:28:36,660][INFO] Iteration 8000
[2025-11-13 03:28:36,660][INFO] Loss (weighted/base): train=0.5529/0.4784, val=2.0858/1.2824
[2025-11-13 03:28:36,660][INFO]   Val S1->S2 token ratio: 3.05%
[2025-11-13 03:28:36,660][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:28:36,660][INFO]   S2->S3: 82.42% (75/91)
[2025-11-13 03:28:36,660][INFO]   S1->S3: 86.67% (117/135)
[2025-11-13 03:28:36,660][INFO]   overall: 60.95% (192/315)
[2025-11-13 03:28:36,660][INFO] ======================================================================
[2025-11-13 03:28:49,678][INFO] ======================================================================
[2025-11-13 03:28:49,678][INFO] Iteration 9000
[2025-11-13 03:28:49,678][INFO] Loss (weighted/base): train=0.5344/0.4702, val=2.1839/1.3274
[2025-11-13 03:28:49,678][INFO]   Val S1->S2 token ratio: 3.09%
[2025-11-13 03:28:49,678][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:28:49,678][INFO]   S2->S3: 83.52% (76/91)
[2025-11-13 03:28:49,678][INFO]   S1->S3: 94.81% (128/135)
[2025-11-13 03:28:49,678][INFO]   overall: 64.76% (204/315)
[2025-11-13 03:28:49,678][INFO] ======================================================================
[2025-11-13 03:29:02,728][INFO] ======================================================================
[2025-11-13 03:29:02,728][INFO] Iteration 10000
[2025-11-13 03:29:02,728][INFO] Loss (weighted/base): train=0.5215/0.4632, val=2.2589/1.3705
[2025-11-13 03:29:02,728][INFO]   Val S1->S2 token ratio: 3.04%
[2025-11-13 03:29:02,728][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:29:02,728][INFO]   S2->S3: 78.02% (71/91)
[2025-11-13 03:29:02,728][INFO]   S1->S3: 88.89% (120/135)
[2025-11-13 03:29:02,728][INFO]   overall: 60.63% (191/315)
[2025-11-13 03:29:02,728][INFO] ======================================================================
[2025-11-13 03:29:02,731][INFO] Saved checkpoint: out/composition_20251113_032643/ckpt_10000.pt
[2025-11-13 03:29:15,686][INFO] ======================================================================
[2025-11-13 03:29:15,686][INFO] Iteration 11000
[2025-11-13 03:29:15,686][INFO] Loss (weighted/base): train=0.5119/0.4575, val=2.3051/1.3829
[2025-11-13 03:29:15,686][INFO]   Val S1->S2 token ratio: 3.02%
[2025-11-13 03:29:15,686][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:29:15,686][INFO]   S2->S3: 82.42% (75/91)
[2025-11-13 03:29:15,686][INFO]   S1->S3: 93.33% (126/135)
[2025-11-13 03:29:15,686][INFO]   overall: 63.81% (201/315)
[2025-11-13 03:29:15,686][INFO] ======================================================================
[2025-11-13 03:29:28,616][INFO] ======================================================================
[2025-11-13 03:29:28,616][INFO] Iteration 12000
[2025-11-13 03:29:28,616][INFO] Loss (weighted/base): train=0.5044/0.4525, val=2.3451/1.4112
[2025-11-13 03:29:28,616][INFO]   Val S1->S2 token ratio: 3.01%
[2025-11-13 03:29:28,616][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:29:28,616][INFO]   S2->S3: 80.22% (73/91)
[2025-11-13 03:29:28,616][INFO]   S1->S3: 93.33% (126/135)
[2025-11-13 03:29:28,616][INFO]   overall: 63.17% (199/315)
[2025-11-13 03:29:28,616][INFO] ======================================================================
[2025-11-13 03:29:41,574][INFO] ======================================================================
[2025-11-13 03:29:41,574][INFO] Iteration 13000
[2025-11-13 03:29:41,574][INFO] Loss (weighted/base): train=0.4987/0.4485, val=2.4362/1.4599
[2025-11-13 03:29:41,574][INFO]   Val S1->S2 token ratio: 3.01%
[2025-11-13 03:29:41,574][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:29:41,574][INFO]   S2->S3: 76.92% (70/91)
[2025-11-13 03:29:41,574][INFO]   S1->S3: 92.59% (125/135)
[2025-11-13 03:29:41,574][INFO]   overall: 61.90% (195/315)
[2025-11-13 03:29:41,574][INFO] ======================================================================
[2025-11-13 03:29:54,555][INFO] ======================================================================
[2025-11-13 03:29:54,556][INFO] Iteration 14000
[2025-11-13 03:29:54,556][INFO] Loss (weighted/base): train=0.4934/0.4447, val=2.5207/1.4732
[2025-11-13 03:29:54,556][INFO]   Val S1->S2 token ratio: 3.10%
[2025-11-13 03:29:54,556][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:29:54,556][INFO]   S2->S3: 78.02% (71/91)
[2025-11-13 03:29:54,556][INFO]   S1->S3: 91.11% (123/135)
[2025-11-13 03:29:54,556][INFO]   overall: 61.59% (194/315)
[2025-11-13 03:29:54,556][INFO] ======================================================================
[2025-11-13 03:30:07,499][INFO] ======================================================================
[2025-11-13 03:30:07,499][INFO] Iteration 15000
[2025-11-13 03:30:07,499][INFO] Loss (weighted/base): train=0.4887/0.4409, val=2.5257/1.4836
[2025-11-13 03:30:07,499][INFO]   Val S1->S2 token ratio: 3.07%
[2025-11-13 03:30:07,499][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:30:07,499][INFO]   S2->S3: 80.22% (73/91)
[2025-11-13 03:30:07,499][INFO]   S1->S3: 89.63% (121/135)
[2025-11-13 03:30:07,499][INFO]   overall: 61.59% (194/315)
[2025-11-13 03:30:07,499][INFO] ======================================================================
[2025-11-13 03:30:07,502][INFO] Saved checkpoint: out/composition_20251113_032643/ckpt_15000.pt
[2025-11-13 03:30:20,379][INFO] ======================================================================
[2025-11-13 03:30:20,379][INFO] Iteration 16000
[2025-11-13 03:30:20,380][INFO] Loss (weighted/base): train=0.4848/0.4379, val=2.5400/1.5013
[2025-11-13 03:30:20,380][INFO]   Val S1->S2 token ratio: 3.02%
[2025-11-13 03:30:20,380][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:30:20,380][INFO]   S2->S3: 74.73% (68/91)
[2025-11-13 03:30:20,380][INFO]   S1->S3: 88.89% (120/135)
[2025-11-13 03:30:20,380][INFO]   overall: 59.68% (188/315)
[2025-11-13 03:30:20,380][INFO] ======================================================================
[2025-11-13 03:30:33,361][INFO] ======================================================================
[2025-11-13 03:30:33,362][INFO] Iteration 17000
[2025-11-13 03:30:33,362][INFO] Loss (weighted/base): train=0.4811/0.4349, val=2.5362/1.5054
[2025-11-13 03:30:33,362][INFO]   Val S1->S2 token ratio: 3.03%
[2025-11-13 03:30:33,362][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:30:33,362][INFO]   S2->S3: 82.42% (75/91)
[2025-11-13 03:30:33,362][INFO]   S1->S3: 88.89% (120/135)
[2025-11-13 03:30:33,362][INFO]   overall: 61.90% (195/315)
[2025-11-13 03:30:33,362][INFO] ======================================================================
[2025-11-13 03:30:46,372][INFO] ======================================================================
[2025-11-13 03:30:46,372][INFO] Iteration 18000
[2025-11-13 03:30:46,372][INFO] Loss (weighted/base): train=0.4781/0.4322, val=2.5437/1.5208
[2025-11-13 03:30:46,372][INFO]   Val S1->S2 token ratio: 2.98%
[2025-11-13 03:30:46,372][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:30:46,372][INFO]   S2->S3: 82.42% (75/91)
[2025-11-13 03:30:46,372][INFO]   S1->S3: 88.89% (120/135)
[2025-11-13 03:30:46,372][INFO]   overall: 61.90% (195/315)
[2025-11-13 03:30:46,372][INFO] ======================================================================
[2025-11-13 03:30:59,380][INFO] ======================================================================
[2025-11-13 03:30:59,380][INFO] Iteration 19000
[2025-11-13 03:30:59,380][INFO] Loss (weighted/base): train=0.4748/0.4297, val=2.6415/1.5687
[2025-11-13 03:30:59,380][INFO]   Val S1->S2 token ratio: 3.01%
[2025-11-13 03:30:59,380][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:30:59,380][INFO]   S2->S3: 73.63% (67/91)
[2025-11-13 03:30:59,380][INFO]   S1->S3: 89.63% (121/135)
[2025-11-13 03:30:59,380][INFO]   overall: 59.68% (188/315)
[2025-11-13 03:30:59,380][INFO] ======================================================================
[2025-11-13 03:31:12,400][INFO] ======================================================================
[2025-11-13 03:31:12,400][INFO] Iteration 20000
[2025-11-13 03:31:12,400][INFO] Loss (weighted/base): train=0.4723/0.4275, val=2.6502/1.5893
[2025-11-13 03:31:12,400][INFO]   Val S1->S2 token ratio: 3.00%
[2025-11-13 03:31:12,400][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:31:12,400][INFO]   S2->S3: 75.82% (69/91)
[2025-11-13 03:31:12,400][INFO]   S1->S3: 82.96% (112/135)
[2025-11-13 03:31:12,400][INFO]   overall: 57.46% (181/315)
[2025-11-13 03:31:12,400][INFO] ======================================================================
[2025-11-13 03:31:12,404][INFO] Saved checkpoint: out/composition_20251113_032643/ckpt_20000.pt
[2025-11-13 03:31:25,435][INFO] ======================================================================
[2025-11-13 03:31:25,436][INFO] Iteration 21000
[2025-11-13 03:31:25,436][INFO] Loss (weighted/base): train=0.4697/0.4254, val=2.7029/1.6061
[2025-11-13 03:31:25,436][INFO]   Val S1->S2 token ratio: 3.06%
[2025-11-13 03:31:25,436][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:31:25,436][INFO]   S2->S3: 79.12% (72/91)
[2025-11-13 03:31:25,436][INFO]   S1->S3: 89.63% (121/135)
[2025-11-13 03:31:25,436][INFO]   overall: 61.27% (193/315)
[2025-11-13 03:31:25,436][INFO] ======================================================================
[2025-11-13 03:31:38,478][INFO] ======================================================================
[2025-11-13 03:31:38,478][INFO] Iteration 22000
[2025-11-13 03:31:38,479][INFO] Loss (weighted/base): train=0.4670/0.4230, val=2.7066/1.6155
[2025-11-13 03:31:38,479][INFO]   Val S1->S2 token ratio: 3.07%
[2025-11-13 03:31:38,479][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:31:38,479][INFO]   S2->S3: 75.82% (69/91)
[2025-11-13 03:31:38,479][INFO]   S1->S3: 85.19% (115/135)
[2025-11-13 03:31:38,479][INFO]   overall: 58.41% (184/315)
[2025-11-13 03:31:38,479][INFO] ======================================================================
[2025-11-13 03:31:51,477][INFO] ======================================================================
[2025-11-13 03:31:51,477][INFO] Iteration 23000
[2025-11-13 03:31:51,477][INFO] Loss (weighted/base): train=0.4651/0.4213, val=2.7555/1.6397
[2025-11-13 03:31:51,477][INFO]   Val S1->S2 token ratio: 3.01%
[2025-11-13 03:31:51,477][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:31:51,477][INFO]   S2->S3: 72.53% (66/91)
[2025-11-13 03:31:51,477][INFO]   S1->S3: 86.67% (117/135)
[2025-11-13 03:31:51,478][INFO]   overall: 58.10% (183/315)
[2025-11-13 03:31:51,478][INFO] ======================================================================
[2025-11-13 03:32:04,503][INFO] ======================================================================
[2025-11-13 03:32:04,503][INFO] Iteration 24000
[2025-11-13 03:32:04,503][INFO] Loss (weighted/base): train=0.4628/0.4193, val=2.7945/1.6665
[2025-11-13 03:32:04,503][INFO]   Val S1->S2 token ratio: 3.03%
[2025-11-13 03:32:04,503][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:32:04,503][INFO]   S2->S3: 75.82% (69/91)
[2025-11-13 03:32:04,503][INFO]   S1->S3: 92.59% (125/135)
[2025-11-13 03:32:04,503][INFO]   overall: 61.59% (194/315)
[2025-11-13 03:32:04,503][INFO] ======================================================================
[2025-11-13 03:32:17,439][INFO] ======================================================================
[2025-11-13 03:32:17,439][INFO] Iteration 25000
[2025-11-13 03:32:17,439][INFO] Loss (weighted/base): train=0.4606/0.4174, val=2.7944/1.6712
[2025-11-13 03:32:17,439][INFO]   Val S1->S2 token ratio: 3.01%
[2025-11-13 03:32:17,439][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:32:17,439][INFO]   S2->S3: 80.22% (73/91)
[2025-11-13 03:32:17,439][INFO]   S1->S3: 90.37% (122/135)
[2025-11-13 03:32:17,439][INFO]   overall: 61.90% (195/315)
[2025-11-13 03:32:17,439][INFO] ======================================================================
[2025-11-13 03:32:17,442][INFO] Saved checkpoint: out/composition_20251113_032643/ckpt_25000.pt
[2025-11-13 03:32:30,326][INFO] ======================================================================
[2025-11-13 03:32:30,326][INFO] Iteration 26000
[2025-11-13 03:32:30,326][INFO] Loss (weighted/base): train=0.4588/0.4157, val=2.8512/1.6917
[2025-11-13 03:32:30,326][INFO]   Val S1->S2 token ratio: 3.08%
[2025-11-13 03:32:30,326][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:32:30,326][INFO]   S2->S3: 83.52% (76/91)
[2025-11-13 03:32:30,326][INFO]   S1->S3: 91.85% (124/135)
[2025-11-13 03:32:30,326][INFO]   overall: 63.49% (200/315)
[2025-11-13 03:32:30,326][INFO] ======================================================================
[2025-11-13 03:32:43,198][INFO] ======================================================================
[2025-11-13 03:32:43,198][INFO] Iteration 27000
[2025-11-13 03:32:43,198][INFO] Loss (weighted/base): train=0.4567/0.4138, val=2.8235/1.6883
[2025-11-13 03:32:43,198][INFO]   Val S1->S2 token ratio: 3.03%
[2025-11-13 03:32:43,198][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:32:43,198][INFO]   S2->S3: 80.22% (73/91)
[2025-11-13 03:32:43,198][INFO]   S1->S3: 88.15% (119/135)
[2025-11-13 03:32:43,198][INFO]   overall: 60.95% (192/315)
[2025-11-13 03:32:43,198][INFO] ======================================================================
[2025-11-13 03:32:56,071][INFO] ======================================================================
[2025-11-13 03:32:56,071][INFO] Iteration 28000
[2025-11-13 03:32:56,072][INFO] Loss (weighted/base): train=0.4552/0.4124, val=2.7911/1.6716
[2025-11-13 03:32:56,072][INFO]   Val S1->S2 token ratio: 2.99%
[2025-11-13 03:32:56,072][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:32:56,072][INFO]   S2->S3: 73.63% (67/91)
[2025-11-13 03:32:56,072][INFO]   S1->S3: 86.67% (117/135)
[2025-11-13 03:32:56,072][INFO]   overall: 58.41% (184/315)
[2025-11-13 03:32:56,072][INFO] ======================================================================
[2025-11-13 03:33:08,982][INFO] ======================================================================
[2025-11-13 03:33:08,983][INFO] Iteration 29000
[2025-11-13 03:33:08,983][INFO] Loss (weighted/base): train=0.4534/0.4107, val=2.8554/1.7036
[2025-11-13 03:33:08,983][INFO]   Val S1->S2 token ratio: 3.02%
[2025-11-13 03:33:08,983][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:33:08,983][INFO]   S2->S3: 74.73% (68/91)
[2025-11-13 03:33:08,983][INFO]   S1->S3: 82.22% (111/135)
[2025-11-13 03:33:08,983][INFO]   overall: 56.83% (179/315)
[2025-11-13 03:33:08,983][INFO] ======================================================================
[2025-11-13 03:33:21,899][INFO] ======================================================================
[2025-11-13 03:33:21,899][INFO] Iteration 30000
[2025-11-13 03:33:21,899][INFO] Loss (weighted/base): train=0.4520/0.4095, val=2.8857/1.7138
[2025-11-13 03:33:21,899][INFO]   Val S1->S2 token ratio: 3.08%
[2025-11-13 03:33:21,899][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:33:21,899][INFO]   S2->S3: 74.73% (68/91)
[2025-11-13 03:33:21,900][INFO]   S1->S3: 83.70% (113/135)
[2025-11-13 03:33:21,900][INFO]   overall: 57.46% (181/315)
[2025-11-13 03:33:21,900][INFO] ======================================================================
[2025-11-13 03:33:21,902][INFO] Saved checkpoint: out/composition_20251113_032643/ckpt_30000.pt
[2025-11-13 03:33:34,778][INFO] ======================================================================
[2025-11-13 03:33:34,778][INFO] Iteration 31000
[2025-11-13 03:33:34,778][INFO] Loss (weighted/base): train=0.4504/0.4080, val=2.8856/1.7395
[2025-11-13 03:33:34,778][INFO]   Val S1->S2 token ratio: 3.02%
[2025-11-13 03:33:34,778][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:33:34,778][INFO]   S2->S3: 72.53% (66/91)
[2025-11-13 03:33:34,779][INFO]   S1->S3: 85.93% (116/135)
[2025-11-13 03:33:34,779][INFO]   overall: 57.78% (182/315)
[2025-11-13 03:33:34,779][INFO] ======================================================================
[2025-11-13 03:33:47,688][INFO] ======================================================================
[2025-11-13 03:33:47,689][INFO] Iteration 32000
[2025-11-13 03:33:47,689][INFO] Loss (weighted/base): train=0.4488/0.4065, val=2.9430/1.7618
[2025-11-13 03:33:47,689][INFO]   Val S1->S2 token ratio: 3.06%
[2025-11-13 03:33:47,689][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:33:47,689][INFO]   S2->S3: 70.33% (64/91)
[2025-11-13 03:33:47,689][INFO]   S1->S3: 87.41% (118/135)
[2025-11-13 03:33:47,689][INFO]   overall: 57.78% (182/315)
[2025-11-13 03:33:47,689][INFO] ======================================================================
[2025-11-13 03:34:00,582][INFO] ======================================================================
[2025-11-13 03:34:00,582][INFO] Iteration 33000
[2025-11-13 03:34:00,582][INFO] Loss (weighted/base): train=0.4473/0.4052, val=2.9554/1.7533
[2025-11-13 03:34:00,582][INFO]   Val S1->S2 token ratio: 3.08%
[2025-11-13 03:34:00,582][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:34:00,582][INFO]   S2->S3: 79.12% (72/91)
[2025-11-13 03:34:00,583][INFO]   S1->S3: 82.22% (111/135)
[2025-11-13 03:34:00,583][INFO]   overall: 58.10% (183/315)
[2025-11-13 03:34:00,583][INFO] ======================================================================
[2025-11-13 03:34:13,580][INFO] ======================================================================
[2025-11-13 03:34:13,580][INFO] Iteration 34000
[2025-11-13 03:34:13,581][INFO] Loss (weighted/base): train=0.4457/0.4039, val=2.9128/1.7623
[2025-11-13 03:34:13,581][INFO]   Val S1->S2 token ratio: 3.01%
[2025-11-13 03:34:13,581][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:34:13,581][INFO]   S2->S3: 78.02% (71/91)
[2025-11-13 03:34:13,581][INFO]   S1->S3: 83.70% (113/135)
[2025-11-13 03:34:13,581][INFO]   overall: 58.41% (184/315)
[2025-11-13 03:34:13,581][INFO] ======================================================================
[2025-11-13 03:34:26,595][INFO] ======================================================================
[2025-11-13 03:34:26,595][INFO] Iteration 35000
[2025-11-13 03:34:26,595][INFO] Loss (weighted/base): train=0.4447/0.4027, val=2.9319/1.7619
[2025-11-13 03:34:26,595][INFO]   Val S1->S2 token ratio: 3.03%
[2025-11-13 03:34:26,595][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:34:26,595][INFO]   S2->S3: 76.92% (70/91)
[2025-11-13 03:34:26,595][INFO]   S1->S3: 80.00% (108/135)
[2025-11-13 03:34:26,595][INFO]   overall: 56.51% (178/315)
[2025-11-13 03:34:26,595][INFO] ======================================================================
[2025-11-13 03:34:26,599][INFO] Saved checkpoint: out/composition_20251113_032643/ckpt_35000.pt
[2025-11-13 03:34:39,625][INFO] ======================================================================
[2025-11-13 03:34:39,625][INFO] Iteration 36000
[2025-11-13 03:34:39,625][INFO] Loss (weighted/base): train=0.4429/0.4013, val=2.9273/1.7671
[2025-11-13 03:34:39,625][INFO]   Val S1->S2 token ratio: 3.02%
[2025-11-13 03:34:39,625][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:34:39,625][INFO]   S2->S3: 74.73% (68/91)
[2025-11-13 03:34:39,625][INFO]   S1->S3: 84.44% (114/135)
[2025-11-13 03:34:39,625][INFO]   overall: 57.78% (182/315)
[2025-11-13 03:34:39,625][INFO] ======================================================================
[2025-11-13 03:34:52,602][INFO] ======================================================================
[2025-11-13 03:34:52,602][INFO] Iteration 37000
[2025-11-13 03:34:52,602][INFO] Loss (weighted/base): train=0.4420/0.4002, val=3.0025/1.8002
[2025-11-13 03:34:52,602][INFO]   Val S1->S2 token ratio: 3.08%
[2025-11-13 03:34:52,602][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:34:52,602][INFO]   S2->S3: 82.42% (75/91)
[2025-11-13 03:34:52,602][INFO]   S1->S3: 80.74% (109/135)
[2025-11-13 03:34:52,602][INFO]   overall: 58.41% (184/315)
[2025-11-13 03:34:52,602][INFO] ======================================================================
[2025-11-13 03:35:05,636][INFO] ======================================================================
[2025-11-13 03:35:05,636][INFO] Iteration 38000
[2025-11-13 03:35:05,636][INFO] Loss (weighted/base): train=0.4406/0.3991, val=2.9531/1.7947
[2025-11-13 03:35:05,636][INFO]   Val S1->S2 token ratio: 2.99%
[2025-11-13 03:35:05,636][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:35:05,636][INFO]   S2->S3: 75.82% (69/91)
[2025-11-13 03:35:05,636][INFO]   S1->S3: 85.93% (116/135)
[2025-11-13 03:35:05,636][INFO]   overall: 58.73% (185/315)
[2025-11-13 03:35:05,636][INFO] ======================================================================
[2025-11-13 03:35:18,723][INFO] ======================================================================
[2025-11-13 03:35:18,723][INFO] Iteration 39000
[2025-11-13 03:35:18,723][INFO] Loss (weighted/base): train=0.4393/0.3978, val=3.0350/1.8407
[2025-11-13 03:35:18,723][INFO]   Val S1->S2 token ratio: 3.03%
[2025-11-13 03:35:18,723][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:35:18,723][INFO]   S2->S3: 78.02% (71/91)
[2025-11-13 03:35:18,723][INFO]   S1->S3: 80.74% (109/135)
[2025-11-13 03:35:18,723][INFO]   overall: 57.14% (180/315)
[2025-11-13 03:35:18,723][INFO] ======================================================================
[2025-11-13 03:35:31,763][INFO] ======================================================================
[2025-11-13 03:35:31,763][INFO] Iteration 40000
[2025-11-13 03:35:31,763][INFO] Loss (weighted/base): train=0.4381/0.3967, val=3.0234/1.8369
[2025-11-13 03:35:31,763][INFO]   Val S1->S2 token ratio: 3.06%
[2025-11-13 03:35:31,763][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:35:31,763][INFO]   S2->S3: 75.82% (69/91)
[2025-11-13 03:35:31,763][INFO]   S1->S3: 80.74% (109/135)
[2025-11-13 03:35:31,763][INFO]   overall: 56.51% (178/315)
[2025-11-13 03:35:31,763][INFO] ======================================================================
[2025-11-13 03:35:31,766][INFO] Saved checkpoint: out/composition_20251113_032643/ckpt_40000.pt
[2025-11-13 03:35:44,764][INFO] ======================================================================
[2025-11-13 03:35:44,764][INFO] Iteration 41000
[2025-11-13 03:35:44,764][INFO] Loss (weighted/base): train=0.4372/0.3958, val=2.9778/1.8129
[2025-11-13 03:35:44,764][INFO]   Val S1->S2 token ratio: 3.00%
[2025-11-13 03:35:44,764][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:35:44,764][INFO]   S2->S3: 71.43% (65/91)
[2025-11-13 03:35:44,764][INFO]   S1->S3: 88.15% (119/135)
[2025-11-13 03:35:44,764][INFO]   overall: 58.41% (184/315)
[2025-11-13 03:35:44,764][INFO] ======================================================================
[2025-11-13 03:35:57,768][INFO] ======================================================================
[2025-11-13 03:35:57,768][INFO] Iteration 42000
[2025-11-13 03:35:57,768][INFO] Loss (weighted/base): train=0.4358/0.3947, val=3.0121/1.8238
[2025-11-13 03:35:57,768][INFO]   Val S1->S2 token ratio: 3.03%
[2025-11-13 03:35:57,768][INFO]   S1->S2: 1.12% (1/89)
[2025-11-13 03:35:57,768][INFO]   S2->S3: 75.82% (69/91)
[2025-11-13 03:35:57,768][INFO]   S1->S3: 77.78% (105/135)
[2025-11-13 03:35:57,768][INFO]   overall: 55.56% (175/315)
[2025-11-13 03:35:57,768][INFO] ======================================================================
[2025-11-13 03:36:10,740][INFO] ======================================================================
[2025-11-13 03:36:10,740][INFO] Iteration 43000
[2025-11-13 03:36:10,740][INFO] Loss (weighted/base): train=0.4348/0.3937, val=3.0385/1.8449
[2025-11-13 03:36:10,740][INFO]   Val S1->S2 token ratio: 3.05%
[2025-11-13 03:36:10,740][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:36:10,740][INFO]   S2->S3: 75.82% (69/91)
[2025-11-13 03:36:10,740][INFO]   S1->S3: 81.48% (110/135)
[2025-11-13 03:36:10,740][INFO]   overall: 56.83% (179/315)
[2025-11-13 03:36:10,740][INFO] ======================================================================
[2025-11-13 03:36:23,739][INFO] ======================================================================
[2025-11-13 03:36:23,739][INFO] Iteration 44000
[2025-11-13 03:36:23,739][INFO] Loss (weighted/base): train=0.4342/0.3931, val=3.0779/1.8500
[2025-11-13 03:36:23,739][INFO]   Val S1->S2 token ratio: 3.04%
[2025-11-13 03:36:23,739][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:36:23,739][INFO]   S2->S3: 76.92% (70/91)
[2025-11-13 03:36:23,739][INFO]   S1->S3: 85.93% (116/135)
[2025-11-13 03:36:23,739][INFO]   overall: 59.05% (186/315)
[2025-11-13 03:36:23,739][INFO] ======================================================================
[2025-11-13 03:36:36,725][INFO] ======================================================================
[2025-11-13 03:36:36,726][INFO] Iteration 45000
[2025-11-13 03:36:36,726][INFO] Loss (weighted/base): train=0.4332/0.3920, val=3.0283/1.8514
[2025-11-13 03:36:36,726][INFO]   Val S1->S2 token ratio: 2.99%
[2025-11-13 03:36:36,726][INFO]   S1->S2: 1.12% (1/89)
[2025-11-13 03:36:36,726][INFO]   S2->S3: 71.43% (65/91)
[2025-11-13 03:36:36,726][INFO]   S1->S3: 83.70% (113/135)
[2025-11-13 03:36:36,726][INFO]   overall: 56.83% (179/315)
[2025-11-13 03:36:36,726][INFO] ======================================================================
[2025-11-13 03:36:36,729][INFO] Saved checkpoint: out/composition_20251113_032643/ckpt_45000.pt
[2025-11-13 03:36:49,635][INFO] ======================================================================
[2025-11-13 03:36:49,635][INFO] Iteration 46000
[2025-11-13 03:36:49,635][INFO] Loss (weighted/base): train=0.4323/0.3911, val=3.0956/1.8799
[2025-11-13 03:36:49,635][INFO]   Val S1->S2 token ratio: 3.05%
[2025-11-13 03:36:49,635][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:36:49,635][INFO]   S2->S3: 70.33% (64/91)
[2025-11-13 03:36:49,635][INFO]   S1->S3: 79.26% (107/135)
[2025-11-13 03:36:49,635][INFO]   overall: 54.29% (171/315)
[2025-11-13 03:36:49,635][INFO] ======================================================================
[2025-11-13 03:37:02,551][INFO] ======================================================================
[2025-11-13 03:37:02,551][INFO] Iteration 47000
[2025-11-13 03:37:02,551][INFO] Loss (weighted/base): train=0.4314/0.3901, val=3.0996/1.8758
[2025-11-13 03:37:02,551][INFO]   Val S1->S2 token ratio: 3.09%
[2025-11-13 03:37:02,551][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:37:02,551][INFO]   S2->S3: 73.63% (67/91)
[2025-11-13 03:37:02,551][INFO]   S1->S3: 80.00% (108/135)
[2025-11-13 03:37:02,551][INFO]   overall: 55.56% (175/315)
[2025-11-13 03:37:02,551][INFO] ======================================================================
[2025-11-13 03:37:15,470][INFO] ======================================================================
[2025-11-13 03:37:15,471][INFO] Iteration 48000
[2025-11-13 03:37:15,471][INFO] Loss (weighted/base): train=0.4302/0.3891, val=3.1341/1.9064
[2025-11-13 03:37:15,471][INFO]   Val S1->S2 token ratio: 3.09%
[2025-11-13 03:37:15,471][INFO]   S1->S2: 1.12% (1/89)
[2025-11-13 03:37:15,471][INFO]   S2->S3: 73.63% (67/91)
[2025-11-13 03:37:15,471][INFO]   S1->S3: 83.70% (113/135)
[2025-11-13 03:37:15,471][INFO]   overall: 57.46% (181/315)
[2025-11-13 03:37:15,471][INFO] ======================================================================
[2025-11-13 03:37:28,419][INFO] ======================================================================
[2025-11-13 03:37:28,419][INFO] Iteration 49000
[2025-11-13 03:37:28,419][INFO] Loss (weighted/base): train=0.4297/0.3885, val=3.0711/1.8738
[2025-11-13 03:37:28,419][INFO]   Val S1->S2 token ratio: 3.04%
[2025-11-13 03:37:28,419][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:37:28,419][INFO]   S2->S3: 69.23% (63/91)
[2025-11-13 03:37:28,419][INFO]   S1->S3: 81.48% (110/135)
[2025-11-13 03:37:28,419][INFO]   overall: 54.92% (173/315)
[2025-11-13 03:37:28,419][INFO] ======================================================================
[2025-11-13 03:37:41,418][INFO] ======================================================================
[2025-11-13 03:37:41,418][INFO] Iteration 50000
[2025-11-13 03:37:41,418][INFO] Loss (weighted/base): train=0.4283/0.3874, val=3.1541/1.9272
[2025-11-13 03:37:41,418][INFO]   Val S1->S2 token ratio: 3.02%
[2025-11-13 03:37:41,418][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:37:41,418][INFO]   S2->S3: 65.93% (60/91)
[2025-11-13 03:37:41,418][INFO]   S1->S3: 82.22% (111/135)
[2025-11-13 03:37:41,418][INFO]   overall: 54.29% (171/315)
[2025-11-13 03:37:41,418][INFO] ======================================================================
[2025-11-13 03:37:41,421][INFO] Saved checkpoint: out/composition_20251113_032643/ckpt_50000.pt
[2025-11-13 03:37:41,421][INFO] Training finished. Outputs saved to out/composition_20251113_032643
