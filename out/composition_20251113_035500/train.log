[2025-11-13 03:55:00,580][INFO] Starting GraphA Tier-3 training
[2025-11-13 03:55:00,581][INFO] Vocabulary size: 92
[2025-11-13 03:55:00,581][INFO] Block size: 32
[2025-11-13 03:55:00,581][INFO] S1->S2 loss multiplier: 8.00
[2025-11-13 03:55:01,292][INFO] Model parameters: 0.11M
[2025-11-13 03:55:01,293][INFO] Entering training loop (max_iters=50000)
[2025-11-13 03:55:07,070][INFO] ======================================================================
[2025-11-13 03:55:07,070][INFO] Iteration 0
[2025-11-13 03:55:07,070][INFO] Loss (weighted/base): train=nan/nan, val=4.8693/3.9065
[2025-11-13 03:55:07,070][INFO]   Val S1->S2 token ratio: 3.00%
[2025-11-13 03:55:07,070][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:55:07,070][INFO]   S2->S3: 0.00% (0/91)
[2025-11-13 03:55:07,070][INFO]   S1->S3: 0.00% (0/135)
[2025-11-13 03:55:07,070][INFO]   overall: 0.00% (0/315)
[2025-11-13 03:55:07,070][INFO] ======================================================================
[2025-11-13 03:55:20,128][INFO] ======================================================================
[2025-11-13 03:55:20,128][INFO] Iteration 1000
[2025-11-13 03:55:20,128][INFO] Loss (weighted/base): train=2.4167/1.6784, val=1.8342/0.9861
[2025-11-13 03:55:20,128][INFO]   Val S1->S2 token ratio: 3.06%
[2025-11-13 03:55:20,128][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:55:20,128][INFO]   S2->S3: 25.27% (23/91)
[2025-11-13 03:55:20,128][INFO]   S1->S3: 19.26% (26/135)
[2025-11-13 03:55:20,128][INFO]   overall: 15.56% (49/315)
[2025-11-13 03:55:20,128][INFO] ======================================================================
[2025-11-13 03:55:33,101][INFO] ======================================================================
[2025-11-13 03:55:33,101][INFO] Iteration 2000
[2025-11-13 03:55:33,101][INFO] Loss (weighted/base): train=1.1882/0.7169, val=2.0543/1.0669
[2025-11-13 03:55:33,101][INFO]   Val S1->S2 token ratio: 3.01%
[2025-11-13 03:55:33,101][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:55:33,101][INFO]   S2->S3: 97.80% (89/91)
[2025-11-13 03:55:33,101][INFO]   S1->S3: 98.52% (133/135)
[2025-11-13 03:55:33,101][INFO]   overall: 70.48% (222/315)
[2025-11-13 03:55:33,101][INFO] ======================================================================
[2025-11-13 03:55:46,072][INFO] ======================================================================
[2025-11-13 03:55:46,072][INFO] Iteration 3000
[2025-11-13 03:55:46,073][INFO] Loss (weighted/base): train=0.9880/0.5718, val=2.1763/1.0766
[2025-11-13 03:55:46,073][INFO]   Val S1->S2 token ratio: 2.99%
[2025-11-13 03:55:46,073][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:55:46,073][INFO]   S2->S3: 80.22% (73/91)
[2025-11-13 03:55:46,073][INFO]   S1->S3: 98.52% (133/135)
[2025-11-13 03:55:46,073][INFO]   overall: 65.40% (206/315)
[2025-11-13 03:55:46,073][INFO] ======================================================================
[2025-11-13 03:55:58,985][INFO] ======================================================================
[2025-11-13 03:55:58,985][INFO] Iteration 4000
[2025-11-13 03:55:58,985][INFO] Loss (weighted/base): train=0.8842/0.5459, val=2.3918/1.1311
[2025-11-13 03:55:58,985][INFO]   Val S1->S2 token ratio: 3.06%
[2025-11-13 03:55:58,985][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:55:58,985][INFO]   S2->S3: 83.52% (76/91)
[2025-11-13 03:55:58,985][INFO]   S1->S3: 93.33% (126/135)
[2025-11-13 03:55:58,985][INFO]   overall: 64.13% (202/315)
[2025-11-13 03:55:58,985][INFO] ======================================================================
[2025-11-13 03:56:11,864][INFO] ======================================================================
[2025-11-13 03:56:11,864][INFO] Iteration 5000
[2025-11-13 03:56:11,864][INFO] Loss (weighted/base): train=0.7892/0.5304, val=2.6808/1.2063
[2025-11-13 03:56:11,865][INFO]   Val S1->S2 token ratio: 3.13%
[2025-11-13 03:56:11,865][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:56:11,865][INFO]   S2->S3: 83.52% (76/91)
[2025-11-13 03:56:11,865][INFO]   S1->S3: 95.56% (129/135)
[2025-11-13 03:56:11,865][INFO]   overall: 65.08% (205/315)
[2025-11-13 03:56:11,865][INFO] ======================================================================
[2025-11-13 03:56:11,868][INFO] Saved checkpoint: out/composition_20251113_035500/ckpt_5000.pt
[2025-11-13 03:56:24,720][INFO] ======================================================================
[2025-11-13 03:56:24,720][INFO] Iteration 6000
[2025-11-13 03:56:24,720][INFO] Loss (weighted/base): train=0.7156/0.5181, val=2.8823/1.2584
[2025-11-13 03:56:24,720][INFO]   Val S1->S2 token ratio: 3.11%
[2025-11-13 03:56:24,720][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:56:24,720][INFO]   S2->S3: 79.12% (72/91)
[2025-11-13 03:56:24,720][INFO]   S1->S3: 92.59% (125/135)
[2025-11-13 03:56:24,720][INFO]   overall: 62.54% (197/315)
[2025-11-13 03:56:24,720][INFO] ======================================================================
[2025-11-13 03:56:37,606][INFO] ======================================================================
[2025-11-13 03:56:37,606][INFO] Iteration 7000
[2025-11-13 03:56:37,606][INFO] Loss (weighted/base): train=0.6663/0.5084, val=2.9947/1.2877
[2025-11-13 03:56:37,606][INFO]   Val S1->S2 token ratio: 3.00%
[2025-11-13 03:56:37,606][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:56:37,606][INFO]   S2->S3: 70.33% (64/91)
[2025-11-13 03:56:37,606][INFO]   S1->S3: 94.07% (127/135)
[2025-11-13 03:56:37,606][INFO]   overall: 60.63% (191/315)
[2025-11-13 03:56:37,606][INFO] ======================================================================
[2025-11-13 03:56:50,470][INFO] ======================================================================
[2025-11-13 03:56:50,471][INFO] Iteration 8000
[2025-11-13 03:56:50,471][INFO] Loss (weighted/base): train=0.6350/0.4998, val=3.2311/1.3475
[2025-11-13 03:56:50,471][INFO]   Val S1->S2 token ratio: 3.05%
[2025-11-13 03:56:50,471][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:56:50,471][INFO]   S2->S3: 73.63% (67/91)
[2025-11-13 03:56:50,471][INFO]   S1->S3: 93.33% (126/135)
[2025-11-13 03:56:50,471][INFO]   overall: 61.27% (193/315)
[2025-11-13 03:56:50,471][INFO] ======================================================================
[2025-11-13 03:57:03,295][INFO] ======================================================================
[2025-11-13 03:57:03,295][INFO] Iteration 9000
[2025-11-13 03:57:03,295][INFO] Loss (weighted/base): train=0.6155/0.4929, val=3.3686/1.3730
[2025-11-13 03:57:03,295][INFO]   Val S1->S2 token ratio: 3.09%
[2025-11-13 03:57:03,295][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:57:03,295][INFO]   S2->S3: 80.22% (73/91)
[2025-11-13 03:57:03,295][INFO]   S1->S3: 92.59% (125/135)
[2025-11-13 03:57:03,295][INFO]   overall: 62.86% (198/315)
[2025-11-13 03:57:03,295][INFO] ======================================================================
[2025-11-13 03:57:16,132][INFO] ======================================================================
[2025-11-13 03:57:16,132][INFO] Iteration 10000
[2025-11-13 03:57:16,132][INFO] Loss (weighted/base): train=0.6023/0.4870, val=3.3722/1.3827
[2025-11-13 03:57:16,132][INFO]   Val S1->S2 token ratio: 3.04%
[2025-11-13 03:57:16,132][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:57:16,132][INFO]   S2->S3: 71.43% (65/91)
[2025-11-13 03:57:16,132][INFO]   S1->S3: 89.63% (121/135)
[2025-11-13 03:57:16,132][INFO]   overall: 59.05% (186/315)
[2025-11-13 03:57:16,132][INFO] ======================================================================
[2025-11-13 03:57:16,136][INFO] Saved checkpoint: out/composition_20251113_035500/ckpt_10000.pt
[2025-11-13 03:57:28,953][INFO] ======================================================================
[2025-11-13 03:57:28,953][INFO] Iteration 11000
[2025-11-13 03:57:28,953][INFO] Loss (weighted/base): train=0.5920/0.4821, val=3.4575/1.3856
[2025-11-13 03:57:28,953][INFO]   Val S1->S2 token ratio: 3.02%
[2025-11-13 03:57:28,953][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:57:28,954][INFO]   S2->S3: 62.64% (57/91)
[2025-11-13 03:57:28,954][INFO]   S1->S3: 87.41% (118/135)
[2025-11-13 03:57:28,954][INFO]   overall: 55.56% (175/315)
[2025-11-13 03:57:28,954][INFO] ======================================================================
[2025-11-13 03:57:41,800][INFO] ======================================================================
[2025-11-13 03:57:41,800][INFO] Iteration 12000
[2025-11-13 03:57:41,800][INFO] Loss (weighted/base): train=0.5840/0.4774, val=3.4415/1.3771
[2025-11-13 03:57:41,800][INFO]   Val S1->S2 token ratio: 3.01%
[2025-11-13 03:57:41,800][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:57:41,800][INFO]   S2->S3: 72.53% (66/91)
[2025-11-13 03:57:41,800][INFO]   S1->S3: 92.59% (125/135)
[2025-11-13 03:57:41,800][INFO]   overall: 60.63% (191/315)
[2025-11-13 03:57:41,800][INFO] ======================================================================
[2025-11-13 03:57:54,669][INFO] ======================================================================
[2025-11-13 03:57:54,669][INFO] Iteration 13000
[2025-11-13 03:57:54,669][INFO] Loss (weighted/base): train=0.5775/0.4740, val=3.5136/1.4263
[2025-11-13 03:57:54,669][INFO]   Val S1->S2 token ratio: 3.01%
[2025-11-13 03:57:54,669][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:57:54,670][INFO]   S2->S3: 73.63% (67/91)
[2025-11-13 03:57:54,670][INFO]   S1->S3: 94.81% (128/135)
[2025-11-13 03:57:54,670][INFO]   overall: 61.90% (195/315)
[2025-11-13 03:57:54,670][INFO] ======================================================================
[2025-11-13 03:58:07,536][INFO] ======================================================================
[2025-11-13 03:58:07,536][INFO] Iteration 14000
[2025-11-13 03:58:07,536][INFO] Loss (weighted/base): train=0.5714/0.4703, val=3.6174/1.4120
[2025-11-13 03:58:07,536][INFO]   Val S1->S2 token ratio: 3.10%
[2025-11-13 03:58:07,536][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:58:07,536][INFO]   S2->S3: 72.53% (66/91)
[2025-11-13 03:58:07,536][INFO]   S1->S3: 94.07% (127/135)
[2025-11-13 03:58:07,536][INFO]   overall: 61.27% (193/315)
[2025-11-13 03:58:07,536][INFO] ======================================================================
[2025-11-13 03:58:20,378][INFO] ======================================================================
[2025-11-13 03:58:20,378][INFO] Iteration 15000
[2025-11-13 03:58:20,378][INFO] Loss (weighted/base): train=0.5659/0.4669, val=3.6367/1.4200
[2025-11-13 03:58:20,378][INFO]   Val S1->S2 token ratio: 3.07%
[2025-11-13 03:58:20,378][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:58:20,378][INFO]   S2->S3: 65.93% (60/91)
[2025-11-13 03:58:20,378][INFO]   S1->S3: 94.07% (127/135)
[2025-11-13 03:58:20,378][INFO]   overall: 59.37% (187/315)
[2025-11-13 03:58:20,378][INFO] ======================================================================
[2025-11-13 03:58:20,381][INFO] Saved checkpoint: out/composition_20251113_035500/ckpt_15000.pt
[2025-11-13 03:58:33,216][INFO] ======================================================================
[2025-11-13 03:58:33,216][INFO] Iteration 16000
[2025-11-13 03:58:33,216][INFO] Loss (weighted/base): train=0.5615/0.4643, val=3.6077/1.4261
[2025-11-13 03:58:33,216][INFO]   Val S1->S2 token ratio: 3.02%
[2025-11-13 03:58:33,216][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:58:33,216][INFO]   S2->S3: 75.82% (69/91)
[2025-11-13 03:58:33,216][INFO]   S1->S3: 96.30% (130/135)
[2025-11-13 03:58:33,217][INFO]   overall: 63.17% (199/315)
[2025-11-13 03:58:33,217][INFO] ======================================================================
[2025-11-13 03:58:46,039][INFO] ======================================================================
[2025-11-13 03:58:46,039][INFO] Iteration 17000
[2025-11-13 03:58:46,039][INFO] Loss (weighted/base): train=0.5568/0.4615, val=3.6511/1.4222
[2025-11-13 03:58:46,039][INFO]   Val S1->S2 token ratio: 3.03%
[2025-11-13 03:58:46,039][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:58:46,039][INFO]   S2->S3: 71.43% (65/91)
[2025-11-13 03:58:46,039][INFO]   S1->S3: 95.56% (129/135)
[2025-11-13 03:58:46,039][INFO]   overall: 61.59% (194/315)
[2025-11-13 03:58:46,039][INFO] ======================================================================
[2025-11-13 03:58:58,869][INFO] ======================================================================
[2025-11-13 03:58:58,869][INFO] Iteration 18000
[2025-11-13 03:58:58,869][INFO] Loss (weighted/base): train=0.5537/0.4595, val=3.6713/1.4443
[2025-11-13 03:58:58,869][INFO]   Val S1->S2 token ratio: 2.98%
[2025-11-13 03:58:58,869][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:58:58,869][INFO]   S2->S3: 82.42% (75/91)
[2025-11-13 03:58:58,869][INFO]   S1->S3: 97.04% (131/135)
[2025-11-13 03:58:58,869][INFO]   overall: 65.40% (206/315)
[2025-11-13 03:58:58,869][INFO] ======================================================================
[2025-11-13 03:59:11,760][INFO] ======================================================================
[2025-11-13 03:59:11,760][INFO] Iteration 19000
[2025-11-13 03:59:11,760][INFO] Loss (weighted/base): train=0.5491/0.4568, val=3.7549/1.4547
[2025-11-13 03:59:11,760][INFO]   Val S1->S2 token ratio: 3.01%
[2025-11-13 03:59:11,760][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:59:11,760][INFO]   S2->S3: 72.53% (66/91)
[2025-11-13 03:59:11,760][INFO]   S1->S3: 96.30% (130/135)
[2025-11-13 03:59:11,760][INFO]   overall: 62.22% (196/315)
[2025-11-13 03:59:11,760][INFO] ======================================================================
[2025-11-13 03:59:24,609][INFO] ======================================================================
[2025-11-13 03:59:24,609][INFO] Iteration 20000
[2025-11-13 03:59:24,609][INFO] Loss (weighted/base): train=0.5467/0.4548, val=3.7682/1.4818
[2025-11-13 03:59:24,609][INFO]   Val S1->S2 token ratio: 3.00%
[2025-11-13 03:59:24,609][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:59:24,609][INFO]   S2->S3: 67.03% (61/91)
[2025-11-13 03:59:24,609][INFO]   S1->S3: 94.81% (128/135)
[2025-11-13 03:59:24,609][INFO]   overall: 60.00% (189/315)
[2025-11-13 03:59:24,609][INFO] ======================================================================
[2025-11-13 03:59:24,612][INFO] Saved checkpoint: out/composition_20251113_035500/ckpt_20000.pt
[2025-11-13 03:59:37,475][INFO] ======================================================================
[2025-11-13 03:59:37,475][INFO] Iteration 21000
[2025-11-13 03:59:37,475][INFO] Loss (weighted/base): train=0.5432/0.4527, val=3.8551/1.4856
[2025-11-13 03:59:37,475][INFO]   Val S1->S2 token ratio: 3.06%
[2025-11-13 03:59:37,475][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:59:37,475][INFO]   S2->S3: 81.32% (74/91)
[2025-11-13 03:59:37,475][INFO]   S1->S3: 94.81% (128/135)
[2025-11-13 03:59:37,475][INFO]   overall: 64.13% (202/315)
[2025-11-13 03:59:37,475][INFO] ======================================================================
[2025-11-13 03:59:50,348][INFO] ======================================================================
[2025-11-13 03:59:50,348][INFO] Iteration 22000
[2025-11-13 03:59:50,348][INFO] Loss (weighted/base): train=0.5404/0.4506, val=3.8242/1.4949
[2025-11-13 03:59:50,348][INFO]   Val S1->S2 token ratio: 3.07%
[2025-11-13 03:59:50,348][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 03:59:50,348][INFO]   S2->S3: 80.22% (73/91)
[2025-11-13 03:59:50,348][INFO]   S1->S3: 94.07% (127/135)
[2025-11-13 03:59:50,348][INFO]   overall: 63.49% (200/315)
[2025-11-13 03:59:50,348][INFO] ======================================================================
[2025-11-13 04:00:03,165][INFO] ======================================================================
[2025-11-13 04:00:03,165][INFO] Iteration 23000
[2025-11-13 04:00:03,165][INFO] Loss (weighted/base): train=0.5377/0.4487, val=3.8588/1.5033
[2025-11-13 04:00:03,165][INFO]   Val S1->S2 token ratio: 3.01%
[2025-11-13 04:00:03,165][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:00:03,165][INFO]   S2->S3: 71.43% (65/91)
[2025-11-13 04:00:03,165][INFO]   S1->S3: 95.56% (129/135)
[2025-11-13 04:00:03,165][INFO]   overall: 61.59% (194/315)
[2025-11-13 04:00:03,165][INFO] ======================================================================
[2025-11-13 04:00:15,989][INFO] ======================================================================
[2025-11-13 04:00:15,989][INFO] Iteration 24000
[2025-11-13 04:00:15,989][INFO] Loss (weighted/base): train=0.5356/0.4471, val=3.8895/1.5191
[2025-11-13 04:00:15,989][INFO]   Val S1->S2 token ratio: 3.03%
[2025-11-13 04:00:15,989][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:00:15,989][INFO]   S2->S3: 81.32% (74/91)
[2025-11-13 04:00:15,989][INFO]   S1->S3: 91.11% (123/135)
[2025-11-13 04:00:15,989][INFO]   overall: 62.54% (197/315)
[2025-11-13 04:00:15,989][INFO] ======================================================================
[2025-11-13 04:00:28,796][INFO] ======================================================================
[2025-11-13 04:00:28,796][INFO] Iteration 25000
[2025-11-13 04:00:28,796][INFO] Loss (weighted/base): train=0.5328/0.4454, val=3.8996/1.5223
[2025-11-13 04:00:28,797][INFO]   Val S1->S2 token ratio: 3.01%
[2025-11-13 04:00:28,797][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:00:28,797][INFO]   S2->S3: 72.53% (66/91)
[2025-11-13 04:00:28,797][INFO]   S1->S3: 91.85% (124/135)
[2025-11-13 04:00:28,797][INFO]   overall: 60.32% (190/315)
[2025-11-13 04:00:28,797][INFO] ======================================================================
[2025-11-13 04:00:28,800][INFO] Saved checkpoint: out/composition_20251113_035500/ckpt_25000.pt
[2025-11-13 04:00:41,631][INFO] ======================================================================
[2025-11-13 04:00:41,631][INFO] Iteration 26000
[2025-11-13 04:00:41,631][INFO] Loss (weighted/base): train=0.5307/0.4436, val=3.9928/1.5304
[2025-11-13 04:00:41,631][INFO]   Val S1->S2 token ratio: 3.08%
[2025-11-13 04:00:41,631][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:00:41,631][INFO]   S2->S3: 82.42% (75/91)
[2025-11-13 04:00:41,631][INFO]   S1->S3: 94.07% (127/135)
[2025-11-13 04:00:41,631][INFO]   overall: 64.13% (202/315)
[2025-11-13 04:00:41,631][INFO] ======================================================================
[2025-11-13 04:00:54,423][INFO] ======================================================================
[2025-11-13 04:00:54,423][INFO] Iteration 27000
[2025-11-13 04:00:54,423][INFO] Loss (weighted/base): train=0.5285/0.4420, val=3.9984/1.5395
[2025-11-13 04:00:54,423][INFO]   Val S1->S2 token ratio: 3.03%
[2025-11-13 04:00:54,423][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:00:54,423][INFO]   S2->S3: 67.03% (61/91)
[2025-11-13 04:00:54,423][INFO]   S1->S3: 94.81% (128/135)
[2025-11-13 04:00:54,423][INFO]   overall: 60.00% (189/315)
[2025-11-13 04:00:54,423][INFO] ======================================================================
[2025-11-13 04:01:07,239][INFO] ======================================================================
[2025-11-13 04:01:07,239][INFO] Iteration 28000
[2025-11-13 04:01:07,239][INFO] Loss (weighted/base): train=0.5266/0.4405, val=3.8965/1.5263
[2025-11-13 04:01:07,239][INFO]   Val S1->S2 token ratio: 2.99%
[2025-11-13 04:01:07,239][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:01:07,239][INFO]   S2->S3: 74.73% (68/91)
[2025-11-13 04:01:07,239][INFO]   S1->S3: 92.59% (125/135)
[2025-11-13 04:01:07,239][INFO]   overall: 61.27% (193/315)
[2025-11-13 04:01:07,239][INFO] ======================================================================
[2025-11-13 04:01:20,182][INFO] ======================================================================
[2025-11-13 04:01:20,182][INFO] Iteration 29000
[2025-11-13 04:01:20,182][INFO] Loss (weighted/base): train=0.5243/0.4388, val=3.9610/1.5516
[2025-11-13 04:01:20,182][INFO]   Val S1->S2 token ratio: 3.02%
[2025-11-13 04:01:20,182][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:01:20,182][INFO]   S2->S3: 73.63% (67/91)
[2025-11-13 04:01:20,182][INFO]   S1->S3: 97.04% (131/135)
[2025-11-13 04:01:20,182][INFO]   overall: 62.86% (198/315)
[2025-11-13 04:01:20,182][INFO] ======================================================================
[2025-11-13 04:01:33,004][INFO] ======================================================================
[2025-11-13 04:01:33,004][INFO] Iteration 30000
[2025-11-13 04:01:33,004][INFO] Loss (weighted/base): train=0.5228/0.4375, val=4.0521/1.5655
[2025-11-13 04:01:33,004][INFO]   Val S1->S2 token ratio: 3.08%
[2025-11-13 04:01:33,004][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:01:33,004][INFO]   S2->S3: 70.33% (64/91)
[2025-11-13 04:01:33,004][INFO]   S1->S3: 89.63% (121/135)
[2025-11-13 04:01:33,004][INFO]   overall: 58.73% (185/315)
[2025-11-13 04:01:33,004][INFO] ======================================================================
[2025-11-13 04:01:33,008][INFO] Saved checkpoint: out/composition_20251113_035500/ckpt_30000.pt
[2025-11-13 04:01:45,809][INFO] ======================================================================
[2025-11-13 04:01:45,809][INFO] Iteration 31000
[2025-11-13 04:01:45,809][INFO] Loss (weighted/base): train=0.5210/0.4361, val=3.9758/1.5676
[2025-11-13 04:01:45,809][INFO]   Val S1->S2 token ratio: 3.02%
[2025-11-13 04:01:45,809][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:01:45,809][INFO]   S2->S3: 63.74% (58/91)
[2025-11-13 04:01:45,809][INFO]   S1->S3: 92.59% (125/135)
[2025-11-13 04:01:45,809][INFO]   overall: 58.10% (183/315)
[2025-11-13 04:01:45,809][INFO] ======================================================================
[2025-11-13 04:01:58,932][INFO] ======================================================================
[2025-11-13 04:01:58,932][INFO] Iteration 32000
[2025-11-13 04:01:58,932][INFO] Loss (weighted/base): train=0.5194/0.4347, val=4.1067/1.6059
[2025-11-13 04:01:58,932][INFO]   Val S1->S2 token ratio: 3.06%
[2025-11-13 04:01:58,932][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:01:58,932][INFO]   S2->S3: 71.43% (65/91)
[2025-11-13 04:01:58,932][INFO]   S1->S3: 92.59% (125/135)
[2025-11-13 04:01:58,932][INFO]   overall: 60.32% (190/315)
[2025-11-13 04:01:58,932][INFO] ======================================================================
[2025-11-13 04:02:11,777][INFO] ======================================================================
[2025-11-13 04:02:11,777][INFO] Iteration 33000
[2025-11-13 04:02:11,777][INFO] Loss (weighted/base): train=0.5176/0.4335, val=4.1426/1.5887
[2025-11-13 04:02:11,778][INFO]   Val S1->S2 token ratio: 3.08%
[2025-11-13 04:02:11,778][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:02:11,778][INFO]   S2->S3: 70.33% (64/91)
[2025-11-13 04:02:11,778][INFO]   S1->S3: 91.11% (123/135)
[2025-11-13 04:02:11,778][INFO]   overall: 59.37% (187/315)
[2025-11-13 04:02:11,778][INFO] ======================================================================
[2025-11-13 04:02:24,625][INFO] ======================================================================
[2025-11-13 04:02:24,625][INFO] Iteration 34000
[2025-11-13 04:02:24,625][INFO] Loss (weighted/base): train=0.5157/0.4321, val=4.0736/1.6056
[2025-11-13 04:02:24,625][INFO]   Val S1->S2 token ratio: 3.01%
[2025-11-13 04:02:24,625][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:02:24,625][INFO]   S2->S3: 69.23% (63/91)
[2025-11-13 04:02:24,625][INFO]   S1->S3: 93.33% (126/135)
[2025-11-13 04:02:24,625][INFO]   overall: 60.00% (189/315)
[2025-11-13 04:02:24,625][INFO] ======================================================================
[2025-11-13 04:02:37,430][INFO] ======================================================================
[2025-11-13 04:02:37,430][INFO] Iteration 35000
[2025-11-13 04:02:37,430][INFO] Loss (weighted/base): train=0.5148/0.4311, val=4.0429/1.5852
[2025-11-13 04:02:37,430][INFO]   Val S1->S2 token ratio: 3.03%
[2025-11-13 04:02:37,430][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:02:37,430][INFO]   S2->S3: 72.53% (66/91)
[2025-11-13 04:02:37,430][INFO]   S1->S3: 89.63% (121/135)
[2025-11-13 04:02:37,430][INFO]   overall: 59.37% (187/315)
[2025-11-13 04:02:37,430][INFO] ======================================================================
[2025-11-13 04:02:37,433][INFO] Saved checkpoint: out/composition_20251113_035500/ckpt_35000.pt
[2025-11-13 04:02:50,353][INFO] ======================================================================
[2025-11-13 04:02:50,353][INFO] Iteration 36000
[2025-11-13 04:02:50,353][INFO] Loss (weighted/base): train=0.5128/0.4298, val=4.0722/1.6162
[2025-11-13 04:02:50,353][INFO]   Val S1->S2 token ratio: 3.02%
[2025-11-13 04:02:50,353][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:02:50,353][INFO]   S2->S3: 61.54% (56/91)
[2025-11-13 04:02:50,353][INFO]   S1->S3: 90.37% (122/135)
[2025-11-13 04:02:50,353][INFO]   overall: 56.51% (178/315)
[2025-11-13 04:02:50,353][INFO] ======================================================================
[2025-11-13 04:03:03,269][INFO] ======================================================================
[2025-11-13 04:03:03,269][INFO] Iteration 37000
[2025-11-13 04:03:03,269][INFO] Loss (weighted/base): train=0.5116/0.4286, val=4.2184/1.6489
[2025-11-13 04:03:03,269][INFO]   Val S1->S2 token ratio: 3.08%
[2025-11-13 04:03:03,269][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:03:03,269][INFO]   S2->S3: 68.13% (62/91)
[2025-11-13 04:03:03,269][INFO]   S1->S3: 89.63% (121/135)
[2025-11-13 04:03:03,269][INFO]   overall: 58.10% (183/315)
[2025-11-13 04:03:03,269][INFO] ======================================================================
[2025-11-13 04:03:16,263][INFO] ======================================================================
[2025-11-13 04:03:16,263][INFO] Iteration 38000
[2025-11-13 04:03:16,263][INFO] Loss (weighted/base): train=0.5100/0.4276, val=4.1076/1.6400
[2025-11-13 04:03:16,263][INFO]   Val S1->S2 token ratio: 2.99%
[2025-11-13 04:03:16,263][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:03:16,263][INFO]   S2->S3: 65.93% (60/91)
[2025-11-13 04:03:16,263][INFO]   S1->S3: 91.11% (123/135)
[2025-11-13 04:03:16,263][INFO]   overall: 58.10% (183/315)
[2025-11-13 04:03:16,263][INFO] ======================================================================
[2025-11-13 04:03:29,241][INFO] ======================================================================
[2025-11-13 04:03:29,241][INFO] Iteration 39000
[2025-11-13 04:03:29,241][INFO] Loss (weighted/base): train=0.5088/0.4265, val=4.1983/1.6627
[2025-11-13 04:03:29,241][INFO]   Val S1->S2 token ratio: 3.03%
[2025-11-13 04:03:29,241][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:03:29,241][INFO]   S2->S3: 67.03% (61/91)
[2025-11-13 04:03:29,241][INFO]   S1->S3: 87.41% (118/135)
[2025-11-13 04:03:29,241][INFO]   overall: 56.83% (179/315)
[2025-11-13 04:03:29,241][INFO] ======================================================================
[2025-11-13 04:03:42,180][INFO] ======================================================================
[2025-11-13 04:03:42,180][INFO] Iteration 40000
[2025-11-13 04:03:42,180][INFO] Loss (weighted/base): train=0.5072/0.4252, val=4.2521/1.6761
[2025-11-13 04:03:42,180][INFO]   Val S1->S2 token ratio: 3.06%
[2025-11-13 04:03:42,180][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:03:42,180][INFO]   S2->S3: 71.43% (65/91)
[2025-11-13 04:03:42,180][INFO]   S1->S3: 91.11% (123/135)
[2025-11-13 04:03:42,180][INFO]   overall: 59.68% (188/315)
[2025-11-13 04:03:42,180][INFO] ======================================================================
[2025-11-13 04:03:42,184][INFO] Saved checkpoint: out/composition_20251113_035500/ckpt_40000.pt
[2025-11-13 04:03:55,097][INFO] ======================================================================
[2025-11-13 04:03:55,097][INFO] Iteration 41000
[2025-11-13 04:03:55,097][INFO] Loss (weighted/base): train=0.5065/0.4244, val=4.1467/1.6441
[2025-11-13 04:03:55,097][INFO]   Val S1->S2 token ratio: 3.00%
[2025-11-13 04:03:55,098][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:03:55,098][INFO]   S2->S3: 69.23% (63/91)
[2025-11-13 04:03:55,098][INFO]   S1->S3: 88.15% (119/135)
[2025-11-13 04:03:55,098][INFO]   overall: 57.78% (182/315)
[2025-11-13 04:03:55,098][INFO] ======================================================================
[2025-11-13 04:04:08,016][INFO] ======================================================================
[2025-11-13 04:04:08,016][INFO] Iteration 42000
[2025-11-13 04:04:08,016][INFO] Loss (weighted/base): train=0.5049/0.4233, val=4.2159/1.6692
[2025-11-13 04:04:08,016][INFO]   Val S1->S2 token ratio: 3.03%
[2025-11-13 04:04:08,016][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:04:08,016][INFO]   S2->S3: 65.93% (60/91)
[2025-11-13 04:04:08,016][INFO]   S1->S3: 88.15% (119/135)
[2025-11-13 04:04:08,016][INFO]   overall: 56.83% (179/315)
[2025-11-13 04:04:08,016][INFO] ======================================================================
[2025-11-13 04:04:20,921][INFO] ======================================================================
[2025-11-13 04:04:20,921][INFO] Iteration 43000
[2025-11-13 04:04:20,921][INFO] Loss (weighted/base): train=0.5037/0.4225, val=4.3057/1.6804
[2025-11-13 04:04:20,921][INFO]   Val S1->S2 token ratio: 3.05%
[2025-11-13 04:04:20,921][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:04:20,921][INFO]   S2->S3: 70.33% (64/91)
[2025-11-13 04:04:20,922][INFO]   S1->S3: 91.11% (123/135)
[2025-11-13 04:04:20,922][INFO]   overall: 59.37% (187/315)
[2025-11-13 04:04:20,922][INFO] ======================================================================
[2025-11-13 04:04:33,853][INFO] ======================================================================
[2025-11-13 04:04:33,853][INFO] Iteration 44000
[2025-11-13 04:04:33,853][INFO] Loss (weighted/base): train=0.5026/0.4215, val=4.3010/1.6912
[2025-11-13 04:04:33,853][INFO]   Val S1->S2 token ratio: 3.04%
[2025-11-13 04:04:33,853][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:04:33,853][INFO]   S2->S3: 61.54% (56/91)
[2025-11-13 04:04:33,854][INFO]   S1->S3: 88.15% (119/135)
[2025-11-13 04:04:33,854][INFO]   overall: 55.56% (175/315)
[2025-11-13 04:04:33,854][INFO] ======================================================================
[2025-11-13 04:04:46,755][INFO] ======================================================================
[2025-11-13 04:04:46,755][INFO] Iteration 45000
[2025-11-13 04:04:46,755][INFO] Loss (weighted/base): train=0.5019/0.4205, val=4.2734/1.6970
[2025-11-13 04:04:46,755][INFO]   Val S1->S2 token ratio: 2.99%
[2025-11-13 04:04:46,755][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:04:46,755][INFO]   S2->S3: 60.44% (55/91)
[2025-11-13 04:04:46,755][INFO]   S1->S3: 88.89% (120/135)
[2025-11-13 04:04:46,755][INFO]   overall: 55.56% (175/315)
[2025-11-13 04:04:46,755][INFO] ======================================================================
[2025-11-13 04:04:46,758][INFO] Saved checkpoint: out/composition_20251113_035500/ckpt_45000.pt
[2025-11-13 04:04:59,688][INFO] ======================================================================
[2025-11-13 04:04:59,688][INFO] Iteration 46000
[2025-11-13 04:04:59,688][INFO] Loss (weighted/base): train=0.5008/0.4196, val=4.3139/1.6946
[2025-11-13 04:04:59,688][INFO]   Val S1->S2 token ratio: 3.05%
[2025-11-13 04:04:59,688][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:04:59,688][INFO]   S2->S3: 65.93% (60/91)
[2025-11-13 04:04:59,688][INFO]   S1->S3: 88.15% (119/135)
[2025-11-13 04:04:59,688][INFO]   overall: 56.83% (179/315)
[2025-11-13 04:04:59,688][INFO] ======================================================================
[2025-11-13 04:05:12,645][INFO] ======================================================================
[2025-11-13 04:05:12,645][INFO] Iteration 47000
[2025-11-13 04:05:12,645][INFO] Loss (weighted/base): train=0.4999/0.4186, val=4.3577/1.7089
[2025-11-13 04:05:12,645][INFO]   Val S1->S2 token ratio: 3.09%
[2025-11-13 04:05:12,645][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:05:12,645][INFO]   S2->S3: 68.13% (62/91)
[2025-11-13 04:05:12,645][INFO]   S1->S3: 86.67% (117/135)
[2025-11-13 04:05:12,645][INFO]   overall: 56.83% (179/315)
[2025-11-13 04:05:12,645][INFO] ======================================================================
[2025-11-13 04:05:25,606][INFO] ======================================================================
[2025-11-13 04:05:25,606][INFO] Iteration 48000
[2025-11-13 04:05:25,606][INFO] Loss (weighted/base): train=0.4987/0.4177, val=4.4091/1.7296
[2025-11-13 04:05:25,606][INFO]   Val S1->S2 token ratio: 3.09%
[2025-11-13 04:05:25,606][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:05:25,606][INFO]   S2->S3: 61.54% (56/91)
[2025-11-13 04:05:25,606][INFO]   S1->S3: 83.70% (113/135)
[2025-11-13 04:05:25,606][INFO]   overall: 53.65% (169/315)
[2025-11-13 04:05:25,606][INFO] ======================================================================
[2025-11-13 04:05:38,546][INFO] ======================================================================
[2025-11-13 04:05:38,546][INFO] Iteration 49000
[2025-11-13 04:05:38,546][INFO] Loss (weighted/base): train=0.4980/0.4170, val=4.3334/1.7027
[2025-11-13 04:05:38,546][INFO]   Val S1->S2 token ratio: 3.04%
[2025-11-13 04:05:38,546][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:05:38,546][INFO]   S2->S3: 64.84% (59/91)
[2025-11-13 04:05:38,546][INFO]   S1->S3: 85.93% (116/135)
[2025-11-13 04:05:38,546][INFO]   overall: 55.56% (175/315)
[2025-11-13 04:05:38,546][INFO] ======================================================================
[2025-11-13 04:05:51,393][INFO] ======================================================================
[2025-11-13 04:05:51,393][INFO] Iteration 50000
[2025-11-13 04:05:51,393][INFO] Loss (weighted/base): train=0.4964/0.4160, val=4.4190/1.7366
[2025-11-13 04:05:51,393][INFO]   Val S1->S2 token ratio: 3.02%
[2025-11-13 04:05:51,393][INFO]   S1->S2: 0.00% (0/89)
[2025-11-13 04:05:51,393][INFO]   S2->S3: 65.93% (60/91)
[2025-11-13 04:05:51,393][INFO]   S1->S3: 82.22% (111/135)
[2025-11-13 04:05:51,393][INFO]   overall: 54.29% (171/315)
[2025-11-13 04:05:51,393][INFO] ======================================================================
[2025-11-13 04:05:51,397][INFO] Saved checkpoint: out/composition_20251113_035500/ckpt_50000.pt
[2025-11-13 04:05:51,397][INFO] Training finished. Outputs saved to out/composition_20251113_035500
